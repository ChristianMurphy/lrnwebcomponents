!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("lit-element/lit-element.js"),require("@lrnwebcomponents/simple-colors/simple-colors.js"),require("@polymer/polymer/lib/utils/wrap.js"),require("@polymer/polymer/lib/utils/flattened-nodes-observer.js"),require("@polymer/polymer/lib/utils/flush.js"),require("@lrnwebcomponents/hax-body/lib/haxutils.js"),require("@lrnwebcomponents/simple-colors/lib/simple-colors-picker.js")):"function"==typeof define&&define.amd?define(["exports","lit-element/lit-element.js","@lrnwebcomponents/simple-colors/simple-colors.js","@polymer/polymer/lib/utils/wrap.js","@polymer/polymer/lib/utils/flattened-nodes-observer.js","@polymer/polymer/lib/utils/flush.js","@lrnwebcomponents/hax-body/lib/haxutils.js","@lrnwebcomponents/simple-colors/lib/simple-colors-picker.js"],t):t((e=e||self).HaxBody={},e.litElement_js,e.simpleColors_js,e.wrap_js,e.flattenedNodesObserver_js,e.flush_js,e.haxutils_js)}(this,function(e,t,n,o,i,a,r){"use strict";function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function d(e,t,n){return t&&c(e.prototype,t),n&&c(e,n),e}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function m(e,t,n){return(m=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()?Reflect.construct:function(e,t,n){var o=[null];o.push.apply(o,t);var i=new(Function.bind.apply(e,o));return n&&p(i,n.prototype),i}).apply(null,arguments)}function x(e){var t="function"==typeof Map?new Map:void 0;return(x=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,o)}function o(){return m(e,arguments,h(this).constructor)}return o.prototype=Object.create(e.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}}),p(o,e)})(e)}function v(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function f(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?v(e):t}function b(e,t,n){return(b="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=h(e)););return e}(e,t);if(o){var i=Object.getOwnPropertyDescriptor(o,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function g(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function y(){var e=g(['\n      <hax-toolbar .selected="','" hide-transform id="toolbar">\n        <hax-context-item-menu\n          slot="primary"\n          .selected-value="','"\n          @selected-value-changed="','"\n          id="formatsize"\n          icon="','"\n          label="Text formatting"\n          event-name="text-tag"\n        >\n          <paper-item value="p"\n            ><iron-icon icon="hax:paragraph"></iron-icon>Paragraph</paper-item\n          >\n          <paper-item value="ul"\n            ><iron-icon icon="editor:format-list-bulleted"></iron-icon>Bulleted\n            list</paper-item\n          >\n          <paper-item value="ol"\n            ><iron-icon icon="editor:format-list-numbered"></iron-icon>Numbered\n            list</paper-item\n          >\n          <paper-item value="h2"\n            ><iron-icon icon="hax:h2"></iron-icon>Title\n          </paper-item>\n          <paper-item value="h3"\n            ><iron-icon icon="hax:h3"></iron-icon>Content heading\n          </paper-item>\n          <paper-item value="h4"\n            ><iron-icon icon="hax:h4"></iron-icon>Subheading\n          </paper-item>\n          <paper-item value="h5"\n            ><iron-icon icon="hax:h5"></iron-icon>Deeper subheading\n          </paper-item>\n          <paper-item value="blockquote"\n            ><iron-icon icon="editor:format-quote"></iron-icon>Blockquote\n          </paper-item>\n          <paper-item value="code"\n            ><iron-icon icon="icons:code"></iron-icon>Code\n          </paper-item>\n        </hax-context-item-menu>\n        <hax-context-item-textop\n          slot="primary"\n          icon="editor:format-bold"\n          label="Bold"\n          event-name="text-bold"\n        ></hax-context-item-textop>\n        <hax-context-item-textop\n          slot="primary"\n          icon="editor:format-italic"\n          label="Italic"\n          event-name="text-italic"\n        ></hax-context-item-textop>\n        <hax-context-item-textop\n          slot="primary"\n          icon="editor:insert-link"\n          label="Link"\n          event-name="text-link"\n        ></hax-context-item-textop>\n        <hax-context-item-textop\n          slot="primary"\n          icon="mdextra:unlink"\n          label="Remove link"\n          event-name="text-unlink"\n        ></hax-context-item-textop>\n        <hax-context-item-textop\n          slot="primary"\n          icon="editor:format-list-bulleted"\n          event-name="ul"\n          label="Bulleted list"\n          .hidden="','"\n        ></hax-context-item-textop>\n        <hax-context-item-textop\n          slot="primary"\n          icon="editor:format-list-numbered"\n          label="Numbered list"\n          event-name="ol"\n          .hidden="','"\n        ></hax-context-item-textop>\n        <hax-context-item-textop\n          slot="primary"\n          icon="editor:format-indent-decrease"\n          label="Outdent"\n          event-name="text-outdent"\n          .hidden="','"\n        ></hax-context-item-textop>\n        <hax-context-item-textop\n          slot="primary"\n          icon="editor:format-indent-increase"\n          label="Indent"\n          event-name="text-indent"\n          .hidden="','"\n        ></hax-context-item-textop>\n        <hax-context-item-textop\n          slot="primary"\n          icon="editor:format-clear"\n          label="Remove format"\n          event-name="text-remove-format"\n        ></hax-context-item-textop>\n        <hax-context-item\n          slot="primary"\n          icon="hax:add-brick"\n          label="Add element to selection"\n          event-name="insert-inline-gizmo"\n          .hidden="','"\n        ></hax-context-item>\n        <hax-context-item-textop\n          slot="primary"\n          icon="hax:add-brick"\n          label="Add element to selection"\n          event-name="insert-inline-gizmo"\n          .hidden="','"\n        ></hax-context-item-textop>\n        <hax-context-item-textop\n          menu\n          slot="more"\n          icon="mdextra:subscript"\n          event-name="text-subscript"\n          >Subscript</hax-context-item-textop\n        >\n        <hax-context-item-textop\n          menu\n          slot="more"\n          icon="mdextra:superscript"\n          event-name="text-superscript"\n          >Superscript</hax-context-item-textop\n        >\n        <hax-context-item-textop\n          menu\n          slot="more"\n          icon="editor:format-underlined"\n          event-name="text-underline"\n          >Underline</hax-context-item-textop\n        >\n        <hax-context-item-textop\n          menu\n          slot="more"\n          icon="editor:format-strikethrough"\n          event-name="text-strikethrough"\n          >Cross out</hax-context-item-textop\n        >\n      </hax-toolbar>\n    ']);return y=function(){return e},e}function w(){var e=g(["\n        :host {\n          display: block;\n          pointer-events: none;\n        }\n        :host [hidden] {\n          display: none;\n        }\n        paper-item {\n          -webkit-justify-content: flex-start;\n          justify-content: flex-start;\n          height: 36px;\n          padding: 0 8px;\n          min-height: 36px;\n        }\n        paper-item:hover {\n          background-color: #d3d3d3;\n          cursor: pointer;\n        }\n        iron-icon {\n          padding: 8px;\n        }\n        paper-item strong {\n          padding: 8px;\n          font-size: 12px;\n        }\n        :host(.hax-context-pin-top) hax-toolbar {\n          position: fixed;\n          top: 64px;\n          opacity: 0.95;\n        }\n        :host(.hax-context-pin-bottom) hax-toolbar {\n          position: fixed;\n          bottom: 0;\n          opacity: 0.95;\n        }\n      "]);return w=function(){return e},e}var S=function(e){function n(){var e;return l(this,n),e=f(this,h(n).call(this)),import("@polymer/paper-item/paper-item.js"),import("@polymer/iron-icons/iron-icons.js"),import("@polymer/iron-icon/iron-icon.js"),import("@lrnwebcomponents/md-extra-icons/md-extra-icons.js"),import("@lrnwebcomponents/hax-body/lib/hax-context-item-menu.js"),import("@lrnwebcomponents/hax-body/lib/hax-context-item.js"),import("@lrnwebcomponents/hax-body/lib/hax-context-item-textop.js"),import("@lrnwebcomponents/hax-body/lib/hax-toolbar.js"),e.addEventListener("hax-context-item-selected",e._haxContextOperation.bind(v(e))),e.realSelectedValue="p",e.selection=!1,e.formatIcon="hax:format-textblock",e.isSafari=e._isSafari(),e.dispatchEvent(new CustomEvent("is-safari-changed",{bubbles:!0,cancelable:!0,composed:!0,detail:e.isSafari})),e}return u(n,t.LitElement),d(n,null,[{key:"styles",get:function(){return[t.css(w())]}}]),d(n,[{key:"render",value:function(){return t.html(y(),this.selection,this.selectedValue,this.selectedValueChanged,this.formatIcon,!this._showLists,!this._showLists,!this._showIndent,!this._showIndent,this.isSafari,!this.isSafari)}},{key:"selectedValueChanged",value:function(e){this.selectedValue=e.detail}},{key:"updated",value:function(e){var t=this;e.forEach(function(e,n){if(t.realSelectedValue&&"realSelectedValue"==n&&t.shadowRoot)for(var o in t._showIndent=t._computeShowIndent(t.realSelectedValue),t._showIndent||"p"==t.realSelectedValue?t._showLists=!0:t._showLists=!1,t.shadowRoot.querySelector("#formatsize").children)t.shadowRoot.querySelector("#formatsize").children[o]&&t.shadowRoot.querySelector("#formatsize").children[o].getAttribute&&t.shadowRoot.querySelector("#formatsize").children[o].getAttribute("value")==t.realSelectedValue&&(t.selectedValue=o);"selectedValue"==n&&(t.realSelectedValue=t.shadowRoot.querySelector("#formatsize").children[t.selectedValue].getAttribute("value"),t.formatIcon=t.shadowRoot.querySelector("#formatsize").children[t[n]].querySelector("iron-icon").icon,t.dispatchEvent(new CustomEvent("selected-value-changed",{detail:t[n]})))})}},{key:"_computeShowIndent",value:function(e){return!(!window.HaxStore.instance.computePolyfillSafe()||"ol"!=e&&"ul"!=e)}},{key:"_haxContextOperation",value:function(e){var t=this,n=e.detail,o=window.HaxStore.getSelection();switch(n.eventName){case"close-menu":setTimeout(function(){t.shadowRoot.querySelector("#formatsize").shadowRoot.querySelector("#menu").hideMenu()},200);break;case"insert-inline-gizmo":if(window.HaxStore._tmpSelection&&window.HaxStore.instance.editMode){var i=!1;try{"HAX-BODY"!==window.HaxStore._tmpRange.startContainer.parentNode.parentNode.tagName&&"HAX-BODY"!==window.HaxStore._tmpRange.startContainer.parentNode.parentNode.parentNode.tagName||(window.HaxStore.write("activePlaceHolder",window.HaxStore._tmpRange,this),i=window.HaxStore._tmpRange)}catch(e){}}if(i||null!=window.HaxStore.instance.activePlaceHolder){var a={text:window.HaxStore.instance.activePlaceHolder.toString()},r=window.HaxStore.guessGizmo("inline",a);r.length>0&&window.HaxStore.instance.haxAppPicker.presentOptions(r,"inline","Transform selected text to..","gizmo")}break;case"text-bold":document.execCommand("bold"),e.preventDefault(),e.stopPropagation();break;case"text-italic":document.execCommand("italic"),e.preventDefault(),e.stopPropagation();break;case"text-underline":document.execCommand("underline"),e.preventDefault(),e.stopPropagation(),this.shadowRoot.querySelector("#toolbar").shadowRoot.querySelector("#moremenu").shadowRoot.querySelector("#menu").hideMenu();break;case"text-subscript":document.execCommand("subscript"),e.preventDefault(),e.stopPropagation(),this.shadowRoot.querySelector("#toolbar").shadowRoot.querySelector("#moremenu").shadowRoot.querySelector("#menu").hideMenu();break;case"text-superscript":document.execCommand("superscript"),e.preventDefault(),e.stopPropagation(),this.shadowRoot.querySelector("#toolbar").shadowRoot.querySelector("#moremenu").shadowRoot.querySelector("#menu").hideMenu();break;case"text-remove-format":document.execCommand("removeFormat"),e.preventDefault(),e.stopPropagation();break;case"text-strikethrough":document.execCommand("strikeThrough"),e.preventDefault(),e.stopPropagation(),this.shadowRoot.querySelector("#toolbar").shadowRoot.querySelector("#moremenu").shadowRoot.querySelector("#menu").hideMenu();break;case"text-link":var l="";"undefined"!==s(o.focusNode.parentNode.href)&&(l=o.focusNode.parentNode.href);var c=prompt("Enter a URL:",l);c&&(document.execCommand("createLink",!1,c),o.focusNode.parentNode&&(o.focusNode.parentNode.setAttribute("contenteditable",!0),o.focusNode.parentNode.setAttribute("data-editable",!0),o.focusNode.parentNode.removeEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation()}),o.focusNode.parentNode.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation()})),e.preventDefault(),e.stopPropagation());break;case"text-unlink":document.execCommand("unlink"),e.preventDefault(),e.stopPropagation();break;case"text-indent":document.execCommand("indent"),e.preventDefault(),e.stopPropagation();break;case"text-outdent":document.execCommand("outdent"),e.preventDefault(),e.stopPropagation()}}},{key:"_isSafari",value:function(){var e=navigator.userAgent.toLowerCase();return!(-1==e.indexOf("safari")||e.indexOf("chrome")>-1)}}],[{key:"tag",get:function(){return"hax-text-context"}},{key:"properties",get:function(){return{_showIndent:{type:Boolean},_showLists:{type:Boolean},realSelectedValue:{type:String},selectedValue:{type:Number,attribute:"selected-value"},selection:{type:Boolean},formatIcon:{type:String,attribute:"format-icon"},isSafari:{type:Boolean,attribute:"is-safari"}}}}]),n}();function N(){var e=g(['\n      <hax-toolbar\n        id="toolbar"\n        size="','"\n        @size-changed="','"\n      >\n        <slot slot="primary"></slot>\n        <hax-context-item\n          slot="primary"\n          icon="icons:settings"\n          label="Settings"\n          event-name="hax-manager-configure"\n          .hidden="','"\n        ></hax-context-item>\n        <hax-context-item\n          slot="primary"\n          icon="icons:view-quilt"\n          label="','"\n          event-name="hax-manager-configure-container"\n          .hidden="','"\n        ></hax-context-item>\n      </hax-toolbar>\n    ']);return N=function(){return e},e}function _(){var e=g(["\n        :host *[hidden] {\n          display: none;\n        }\n        :host {\n          display: block;\n          height: 36px;\n        }\n        hax-context-item {\n          margin: 0;\n          height: 36px;\n        }\n        :host(.hax-context-pin-top) hax-toolbar {\n          position: fixed;\n          top: 64px;\n          opacity: 0.9;\n        }\n        :host(.hax-context-pin-bottom) hax-toolbar {\n          position: fixed;\n          bottom: 0;\n          opacity: 0.9;\n        }\n        :host(.hax-context-pin-top) hax-toolbar:hover,\n        :host(.hax-context-pin-bottom) hax-toolbar:hover {\n          opacity: 1;\n        }\n      "]);return _=function(){return e},e}window.customElements.define(S.tag,S);var C=function(e){function n(){var e;return l(this,n),(e=f(this,h(n).call(this))).ceSize=100,e.haxProperties={},import("@lrnwebcomponents/hax-body/lib/hax-context-item.js"),import("@lrnwebcomponents/hax-body/lib/hax-toolbar.js"),e}return u(n,t.LitElement),d(n,null,[{key:"styles",get:function(){return[t.css(_())]}}]),d(n,[{key:"render",value:function(){return t.html(N(),this.ceSize,this.ceSizeChanged,!this.__hasSettingsForm,this.__parentName,!this.__hasParentSettingsForm)}},{key:"updated",value:function(e){var t=this;e.forEach(function(e,n){"haxProperties"==n&&(t.shadowRoot.querySelector("#toolbar").haxProperties=t[n],t._haxPropertiesChanged(t[n],e)),"ceSize"==n&&t._ceSizeChanged(t[n],e)})}},{key:"ceSizeChanged",value:function(e){this.ceSize=e.detail}},{key:"setHaxProperties",value:function(e){this.haxProperties=e}},{key:"_ceSizeChanged",value:function(e,t){"undefined"!==s(e)&&"undefined"!==s(t)&&this.dispatchEvent(new CustomEvent("hax-context-item-selected",{bubbles:!0,cancelable:!0,composed:!0,detail:{eventName:"hax-size-change",value:e}}))}},{key:"_haxPropertiesChanged",value:function(e,t){if("undefined"!==s(t)&&"undefined"!==s(e.settings)){for(;null!==this.firstChild;)this.removeChild(this.firstChild);var n,o=e.settings.quick,i=e.settings.configure,a=e.settings.advanced;if((i.length||a.length)&&"HR"!==e.element.tagName?this.__hasSettingsForm=!0:this.__hasSettingsForm=!1,this.__hasParentSettingsForm=!1,window.HaxStore.instance.activeContainerNode!==window.HaxStore.instance.activeNode&&null!==window.HaxStore.instance.activeContainerNode)switch(this.__hasParentSettingsForm=!0,window.HaxStore.instance.activeContainerNode.tagName){case"P":case"UL":case"OL":case"DIV":this.__parentName="Text block settings";break;case"GRID-PLATE":this.__parentName="Layout settings";break;default:this.__parentName=window.HaxStore.instance.activeContainerNode.tagName.replace("-"," ").toLowerCase()}for(var r=0;r<o.length;r++){var l=o[r];(n=document.createElement("hax-context-item")).eventName="hax-edit-property",n.label=l.title,n.options=l.options,n.icon=l.icon,n.inputMethod=l.inputMethod,n.required=l.required,n.options=l.options,n.validation=l.validation,n.validationType=l.validationType,n.description=l.description,"undefined"!==s(l.property)?n.propertyToBind=l.property:"undefined"!==s(l.attribute)?n.propertyToBind=l.attribute:n.slotToBind=l.slot,this.appendChild(n)}}}}],[{key:"tag",get:function(){return"hax-ce-context"}},{key:"properties",get:function(){return{ceSize:{type:Number,attribute:"ce-size"},haxProperties:{type:Object,attribute:"hax-properties"}}}}]),n}();window.customElements.define(C.tag,C);var k=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return l(this,t),e=f(this,h(t).call(this)),import("@lrnwebcomponents/hax-body/lib/hax-context-item-menu.js"),import("@lrnwebcomponents/hax-body/lib/hax-context-item.js"),e.tag=t.tag,e.template=document.createElement("template"),e.attachShadow({mode:"open"}),n||e.render(),e}return u(t,x(HTMLElement)),d(t,[{key:"render",value:function(){this.shadowRoot.innerHTML=null,this.template.innerHTML=this.html,window.ShadyCSS&&window.ShadyCSS.prepareTemplate(this.template,this.tag),this.shadowRoot.appendChild(this.template.content.cloneNode(!0))}},{key:"html",get:function(){return'\n    <style>\n    :host {\n      display: block;\n      width: 40px;\n      margin-top: -2px;\n    }\n    hax-context-item {\n      display: block;\n    }\n    .area {\n      width: 40px;\n      float: left;\n      visibility: visible;\n      transition: 0.3s all ease;\n    }\n    </style>\n    <div class="area">\n      <hax-context-item\n        light\n        icon="hardware:keyboard-arrow-up"\n        label="Move up"\n        event-name="grid-plate-up"\n        direction="left"\n      ></hax-context-item>\n      <hax-context-item\n        light\n        icon="hardware:keyboard-arrow-down"\n        label="Move down"\n        event-name="grid-plate-down"\n        direction="left"\n      ></hax-context-item>\n    </div>'}}],[{key:"tag",get:function(){return"hax-plate-context"}}]),t}();function H(){var e=g([""]);return H=function(){return e},e}function L(){var e=g(["\n                <span>",'</span>\n                <simple-colors-picker\n                  id="input"\n                  .value="','"\n                  @value-changed="','"\n                ></simple-colors-picker>\n              ']);return L=function(){return e},e}function E(){var e=g([""]);return E=function(){return e},e}function M(){var e=g(['\n                <paper-checkbox\n                  id="input"\n                  .checked="','"\n                  @checked-changed="','"\n                  >',"</paper-checkbox\n                >\n              "]);return M=function(){return e},e}function R(){var e=g([""]);return R=function(){return e},e}function T(){var e=g(['\n                <paper-checkbox\n                  id="input"\n                  .checked="','"\n                  @checked-changed="','"\n                  >',"</paper-checkbox\n                >\n              "]);return T=function(){return e},e}function A(){var e=g([""]);return A=function(){return e},e}function P(){var e=g(['\n                <paper-input\n                  id="input"\n                  type="','"\n                  label="','"\n                  .value="','"\n                  @value-changed="','"\n                  auto-validate=""\n                  pattern="','"\n                  required="','"\n                ></paper-input>\n              ']);return P=function(){return e},e}function q(){var e=g([""]);return q=function(){return e},e}function j(){var e=g(['\n                <paper-textarea\n                  id="input"\n                  label="','"\n                  .value="','"\n                  @value-changed="','"\n                  auto-validate=""\n                  pattern="','"\n                  required="','"\n                ></paper-textarea>\n              ']);return j=function(){return e},e}function z(){var e=g([""]);return z=function(){return e},e}function O(){var e=g(['\n              <span class="input-mixer-label">','</span>\n              <hax-context-item-menu\n                selected-value="','"\n                @selected-value-changed="','"\n                .icon="','"\n                id="input"\n              >\n                <slot></slot>\n              </hax-context-item-menu>\n            ']);return O=function(){return e},e}function I(){var e=g(['\n      <custom-style>\n        <style>\n          paper-textarea,\n          paper-input {\n            --paper-input-container: {\n              padding: 0;\n              font-size: 14px;\n            }\n            --paper-input-container-label-floating: {\n              color: var(--hax-color-text);\n              font-size: 12px;\n            }\n            --paper-input-container-underline: {\n              margin: 0;\n            }\n            --paper-input-container-color: var(--hax-color-text);\n            --paper-input-container-focus-color: var(--hax-color-text);\n            --paper-input-container-invalid-color: var(--hax-color-text);\n            --paper-input-container-input-color: var(--hax-color-text);\n            --paper-input-container-shared-input-style: {\n              color: var(--hax-color-text);\n              background: transparent;\n              margin: 0;\n              padding: 0;\n              line-height: 14px;\n              font-size: 14px;\n              outline: none;\n              border: none;\n            }\n          }\n        </style>\n      </custom-style>\n      <div class="wrapper">\n        ','\n        <span class="input-method">\n          ',"\n          ","\n          ","\n          ","\n          ",'\n        </span>\n        <paper-tooltip for="input" position="top" offset="14">\n          ','\n        </paper-tooltip>\n        <hax-context-item\n          id="updatebutton"\n          icon="subdirectory-arrow-right"\n          label="Update ','"\n          event-name="hax-update-tap"\n        ></hax-context-item>\n      </div>\n    ']);return I=function(){return e},e}function B(){var e=g(["\n        :host {\n          display: block;\n          margin: 0;\n          border: none;\n          padding: 0;\n          border: 1px solid var(--hax-color-border-outline);\n        }\n        .wrapper {\n          background-color: #ffffff;\n          color: #222222;\n          display: flex;\n          align-items: center;\n          justify-content: space-between;\n        }\n        hax-context-item {\n          margin: 0;\n        }\n        #elementoptions {\n          height: inherit;\n        }\n        #input {\n          color: var(--hax-color-text);\n        }\n        paper-checkbox {\n          --paper-checkbox-label-color: var(--hax-color-text);\n        }\n        paper-textarea,\n        paper-input {\n          height: 40px;\n          font-size: 14px;\n          margin-bottom: 6px;\n        }\n        .input-method {\n          color: var(--hax-color-text);\n          padding: 0 8px;\n          width: 80%;\n        }\n        #updatebutton {\n          outline: 1px solid black;\n        }\n        #updatebutton:hover {\n          border: none;\n        }\n      "]);return B=function(){return e},e}window.customElements.define(k.tag,k);var D=function(e){function n(){var e;return l(this,n),(e=f(this,h(n).call(this))).value=null,e.options={},e.icon="android",e.inputMethod=null,e.__inputtextarea=!1,e.__inputtextfield=!1,e.__inputboolean=!1,e.__inputcolorpicker=!1,e.__inputflipboolean=!1,import("@lrnwebcomponents/simple-colors/lib/simple-colors-picker.js"),import("@polymer/paper-input/paper-textarea.js"),import("@polymer/paper-input/paper-input.js"),import("@polymer/paper-checkbox/paper-checkbox.js"),import("@polymer/paper-tooltip/paper-tooltip.js"),import("@lrnwebcomponents/hax-body/lib/hax-context-item-menu.js"),import("@lrnwebcomponents/hax-body/lib/hax-context-item.js"),e}return u(n,t.LitElement),d(n,null,[{key:"styles",get:function(){return[t.css(B())]}}]),d(n,[{key:"render",value:function(){return t.html(I(),this.__inputselect?t.html(O(),this.label,this.__selectedValue,this.__selectedValueChanged,this.icon):t.html(z()),this.__inputtextarea?t.html(j(),this.label,this.value,this.valueChanged,this.validation,this.required):t.html(q()),this.__inputtextfield?t.html(P(),this.validationType,this.label,this.value,this.valueChanged,this.validation,this.required):t.html(A()),this.__inputboolean?t.html(T(),this.value,this.valueChanged,this.label):t.html(R()),this.__inputflipboolean?t.html(M(),this.value,this.valueChanged,this.label):t.html(E()),this.__inputcolorpicker?t.html(L(),this.label,this.value,this.valueChanged):t.html(H()),this.description,this.label)}},{key:"__selectedValueChanged",value:function(e){this.__selectedValue=e.detail.value}},{key:"valueChanged",value:function(e){"undefined"!==s(e.detail.value)?this.value=e.detail.value:this.value=e.detail}},{key:"updated",value:function(e){var t=this;e.forEach(function(e,n){"inputMethod"==n&&t._inputMethodChanged(t[n],e)})}},{key:"firstUpdated",value:function(e){this._resetInputMethods(),this.addEventListener("hax-context-item-selected",this._haxContextOperation.bind(this))}},{key:"_inputMethodChanged",value:function(e,t){var n=this;if(null!=e){var o=e;if(this.validInputMethods().includes(o)){for(this._resetInputMethods(),this["__input"+o]=!0;null!==this.firstChild;)this.removeChild(this.firstChild);var i;if("select"===o&&"undefined"!==s(this.options))for(var a in this.options)(i=document.createElement("paper-item")).attributes.value=a,i.innerHTML=this.options[a],this.appendChild(i.cloneNode(!0));setTimeout(function(){n.shadowRoot.querySelector("#input")&&"function"==typeof n.shadowRoot.querySelector("#input").hideMenu&&n.shadowRoot.querySelector("#input").hideMenu(),n.shadowRoot.querySelector("#input").focus()},500)}}}},{key:"validInputMethods",value:function(){return["flipboolean","boolean","select","textfield","textarea","datepicker","haxupload","colorpicker","iconpicker","alt","number","code-editor","array"]}},{key:"_resetInputMethods",value:function(){for(var e=this.validInputMethods(),t=0;t<e.length;t++)this["__input"+e[t]]=!1}},{key:"_haxContextOperation",value:function(e){switch(e.detail.eventName){case"hax-update-tap":if("boolean"==this.inputMethod)this.value=this.value;else if("flipboolean"==this.inputMethod)this.value=!this.value;else if("select"==this.inputMethod){var t=0;for(var n in this.options)t==this.__selectedValue&&(this.value=n),t++}var o={value:this.value,propertyToBind:this.propertyToBind,slotToBind:this.slotToBind};this.dispatchEvent(new CustomEvent("hax-input-mixer-update",{bubbles:!0,cancelable:!0,composed:!0,detail:{inputMixer:o}}))}}}],[{key:"tag",get:function(){return"hax-input-mixer"}},{key:"properties",get:function(){return{value:{type:String},label:{type:String,reflect:!0},validation:{type:String,reflect:!0},validationType:{type:String,reflect:!0,attribute:"validation-type"},required:{type:Boolean,reflect:!0},options:{type:Object},icon:{type:String,reflect:!0},description:{type:String,reflect:!0},inputMethod:{type:String,reflect:!0},propertyToBind:{type:String,reflect:!0,attribute:"property-to-bind"},slotToBind:{type:String,reflect:!0,attribute:"slot-to-bind"},__inputflipboolean:{type:Boolean},__inputcolorpicker:{type:Boolean},__inputboolean:{type:Boolean},__inputtextfield:{type:Boolean},__inputtextarea:{type:Boolean}}}}]),n}();function V(){var e=g(['\n      <div id="bodycontainer" class="ignore-activation">\n        <slot id="body"></slot>\n      </div>\n      <hax-text-context\n        id="textcontextmenu"\n        class="hax-context-menu ignore-activation"\n      ></hax-text-context>\n      <hax-ce-context\n        id="cecontextmenu"\n        class="hax-context-menu ignore-activation"\n      ></hax-ce-context>\n      <hax-plate-context\n        id="platecontextmenu"\n        class="hax-context-menu ignore-activation"\n      ></hax-plate-context>\n      <hax-input-mixer\n        id="haxinputmixer"\n        class="hax-context-menu ignore-activation"\n      ></hax-input-mixer>\n    ']);return V=function(){return e},e}function F(){var e=g(['\n        :host,\n        :host * ::slotted(*) {\n          line-height: 1.8;\n        }\n        :host ul,\n        :host * ::slotted(ul),\n        :host ol,\n        :host * ::slotted(ol) {\n          padding-left: 20px;\n          margin-left: 20px;\n        }\n        :host ul,\n        :host * ::slotted(ul) {\n          list-style-type: disc;\n        }\n        :host li,\n        :host * ::slotted(li) {\n          margin-bottom: 6px;\n        }\n        :host {\n          display: block;\n          min-height: 32px;\n          min-width: 32px;\n          outline: none;\n        }\n        .hax-context-menu {\n          padding: 0;\n          margin-left: -5000px;\n          position: absolute;\n          visibility: hidden;\n          opacity: 0;\n          z-index: 1000;\n          float: left;\n          display: block;\n          pointer-events: none;\n          transition: 0.8s opacity ease-in-out, 0.8s visibility ease-in-out;\n        }\n        #haxinputmixer {\n          z-index: 10000000;\n        }\n        .hax-context-visible.hax-active-hover {\n          visibility: visible;\n          opacity: 1;\n          pointer-events: all;\n          margin-left: unset;\n        }\n        :host #bodycontainer ::slotted(h1) {\n          font-size: var(--hax-base-styles-h1-font-size, 2.5em);\n          line-height: var(--hax-base-styles-h1-line-height, 2.5em);\n        }\n        :host #bodycontainer ::slotted(h2) {\n          font-size: var(--hax-base-styles-h2-font-size, 2em);\n        }\n        :host #bodycontainer ::slotted(h3) {\n          font-size: var(--hax-base-styles-h3-font-size, 1.75em);\n        }\n        :host #bodycontainer ::slotted(h4) {\n          font-size: var(--hax-base-styles-h4-font-size, 1.5em);\n        }\n        :host #bodycontainer ::slotted(h5) {\n          font-size: var(--hax-base-styles-h5-font-size, 1.25em);\n        }\n        :host #bodycontainer ::slotted(h6) {\n          font-size: var(--hax-base-styles-h6-font-size, 1.25em);\n        }\n        :host #bodycontainer ::slotted(p) {\n          min-height: var(--hax-base-styles-p-min-height, 43px);\n          font-size: var(--hax-base-styles-p-font-size, 24px);\n          line-height: var(--hax-base-styles-p-line-height, 1.8);\n          letter-spacing: var(--hax-base-styles-p-letter-spacing, 0.5px);\n        }\n        :host #bodycontainer ::slotted(a) {\n          color: var(--hax-base-styles-a-color, #000);\n          font-size: var(--hax-base-styles-a-font-size, 24px);\n          font-weight: var(--hax-base-styles-a-font-weight, normal);\n        }\n        :host #bodycontainer ::slotted(a:visited) {\n          color: var(--hax-base-styles-a-color-visited, #2196f3);\n        }\n        :host #bodycontainer ::slotted(a:active),\n        :host #bodycontainer ::slotted(a:focus),\n        :host #bodycontainer ::slotted(a:hover) {\n          color: var(--hax-base-styles-a-color-active, #2196f3);\n          font-weight: var(--hax-base-styles-a-font-weight-active, normal);\n        }\n        :host #bodycontainer ::slotted(ol),\n        :host #bodycontainer ::slotted(ul),\n        :host #bodycontainer ::slotted(li) {\n          padding-bottom: var(--hax-base-styles-list-padding-bottom, 1.5em);\n          line-height: var(--hax-base-styles-list-line-height, 40px);\n          font-size: var(--hax-base-styles-list-font-size, 24px);\n          max-width: var(--hax-base-styles-list-max-width, 28em);\n        }\n        :host #bodycontainer ::slotted(ol > li:last-child),\n        :host #bodycontainer ::slotted(ul > li:last-child) {\n          padding-bottom: var(\n            --hax-base-styles-list-last-child-padding-bottom,\n            1em\n          );\n        }\n        :host #bodycontainer ::slotted(ul),\n        :host #bodycontainer ::slotted(ol) {\n          padding-left: var(--hax-base-styles-list-padding-left, 20px);\n          padding-left: var(--hax-base-styles-list-margin-left, 20px);\n        }\n\n        :host([edit-mode]) #bodycontainer ::slotted(*[data-editable]) {\n          outline: none;\n          outline-offset: 2px;\n          transition: 0.2s width ease-in-out, 0.2s height ease-in-out,\n            0.2s margin ease-in-out;\n          caret-color: var(--hax-color-text);\n        }\n        :host([edit-mode]) #bodycontainer ::slotted(*[data-editable]:hover) {\n          outline: 1px solid rgba(145, 151, 162, 0.25);\n          caret-color: #000000;\n        }\n        :host([edit-mode])\n          #bodycontainer\n          ::slotted(*.hax-active[data-editable]:hover) {\n          cursor: text !important;\n          outline: 1px solid rgba(145, 151, 162, 0.25);\n        }\n        :host([edit-mode])\n          #bodycontainer\n          ::slotted(*[data-editable] .hax-active:hover) {\n          cursor: text !important;\n          outline: 1px solid rgba(145, 151, 162, 0.25);\n        }\n        :host([edit-mode])\n          #bodycontainer\n          ::slotted(code.hax-active[data-editable]) {\n          display: block;\n        }\n        :host([edit-mode]) #bodycontainer ::slotted(hr[data-editable]) {\n          height: 2px;\n          background-color: #eeeeee;\n          padding-top: 4px;\n          padding-bottom: 4px;\n        }\n        /** Fix to support safari as it defaults to none */\n        :host([edit-mode]) #bodycontainer ::slotted(*[data-editable]) {\n          -webkit-user-select: text;\n          cursor: pointer;\n        }\n\n        :host([edit-mode])\n          #bodycontainer\n          ::slotted(*[data-editable]::-moz-selection),\n        :host([edit-mode])\n          #bodycontainer\n          ::slotted(*[data-editable] *::-moz-selection) {\n          background-color: var(--hax-body-highlight, --paper-yellow-300);\n          color: black;\n        }\n        :host([edit-mode])\n          #bodycontainer\n          ::slotted(*[data-editable]::selection),\n        :host([edit-mode])\n          #bodycontainer\n          ::slotted(*[data-editable] *::selection) {\n          background-color: var(--hax-body-highlight, --paper-yellow-300);\n          color: black;\n        }\n        #bodycontainer {\n          -webkit-user-select: text;\n          user-select: text;\n        }\n        :host([edit-mode][hax-ray-mode])\n          #bodycontainer\n          ::slotted(*[data-editable]):before {\n          content: attr(data-hax-ray) " " attr(resource) " " attr(typeof) " "\n            attr(property) " " attr(content);\n          font-size: 10px;\n          font-style: italic;\n          left: unset;\n          right: unset;\n          top: unset;\n          background-color: #d3d3d3;\n          color: #000000;\n          bottom: unset;\n          width: auto;\n          padding: 8px;\n          margin: 0;\n          z-index: 1;\n          margin: -16px 0 0 0;\n          float: right;\n          line-height: 2;\n        }\n      ']);return F=function(){return e},e}window.customElements.define(D.tag,D);var U=function(e){function c(){var e;return l(this,c),(e=f(this,h(c).call(this))).editMode=!1,e.globalPreferences={},e.haxRayMode=!1,e.activeNode=null,e.activeContainerNode=null,import("@polymer/iron-a11y-keys/iron-a11y-keys.js"),import("@polymer/paper-item/paper-item.js"),import("@lrnwebcomponents/grid-plate/grid-plate.js"),e}return u(c,n.SimpleColors),d(c,null,[{key:"styles",get:function(){return[t.css(F())]}}]),d(c,[{key:"render",value:function(){return t.html(V())}},{key:"firstUpdated",value:function(e){var t=this;this.dispatchEvent(new CustomEvent("hax-register-body",{bubbles:!0,cancelable:!0,composed:!0,detail:this})),this.polyfillSafe=window.HaxStore.instance.computePolyfillSafe(),this._observer=new i.FlattenedNodesObserver(this,function(e){a.flush(),e.addedNodes.length>0&&e.addedNodes.map(function(e){if(t._haxElementTest(e)){t._HTMLPrimativeTest(e)&&(e.contentEditable=t.editMode),e.setAttribute("data-editable",t.editMode);var n=e.tagName.replace("-"," ").toLowerCase(),o=window.HaxStore.instance.gizmoList.findIndex(function(t){return t.tag===e.tagName.toLowerCase()});-1!==o&&(n=window.HaxStore.instance.gizmoList[o].title),e.setAttribute("data-hax-ray",n),t.dispatchEvent(new CustomEvent("hax-body-tag-added",{bubbles:!0,cancelable:!0,composed:!0,detail:{node:e}}))}}),e.removedNodes.length>0&&e.removedNodes.map(function(e){t._haxElementTest(e)&&!e.classList.contains("hax-active")&&t.dispatchEvent(new CustomEvent("hax-body-tag-removed",{bubbles:!0,cancelable:!0,composed:!0,detail:{node:e}}))})}),this.addEventListener("hax-context-item-selected",this._haxContextOperation.bind(this)),this.addEventListener("hax-input-mixer-update",this._haxInputMixerOperation.bind(this)),this.addEventListener("place-holder-replace",this.replacePlaceholder.bind(this));try{document.execCommand("enableObjectResizing",!1,!1),document.execCommand("defaultParagraphSeparator",!1,"p")}catch(e){console.warn(e)}window.addEventListener("keydown",this._onKeyDown.bind(this)),window.addEventListener("keypress",this._onKeyPress.bind(this)),this.shadowRoot.querySelector("slot").addEventListener("mousemove",this.hoverEvent.bind(this)),this.shadowRoot.querySelector("slot").addEventListener("mouseup",function(e){var t=window.HaxStore.getSelection();window.HaxStore._tmpSelection=t;try{var n=window.HaxStore.getRange();n.cloneRange&&(window.HaxStore._tmpRange=n.cloneRange())}catch(e){console.warn(e)}}),document.body.addEventListener("hax-store-property-updated",this._haxStorePropertyUpdated.bind(this)),window.addEventListener("scroll",this._keepContextVisible.bind(this)),this.addEventListener("focusin",this._focusIn.bind(this)),this.addEventListener("mousedown",this._focusIn.bind(this)),this.editMode=window.HaxStore.instance.editMode,this.__tabTrap=!1}},{key:"updated",value:function(e){var t=this;e.forEach(function(e,n){"editMode"==n&&t._editModeChanged(t[n],e),"globalPreferences"==n&&t._globalPreferencesUpdated(t[n],e),"activeNode"==n&&(t._activeNodeChanged(t[n],e),t.dispatchEvent(new CustomEvent("active-node-changed",{detail:{value:t[n]}}))),"activeContainerNode"==n&&(t._activeContainerNodeChanged(t[n],e),t.dispatchEvent(new CustomEvent("active-container-node-changed",{detail:{value:t[n]}})))})}},{key:"disconnectedCallback",value:function(){this._observer&&(this._observer.disconnect(),this._observer=null),b(h(c.prototype),"disconnectedCallback",this).call(this)}},{key:"_keepContextVisible",value:function(e){var t=!1;this.shadowRoot.querySelector("#textcontextmenu").classList.contains("hax-context-visible")?t=this.shadowRoot.querySelector("#textcontextmenu"):this.shadowRoot.querySelector("#cecontextmenu").classList.contains("hax-context-visible")&&(t=this.shadowRoot.querySelector("#cecontextmenu")),t&&(this.elementInViewport(t)?t.classList.remove("hax-context-pin-bottom","hax-context-pin-top"):this.__OffBottom?t.classList.add("hax-context-pin-top"):t.classList.add("hax-context-pin-bottom"))}},{key:"_onKeyDown",value:function(e){var t=this;if(this.editMode&&this.getAttribute("contenteditable")){var n=window.HaxStore.getRange();switch(e.key){case"Tab":window.HaxStore.instance.isTextElement(this.activeContainerNode)&&(e.detail.keyboardEvent&&(e.detail.keyboardEvent.preventDefault(),e.detail.keyboardEvent.stopPropagation(),e.detail.keyboardEvent.stopImmediatePropagation()),e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),e.shiftKey?this._tabBackKeyPressed():this._tabKeyPressed());break;case"Enter":this.setAttribute("contenteditable",!0),setTimeout(function(){n.commonAncestorContainer&&"function"==typeof n.commonAncestorContainer.focus&&(n.commonAncestorContainer.focus(),t.__focusLogic(n.commonAncestorContainer))},900);break;case"ArrowUp":case"ArrowDown":case"ArrowLeft":case"ArrowRight":n.commonAncestorContainer&&this.activeNode!==n.commonAncestorContainer&&"function"==typeof n.commonAncestorContainer.focus?"HAX-BODY"!==n.commonAncestorContainer.tagName&&(window.HaxStore.instance.isTextElement(n.commonAncestorContainer)?this.setAttribute("contenteditable",!0):this.removeAttribute("contenteditable"),setTimeout(function(){n.commonAncestorContainer.focus(),t.__focusLogic(n.commonAncestorContainer)},900)):n.commonAncestorContainer&&n.commonAncestorContainer.parentNode&&this.activeNode!==n.commonAncestorContainer.parentNode&&"function"==typeof n.commonAncestorContainer.parentNode.focus&&"HAX-BODY"!==n.commonAncestorContainer.parentNode.tagName&&(window.HaxStore.instance.isTextElement(n.commonAncestorContainer.parentNode)?this.setAttribute("contenteditable",!0):this.removeAttribute("contenteditable"),setTimeout(function(){n.commonAncestorContainer.parentNode.focus(),t.__focusLogic(n.commonAncestorContainer.parentNode)},900))}this.shadowRoot.querySelector("#platecontextmenu").classList.contains("hax-active-hover")&&this.__dropActiveHover()}}},{key:"_onKeyPress",value:function(e){this.editMode&&this.shadowRoot.querySelector("#platecontextmenu").classList.contains("hax-active-hover")&&this.__dropActiveHover()}},{key:"hoverEvent",value:function(e){if(this.editMode&&(e.target&&null!=e.target.getAttribute("data-hax-ray")?(this.__activeHover=e.target,this.dispatchEvent(new CustomEvent("hax-active-hover-name",{bubbles:!0,cancelable:!0,composed:!0,detail:e.target.getAttribute("data-hax-ray")}))):e.target&&e.target.parentNode&&null!=e.target.parentNode.getAttribute("data-hax-ray")&&(this.__activeHover=e.target.parentNode,this.dispatchEvent(new CustomEvent("hax-active-hover-name",{bubbles:!0,cancelable:!0,composed:!0,detail:e.target.parentNode.getAttribute("data-hax-ray")}))),!this.shadowRoot.querySelector("#platecontextmenu").classList.contains("hax-active-hover"))){var t=e.target;e.target===this.shadowRoot.querySelector("#cecontextmenu")||e.target===this.shadowRoot.querySelector("#textcontextmenu")||e.target===this.shadowRoot.querySelector("#platecontextmenu")||t===this.activeNode||t===this.activeContainerNode||e.target===this.activeNode||e.target===this.activeContainerNode||t.parentNode===this.activeContainerNode||t.parentNode.parentNode===this.activeContainerNode||t.parentNode.parentNode.parentNode===this.activeContainerNode?(this.__addActiveHover(),this.__typeLock=!1):this.__dropActiveHover()}}},{key:"__addActiveHover",value:function(){this.shadowRoot.querySelector("#cecontextmenu").classList.add("hax-active-hover"),this.shadowRoot.querySelector("#textcontextmenu").classList.add("hax-active-hover"),this.shadowRoot.querySelector("#platecontextmenu").classList.add("hax-active-hover")}},{key:"__dropActiveHover",value:function(){this.shadowRoot.querySelector("#cecontextmenu").classList.remove("hax-active-hover"),this.shadowRoot.querySelector("#textcontextmenu").classList.remove("hax-active-hover"),this.shadowRoot.querySelector("#platecontextmenu").classList.remove("hax-active-hover")}},{key:"elementInViewport",value:function(e){for(var t=e.offsetTop-32-window.HaxStore.instance.haxPanel.shadowRoot.querySelector("#drawer").offsetHeight,n=e.offsetLeft,o=e.offsetWidth,i=e.offsetHeight;e.offsetParent;)t+=(e=e.offsetParent).offsetTop,n+=e.offsetLeft;return this.__OffBottom=t<window.pageYOffset+window.innerHeight,t<window.pageYOffset+window.innerHeight&&n<window.pageXOffset+window.innerWidth&&t+i>window.pageYOffset&&n+o>window.pageXOffset}},{key:"replacePlaceholder",value:function(e){var t=this;if("text"===e.detail){var n=document.createElement("p");n.innerHTML="<br/>",this.haxReplaceNode(this.activeNode,n,this.activeNode.parentNode),setTimeout(function(){t.activeNode=n,window.HaxStore.write("activeNode",n,t),t.activeContainerNode.setAttribute("contenteditable",!0),n.focus(),t.__focusLogic(n)},210)}else this.replaceElementWorkflow()}},{key:"replaceElementWorkflow",value:function(){var e=window.HaxStore.nodeToHaxElement(this.activeNode,null),t="*",n=!1;"place-holder"===e.tag&&"undefined"!==s(e.properties.type)&&(t=e.properties.type,n=!0);var o={};if("undefined"!==s(window.HaxStore.instance.elementList[e.tag])&&!1!==window.HaxStore.instance.elementList[e.tag].gizmo&&"undefined"!==s(window.HaxStore.instance.elementList[e.tag].gizmo.handles)&&window.HaxStore.instance.elementList[e.tag].gizmo.handles.length>0)for(var i=window.HaxStore.instance.elementList[e.tag].gizmo,a=0;a<i.handles.length;a++)for(var r in i.handles[a])"type"!==r&&"undefined"!==s(e.properties[i.handles[a][r]])&&(o[r]=e.properties[i.handles[a][r]]);var l=window.HaxStore.guessGizmo(t,o,n);if(l.length>0){var c=this.activeNode.tagName.toLowerCase(),d=c.replace("-"," ");"undefined"!==s(window.HaxStore.instance.elementList[c])&&!1!==window.HaxStore.instance.elementList[c].gizmo&&(d=window.HaxStore.instance.elementList[c].gizmo.title),window.HaxStore.instance.haxAppPicker.presentOptions(l,"__convert","Transform ".concat(d," to.."),"gizmo")}else window.HaxStore.toast("Sorry, this can not be transformed!",5e3)}},{key:"_globalPreferencesUpdated",value:function(e,t){"undefined"!==s(e)&&null!=e&&(this.haxRayMode=e.haxRayMode)}},{key:"_haxStorePropertyUpdated",value:function(e){e.detail&&"undefined"!==s(e.detail.value)&&e.detail.property&&(this[e.detail.property]=e.detail.value)}},{key:"haxClearBody",value:function(){var e=!0;(!(arguments.length>0&&void 0!==arguments[0])||arguments[0])&&(e=prompt("Are you sure you want to delete all content?")),e&&r.wipeSlot(this)}},{key:"haxInsert",value:function(e,t){var n=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];this.__activeHover=null;var a=document.createElement(e);a.innerHTML=t;var r=a.cloneNode(!0);for(var l in o){var c=window.HaxStore.camelToDash(l);o.hasOwnProperty(l)&&(!0===o[l]?r.setAttribute(c,c):!1===o[l]?r.removeAttribute(c):null!=o[l]&&o[l].constructor===Array?r.properties&&r.properties[l].readOnly||(r.set?r.set(c,o[l]):r[c]=o[l]):null!=o[l]&&o[l].constructor===Object?r.properties&&r.properties[l].readOnly||(r.set?r.set(c,o[l]):r[c]=o[l]):r.setAttribute(c,o[l]))}return null!==window.HaxStore.instance.activePlaceHolder&&"undefined"!==s(window.HaxStore.instance.activePlaceHolder.style)?(r.style.width=window.HaxStore.instance.activePlaceHolder.style.width,r.style.float=window.HaxStore.instance.activePlaceHolder.style.float,r.style.margin=window.HaxStore.instance.activePlaceHolder.style.margin,r.style.display=window.HaxStore.instance.activePlaceHolder.style.display,this.haxReplaceNode(window.HaxStore.instance.activePlaceHolder,r,window.HaxStore.instance.activePlaceHolder.parentNode),window.HaxStore.instance.activePlaceHolder=null):null!=this.activeContainerNode?"GRID-PLATE"!==r.tagName&&"GRID-PLATE"===this.activeContainerNode.tagName&&this.activeContainerNode!==this.activeNode?(null!=this.activeNode.getAttribute("slot")&&r.setAttribute("slot",this.activeNode.getAttribute("slot")),this.activeContainerNode.insertBefore(r,this.activeNode)):this.insertBefore(r,this.activeContainerNode.nextElementSibling):this.appendChild(r),this.shadowRoot.querySelector("#textcontextmenu").highlightOps=!1,this.__updateLockFocus=r,i&&setTimeout(function(){n.breakUpdateLock()},50),!0}},{key:"breakUpdateLock",value:function(){window.HaxStore.write("activeContainerNode",this.__updateLockFocus,this),window.HaxStore.write("activeNode",this.__updateLockFocus,this),this.__updateLockFocus.focus(),"function"==typeof this.__updateLockFocus.scrollIntoViewIfNeeded?this.__updateLockFocus.scrollIntoViewIfNeeded(!0):this.__updateLockFocus.scrollIntoView({behavior:"smooth",inline:"center"})}},{key:"haxToContent",value:function(){this.hideContextMenus();var e=this.activeNode;this.activeNode=null,this.activeContainerNode=null,window.HaxStore.write("activeNode",null,this),window.HaxStore.write("activeContainerNode",null,this);var t="slot"===this.shadowRoot.querySelector("#body").localName?o.wrap(this.shadowRoot.querySelector("#body")).assignedNodes({flatten:!0}):[];this.globalPreferences.haxDeveloperMode&&console.warn(t);for(var n="",i=0,a=t.length;i<a;i++)this._haxElementTest(t[i])?(t[i].removeAttribute("data-editable"),t[i].removeAttribute("data-hax-ray"),t[i].contentEditable=!1,n+=window.HaxStore.nodeToContent(t[i]),"grid-plate"===t[i].tagName.toLowerCase()&&this._applyContentEditable(this.editMode,t[i])):8===t[i].nodeType?n+="\x3c!-- "+t[i].textContent+" --\x3e":1!==t[i].nodeType&&"undefined"!==s(t[i].textContent)&&"undefined"!==t[i].textContent&&(n+=t[i].textContent);if(n=(n=(n=(n=(n=(n=(n=(n=(n=n.replace(/\scontenteditable=\"false\"/g,"")).replace(/\sdata-editable=\"true\"/g,"")).replace(/\sdata-editable=\"false\"/g,"")).replace(/\sdata-editable=\""/g,"")).replace(/\sdata-editable/g,"")).replace(/\scontenteditable/g,"")).replace(/\sdraggable/g,"")).replace(/\sdata-draggable/g,"")).replace(/\sdata-hax-ray=\".*?\"/g,""),this.parentNode.tagName){var l=this.parentNode.tagName.toLowerCase(),c="style-scope "+l+" x-scope",d=new RegExp(c,"g");n=n.replace(d,""),c="style-scope "+l,d=new RegExp(c,"g"),n=n.replace(d,""),c="x-scope "+l+"-0",d=new RegExp(c,"g"),n=n.replace(d,"");var u=window.HaxStore.instance.validTagList;for(var i in u.push("hax-preview"),u)c="style-scope "+u[i],d=new RegExp(c,"g"),n=n.replace(d,""),c="x-scope "+u[i]+"-0 ",d=new RegExp(c,"g"),n=n.replace(d,""),c="x-scope "+u[i]+"-0",d=new RegExp(c,"g"),n=n.replace(d,"")}return n=(n=n.replace(/\sclass=\"\"/g,"")).replace(/\sclass=\"\s\"/g,""),this._applyContentEditable(this.editMode),window.HaxStore.write("activeNode",e,this),window.HaxStore.write("activeContainerNode",e,this),n=r.encapScript(n),this.globalPreferences.haxDeveloperMode&&console.warn(n),n}},{key:"haxDuplicateNode",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this;this.hideContextMenus();var o=window.HaxStore.nodeToHaxElement(e,null);"undefined"!==s(e.preProcessHaxInsertContent)&&(o=e.preProcessHaxInsertContent(o));var i=window.HaxStore.haxElementToNode(o.tag,o.content,o.properties);return"webview"===i.tagName.toLowerCase()&&window.HaxStore.instance._isSandboxed&&"undefined"!==s(i.guestinstance)&&delete i.guestinstance,null!==e?n.insertBefore(i,e.nextSibling):n.appendChild(i),setTimeout(function(){n===t&&window.HaxStore.write("activeContainerNode",i,t),window.HaxStore.write("activeNode",i,t)},50),!0}},{key:"hideContextMenus",value:function(){this._hideContextMenu(this.shadowRoot.querySelector("#textcontextmenu")),this._hideContextMenu(this.shadowRoot.querySelector("#cecontextmenu")),this._hideContextMenu(this.shadowRoot.querySelector("#platecontextmenu")),this._hideContextMenu(this.shadowRoot.querySelector("#haxinputmixer")),this.shadowRoot.querySelector("#textcontextmenu").highlightOps=!1}},{key:"positionContextMenus",value:function(e,t){if(e){var n=e.tagName.toLowerCase();window.HaxStore.instance._isSandboxed&&"webview"===n&&(n="iframe");var o=window.HaxStore.instance.elementList[n];"undefined"===s(o)||window.HaxStore.instance.isTextElement(e)?this.__activeContextType=this.shadowRoot.querySelector("#textcontextmenu"):(this.__activeContextType=this.shadowRoot.querySelector("#cecontextmenu"),o.element=e,this.__activeContextType.setHaxProperties(o)),this._positionContextMenu(this.__activeContextType,t,-39,-39),this._positionContextMenu(this.shadowRoot.querySelector("#platecontextmenu"),t,-39,0),t&&!this._HTMLPrimativeTest(e)&&e!==t?t.contentEditable=!1:t&&this._HTMLPrimativeTest(t)&&(t.contentEditable=!0)}}},{key:"haxMoveGridPlate",value:function(e,t,n){var o=this;switch(e){case"first":null!==n.previousElementSibling&&this.insertBefore(n,this.firstChild);break;case"up":null!==n.previousElementSibling&&this.insertBefore(n,n.previousElementSibling);break;case"down":null!==n.nextElementSibling&&this.insertBefore(n.nextElementSibling,n);break;case"last":null!==n.nextElementSibling&&this.appendChild(n)}return setTimeout(function(){o.positionContextMenus(t,n),"function"==typeof n.scrollIntoViewIfNeeded?n.scrollIntoViewIfNeeded(!0):n.scrollIntoView({behavior:"smooth",inline:"center"})},5),!0}},{key:"haxReplaceNode",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this;this.hideContextMenus();try{e&&e.getAttribute&&null!=e.getAttribute("slot")&&t.setAttribute("slot",e.getAttribute("slot")),null==e&&(e=this.__oldActiveNode,n=this.__oldActiveNode.parentNode),n.replaceChild(t,e)}catch(e){console.warn(e)}return t}},{key:"haxChangeTagName",value:function(e,t,n){this.hideContextMenus();for(var o=document.createElement(t),a=0,r=e.attributes.length;a<r;++a){var s=e.attributes.item(a).nodeName,l=e.attributes.item(a).value;o.setAttribute(s,l)}o.innerHTML=e.innerHTML.trim(),"ul"==t||"ol"==t?""==o.innerHTML?o.innerHTML="<li></li>":"ul"!=e.tagName.toLowerCase()&&"ol"!=e.tagName.toLowerCase()&&(o.innerHTML="<li>"+e.innerHTML.trim().replace(/<br\/>/g,"</li>\n<li>").replace(/<br>/g,"</li>\n<li>")+"</li>"):"ul"!=e.tagName.toLowerCase()&&"ol"!=e.tagName.toLowerCase()||(o.innerHTML=o.innerHTML.replace(/<ul>/g,"").replace(/<\/ul>/g,"").replace(/<li><\/li>/g,"").replace(/<li>/g,"").replace(/<\/li>/g,"<br/>"));try{this.replaceChild(o,e),setTimeout(function(){var e=i.FlattenedNodesObserver.getFlattenedNodes(o);e[0]&&e.tagName?e[0].focus():o.focus()},50)}catch(t){console.warn(t),console.warn(o),console.warn(e)}return o}},{key:"haxDeleteNode",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this;if(this.hideContextMenus(),null!=this.activeContainerNode&&null!==this.activeContainerNode.previousElementSibling){if(this.activeContainerNode.previousElementSibling.focus(),null!=this.activeContainerNode&&window.HaxStore.instance.isTextElement(this.activeContainerNode)&&""!==this.activeContainerNode.textContent)try{var n=document.createRange(),o=window.HaxStore.getSelection();n.setStart(this.activeContainerNode,1),n.collapse(!0),o.removeAllRanges(),o.addRange(n),this.activeContainerNode.focus()}catch(e){console.warn(e)}}else null!=this.activeContainerNode&&null!==this.activeContainerNode.nextElementSibling?this.activeContainerNode.nextElementSibling.focus():(this.activeNode=null,this.activeContainerNode=null,window.HaxStore.write("activeNode",null,this),window.HaxStore.write("activeContainerNode",null,this));try{return t.removeChild(e)}catch(e){console.warn(e)}}},{key:"importContent",value:function(e){var t=this;(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&r.wipeSlot(this,"*"),setTimeout(function(){e=r.encapScript(e);var n=document.createElement("div");for(n.insertAdjacentHTML("beforeend",e);null!==n.firstChild;)if("undefined"!==s(n.firstChild.tagName))if(window.HaxStore.instance._isSandboxed&&"iframe"===n.firstChild.tagName.toLowerCase()){for(var o=document.createElement("webview"),i=0,a=n.firstChild.attributes.length;i<a;++i){var l=n.firstChild.attributes.item(i).nodeName,c=n.firstChild.attributes.item(i).value;"height"!==l&&"width"!==l||o.style[l],o.setAttribute(l,c)}t.appendChild(o)}else t.appendChild(n.firstChild);else n.removeChild(n.firstChild)},50)}},{key:"_haxContextOperation",value:function(e){var t,n=this,o=e.detail;switch(o.eventName){case"p":case"ol":case"ul":case"h2":case"h3":case"h4":case"h5":case"h6":case"blockquote":case"code":this.shadowRoot.querySelector("#textcontextmenu").realSelectedValue=o.eventName,window.HaxStore.write("activeContainerNode",this.haxChangeTagName(this.activeContainerNode,o.eventName),this),this.positionContextMenus(this.activeNode,this.activeContainerNode);break;case"text-align-left":this.activeNode.style.textAlign=null,this.positionContextMenus(this.activeNode,this.activeContainerNode);break;case"grid-plate-convert":this.replaceElementWorkflow();break;case"grid-plate-duplicate":this.activeNode===this.activeContainerNode?this.haxDuplicateNode(this.activeNode):this.haxDuplicateNode(this.activeNode,this.activeContainerNode);break;case"grid-plate-delete":if(null!=this.activeNode){var i=this.activeNode.tagName.toLowerCase(),a=i.replace("-"," ");"undefined"!==s(window.HaxStore.instance.elementList[i])&&!1!==window.HaxStore.instance.elementList[i].gizmo&&(a=window.HaxStore.instance.elementList[i].gizmo.title),window.HaxStore.instance.haxAppPicker.presentOptions([{icon:"thumb-up",color:"green",title:"Yes"},{icon:"thumb-down",color:"red",title:"No"}],"","Remove this `".concat(a,"`?"),"delete")}break;case"grid-plate-first":this.haxMoveGridPlate("first",this.activeNode,this.activeContainerNode);break;case"grid-plate-up":this.haxMoveGridPlate("up",this.activeNode,this.activeContainerNode);break;case"hax-manager-open":window.HaxStore.write("activeHaxElement",{},this),window.HaxStore.instance.haxManager.resetManager(parseInt(o.value)),window.HaxStore.instance.haxManager.toggleDialog();break;case"grid-plate-down":this.haxMoveGridPlate("down",this.activeNode,this.activeContainerNode);break;case"grid-plate-last":this.haxMoveGridPlate("last",this.activeNode,this.activeContainerNode);break;case"close-menu":this.activeNode=null,this.activeContainerNode=null,window.HaxStore.write("activeNode",null,this),window.HaxStore.write("activeContainerNode",null,this);break;case"hax-edit-property":var r=this.shadowRoot.querySelector("#haxinputmixer");r.label=o.target.label,r.options=o.target.options,r.icon=o.target.icon,r.description=o.target.description,r.required=o.target.required,r.validation=o.target.validation,r.validationType=o.target.validationType,r.inputMethod=o.target.inputMethod,r.value="","undefined"!==s(o.target.propertyToBind)&&null!=o.target.propertyToBind&&0!=o.target.propertyToBind&&(r.propertyToBind=o.target.propertyToBind,"undefined"!==s(this.activeNode[o.target.propertyToBind])?r.value=this.activeNode[o.target.propertyToBind]:r.value=this.activeNode.getAttribute(o.target.propertyToBind)),this._positionContextMenu(r,this.activeContainerNode,-1,-38);var l=this.shadowRoot.querySelector("#cecontextmenu").currentStyle||window.getComputedStyle(this.shadowRoot.querySelector("#cecontextmenu"));r.style.width=l.width.replace("px","")-40+"px";break;case"hax-align-left":this.activeNode.style.float=null,this.activeNode.style.margin=null,this.activeNode.style.display=null,setTimeout(function(){n.positionContextMenus(n.activeNode,n.activeContainerNode)},200);break;case"hax-align-center":this.activeNode.style.float=null,this.activeNode.style.margin="0 auto",this.activeNode.style.display="block",setTimeout(function(){n.positionContextMenus(n.activeNode,n.activeContainerNode)},200);break;case"hax-size-change":this.activeNode&&(this.activeNode.style.width=o.value+"%",setTimeout(function(){n.positionContextMenus(n.activeNode,n.activeContainerNode)},100));break;case"hax-manager-configure":this._hideContextMenu(this.shadowRoot.querySelector("#haxinputmixer")),window.HaxStore.instance.haxManager.resetManager(),t=window.HaxStore.nodeToHaxElement(this.activeNode),window.HaxStore.write("activeHaxElement",t,this),window.HaxStore.instance.haxManager.editExistingNode=!0,window.HaxStore.instance.haxManager.selectStep("configure"),window.HaxStore.instance.haxManager.toggleDialog(),setTimeout(function(){window.HaxStore.instance.haxManager.shadowRoot.querySelector("#preview").shadowRoot.querySelector("#configurebutton").focus()},100);break;case"hax-manager-configure-container":window.HaxStore.write("activeNode",window.HaxStore.instance.activeContainerNode,this),this._hideContextMenu(this.shadowRoot.querySelector("#haxinputmixer")),window.HaxStore.instance.haxManager.resetManager(),t=window.HaxStore.nodeToHaxElement(window.HaxStore.instance.activeNode),window.HaxStore.write("activeHaxElement",t,this),window.HaxStore.instance.haxManager.editExistingNode=!0,window.HaxStore.instance.haxManager.selectStep("configure"),window.HaxStore.instance.haxManager.toggleDialog(),setTimeout(function(){window.HaxStore.instance.haxManager.shadowRoot.querySelector("#preview").shadowRoot.querySelector("#configurebutton").focus()},100)}}},{key:"_haxInputMixerOperation",value:function(e){var t=e.detail.inputMixer;null!=t.propertyToBind?this.activeNode[t.propertyToBind]=t.value:null!=t.slotToBind&&(item=document.createElement("span"),item.style.height="inherit",item.innerHTML=t.value,item.slot=t.slotToBind,this.activeNode.appendChild(item)),this._hideContextMenu(this.shadowRoot.querySelector("#haxinputmixer"))}},{key:"_focusIn",value:function(e){this.__focusLogic(e.target)&&e.stopPropagation()}},{key:"__focusLogic",value:function(e){var t=!1;if(this.editMode&&!this.__tabTrap){var n=e;"SPAN"===n.tagName&&window.HaxStore.instance.isTextElement(e.parentNode)&&(n=e.parentNode);var o=null;if(this._haxElementTest(n)&&null!=n.parentNode){for(;"HAX-BODY"!=n.parentNode.tagName;)null===o&&"LI"!==n.tagName&&"B"!==n.tagName&&"I"!==n.tagName&&"STRONG"!==n.tagName&&"EM"!==n.tagName&&(o=n),n=n.parentNode;null===o?o=n:window.HaxStore.instance.isGridPlateElement(n)?["UL","OL","LI","P","GRID-PLATE"].includes(n.tagName)&&["UL","OL","LI"].includes(o.tagName)&&(o=n):o=n,this.activeContainerNode===n||n.classList.contains("ignore-activation")?n.classList.contains("ignore-activation")&&(t=!0):(this.hideContextMenus(),this.activeContainerNode=n,window.HaxStore.write("activeContainerNode",n,this),t=!0),this.activeNode===o||o.classList.contains("ignore-activation")||(this.activeNode=o,window.HaxStore.write("activeNode",o,this),this.positionContextMenus(o,n),t=!0)}}else this.__tabTrap=!1;return t}},{key:"_editModeChanged",value:function(e,t){"undefined"!==s(t)&&(this._applyContentEditable(e),this.setAttribute("tabindex","-1"),!1!==e&&"undefined"!==s(this.activeNode)&&null!==this.activeNode&&this.positionContextMenus(this.activeNode,this.activeContainerNode)),!1===e&&(this.removeAttribute("contenteditable"),this.hideContextMenus())}},{key:"_haxResolvePreviousElement",value:function(e){for(e=e.previousElementSibling;null!=e&&"undefined"!==s(e.tagName)&&"HAX-"===e.tagName.substring(0,4);)e=e.previousElementSibling;return e}},{key:"_haxElementTest",value:function(e){return"undefined"!==s(e.tagName)&&"HAX-"!==e.tagName.substring(0,4)}},{key:"_HTMLPrimativeTest",value:function(e){return null!=e&&"undefined"!==s(e.tagName)&&-1==e.tagName.indexOf("-")}},{key:"_applyContentEditable",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.shadowRoot.querySelector("#body"),n="slot"===t.localName?o.wrap(t).assignedNodes({flatten:!0}):[];0===n.length&&(n=i.FlattenedNodesObserver.getFlattenedNodes(t));for(var a=0,r=n.length;a<r;a++){if(this._HTMLPrimativeTest(n[a]))if(e){if(n[a].setAttribute("contenteditable",e),n[a].setAttribute("data-editable",e),n[a].querySelectorAll("a").length>0)for(var s=n[a].querySelectorAll("a"),l=0,c=s.length;l<c;l++)s[l].setAttribute("contenteditable",e),s[l].setAttribute("data-editable",e),s[l].addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation()})}else if(n[a].removeAttribute("data-editable",e),n[a].removeAttribute("contenteditable",e),n[a].querySelectorAll("a").length>0){var d=n[a].querySelectorAll("a");for(l=0,c=d.length;l<c;l++)d[l].removeAttribute("data-editable",e),d[l].removeAttribute("contenteditable",e),d[l].removeEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation()})}if(this._haxElementTest(n[a]))if(e){n[a].setAttribute("data-editable",e);var u=n[a].tagName.replace("-"," ").toLowerCase(),h=window.HaxStore.instance.gizmoList.findIndex(function(e){return e.tag===n[a].tagName.toLowerCase()});-1!==h&&(u=window.HaxStore.instance.gizmoList[h].title),n[a].setAttribute("data-hax-ray",u)}else n[a].removeAttribute("data-editable"),n[a].removeAttribute("data-hax-ray")}}},{key:"_activeContainerNodeChanged",value:function(e,t){this.editMode&&"undefined"!==s(e)&&null!=e&&null!=e.tagName&&(window.HaxStore.instance.isTextElement(e)||window.HaxStore.instance.isGridPlateElement(e)?(e.setAttribute("contenteditable",!0),this.setAttribute("contenteditable",!0)):(e.removeAttribute("contenteditable"),this.removeAttribute("contenteditable")),"grid-plate"===e.tagName.toLowerCase()&&(e.editMode=this.editMode,this._applyContentEditable(this.editMode,e)))}},{key:"_activeNodeChanged",value:function(e,t){var n=this;if("undefined"!==s(t)&&t&&t.classList&&t.classList.remove("hax-active"),this.editMode&&"undefined"!==s(e)&&null!==e){var o=e.tagName.toLowerCase();e.classList.add("hax-active"),window.HaxStore.instance.isTextElement(e)||window.HaxStore.instance.isGridPlateElement(e)?(e.setAttribute("contenteditable",!0),this.setAttribute("contenteditable",!0)):(e.removeAttribute("contenteditable"),this.removeAttribute("contenteditable")),this.shadowRoot.querySelector("#textcontextmenu").realSelectedValue=o,setTimeout(function(){n.positionContextMenus(e,window.HaxStore.instance.activeContainerNode)},100),"left"==e.style.textAlign?(this.shadowRoot.querySelector("#textcontextmenu").justifyIcon="editor:format-align-left",this.shadowRoot.querySelector("#textcontextmenu").justifyValue="text-align-left"):"left"==e.style.float?(this.shadowRoot.querySelector("#cecontextmenu").justifyIcon="editor:format-align-left",this.shadowRoot.querySelector("#cecontextmenu").justifyValue="hax-align-left"):"0 auto"==e.style.margin&&(this.shadowRoot.querySelector("#cecontextmenu").justifyIcon="editor:format-align-center",this.shadowRoot.querySelector("#cecontextmenu").justifyValue="hax-align-center")}else null===e&&(this.hideContextMenus(),this.__oldActiveNode=t,this.shadowRoot.querySelector("#textcontextmenu").justifyIcon="editor:format-align-left",this.shadowRoot.querySelector("#textcontextmenu").justifyValue="text-align-left")}},{key:"_getPosition",value:function(e){return{x:e.offsetLeft-e.scrollLeft+e.clientLeft,y:e.offsetTop-e.scrollTop+e.clientTop}}},{key:"_positionContextMenu",value:function(e,t,n,o){var i=this;if(null!=t){var a=this._getPosition(t);e.style.left=null!=n?a.x+n+"px":a.x+"px",e.style.top=null!=o?a.y+o+"px":a.y+"px"}e.classList.add("hax-context-visible"),this.__activeHover&&(e.classList.add("hax-active-hover"),e.style.marginLeft="",this.__typeLock=!1),setTimeout(function(){i._keepContextVisible()},100)}},{key:"_hideContextMenu",value:function(e){e.classList.remove("hax-context-visible","hax-context-pin-top","hax-context-pin-bottom"),e.style.left="-100px"}},{key:"_tabKeyPressed",value:function(){var e=!1,t=this.activeContainerNode,n=this.activeContainerNode.tagName;try{var o=window.HaxStore.getRange().cloneRange(),i=o.commonAncestorContainer.tagName;if("undefined"===s(i)&&(i=o.commonAncestorContainer.parentNode.tagName),["UL","OL","LI"].includes(n)||["UL","OL","LI"].includes(i))this.polyfillSafe&&(document.execCommand("indent"),this.__tabTrap=!0);else for(;!e;)null==t.nextSibling?e=!0:"function"===t.nextSibling.focus?(t.nextSibling.focus(),e=!0):t=t.nextSibling}catch(e){console.warn(e)}}},{key:"_tabBackKeyPressed",value:function(){var e=this.activeContainerNode,t=this.activeContainerNode.tagName;try{var n=window.HaxStore.getRange().cloneRange(),o=n.commonAncestorContainer.tagName;if("undefined"===s(o)&&(o=n.commonAncestorContainer.parentNode.tagName),["UL","OL","LI"].includes(t)||["UL","OL","LI"].includes(o))this.polyfillSafe&&(document.execCommand("outdent"),this.__tabTrap=!0);else{if(null!=e)for(;null!=e&&!this._haxElementTest(e);)e=e.previousSibling;null!=e&&setTimeout(function(){e.focus()},50)}}catch(e){console.warn(e)}}}],[{key:"tag",get:function(){return"hax-body"}},{key:"properties",get:function(){return{editMode:{type:Boolean,reflect:!0,attribute:"edit-mode"},haxRayMode:{type:Boolean,reflect:!0,attribute:"hax-ray-mode"},globalPreferences:{type:Object},activeNode:{type:Object},activeContainerNode:{type:Object}}}}]),c}();window.customElements.define(U.tag,U),e.HaxBody=U,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=hax-body.umd.js.map
