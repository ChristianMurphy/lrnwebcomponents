!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@polymer/polymer/polymer-element.js"),require("@polymer/polymer/lib/utils/wrap.js"),require("@polymer/polymer/lib/utils/flattened-nodes-observer.js"),require("@polymer/polymer/lib/utils/flush.js"),require("@polymer/polymer/lib/utils/async.js"),require("@lrnwebcomponents/hax-body/lib/haxutils.js"),require("@lrnwebcomponents/simple-colors/lib/simple-colors-polymer.js"),require("lit-element/lit-element.js"),require("@lrnwebcomponents/simple-colors/lib/simple-colors-picker.js"),require("@polymer/polymer/lib/utils/render-status.js"),require("@polymer/polymer/lib/elements/dom-module.js")):"function"==typeof define&&define.amd?define(["exports","@polymer/polymer/polymer-element.js","@polymer/polymer/lib/utils/wrap.js","@polymer/polymer/lib/utils/flattened-nodes-observer.js","@polymer/polymer/lib/utils/flush.js","@polymer/polymer/lib/utils/async.js","@lrnwebcomponents/hax-body/lib/haxutils.js","@lrnwebcomponents/simple-colors/lib/simple-colors-polymer.js","lit-element/lit-element.js","@lrnwebcomponents/simple-colors/lib/simple-colors-picker.js","@polymer/polymer/lib/utils/render-status.js","@polymer/polymer/lib/elements/dom-module.js"],t):t((e=e||self).HaxBody={},e.polymerElement_js,e.wrap_js,e.flattenedNodesObserver_js,e.flush_js,e.async,e.haxutils_js,null,e.litElement_js,null,e.renderStatus_js)}(this,function(e,t,n,o,i,a,r,s,l,c,d){"use strict";function p(e){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function m(e,t,n){return t&&h(e.prototype,t),n&&h(e,n),e}function x(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}function v(e){return(v=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function b(e,t,n){return(b=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()?Reflect.construct:function(e,t,n){var o=[null];o.push.apply(o,t);var i=new(Function.bind.apply(e,o));return n&&f(i,n.prototype),i}).apply(null,arguments)}function g(e){var t="function"==typeof Map?new Map:void 0;return(g=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,o)}function o(){return b(e,arguments,v(this).constructor)}return o.prototype=Object.create(e.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}}),f(o,e)})(e)}function y(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function w(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?y(e):t}function S(e,t,n){return(S="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=v(e)););return e}(e,t);if(o){var i=Object.getOwnPropertyDescriptor(o,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function N(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function C(){var e=N(['\n      <hax-toolbar .selected="','" hide-transform id="toolbar">\n        <hax-context-item-menu\n          slot="primary"\n          selected-value="','"\n          @selected-value-changed="','"\n          id="formatsize"\n          icon="text-format"\n          label="Format"\n          event-name="text-tag"\n        >\n          <paper-item value="p"\n            ><iron-icon icon="editor:format-textdirection-l-to-r"></iron-icon\n            >Normal text <strong>&lt;P&gt;</strong></paper-item\n          >\n          <paper-item value="ul"\n            ><iron-icon icon="editor:format-list-bulleted"></iron-icon>Bulleted\n            list <strong>&lt;UL&gt;</strong></paper-item\n          >\n          <paper-item value="ol"\n            ><iron-icon icon="editor:format-list-numbered"></iron-icon>Numbered\n            list <strong>&lt;OL&gt;</strong></paper-item\n          >\n          <paper-item value="h2"\n            ><iron-icon icon="editor:title"></iron-icon>Title\n            <strong>&lt;H2&gt;</strong></paper-item\n          >\n          <paper-item value="h3"\n            ><iron-icon icon="editor:title"></iron-icon>Content heading\n            <strong>&lt;H3&gt;</strong></paper-item\n          >\n          <paper-item value="h4"\n            ><iron-icon icon="editor:text-fields"></iron-icon>Subheading\n            <strong>&lt;H4&gt;</strong></paper-item\n          >\n          <paper-item value="h5"\n            ><iron-icon icon="editor:text-fields"></iron-icon>Deeper subheading\n            <strong>&lt;H5&gt;</strong></paper-item\n          >\n          <paper-item value="blockquote"\n            ><iron-icon icon="editor:format-quote"></iron-icon>Quote<strong\n              >&lt;blockquote&gt;</strong\n            ></paper-item\n          >\n          <paper-item value="code"\n            ><iron-icon icon="icons:code"></iron-icon>Code block<strong\n              >&lt;code&gt;</strong\n            ></paper-item\n          >\n        </hax-context-item-menu>\n        <hax-context-item-textop\n          slot="primary"\n          icon="editor:format-bold"\n          label="Bold"\n          event-name="text-bold"\n        ></hax-context-item-textop>\n        <hax-context-item-textop\n          slot="primary"\n          icon="editor:format-italic"\n          label="Italic"\n          event-name="text-italic"\n        ></hax-context-item-textop>\n        <hax-context-item-textop\n          slot="primary"\n          icon="editor:insert-link"\n          label="Link"\n          event-name="text-link"\n        ></hax-context-item-textop>\n        <hax-context-item-textop\n          slot="primary"\n          icon="editor:format-list-bulleted"\n          event-name="text-list-bulleted"\n          label="Bulleted list"\n          .hidden="','"\n        ></hax-context-item-textop>\n        <hax-context-item-textop\n          slot="primary"\n          icon="editor:format-list-numbered"\n          label="Numbered list"\n          event-name="text-list-numbered"\n          .hidden="','"\n        ></hax-context-item-textop>\n        <hax-context-item-textop\n          slot="primary"\n          icon="editor:format-indent-decrease"\n          label="Outdent"\n          event-name="text-outdent"\n          .hidden="','"\n        ></hax-context-item-textop>\n        <hax-context-item-textop\n          slot="primary"\n          icon="editor:format-indent-increase"\n          label="Indent"\n          event-name="text-indent"\n          .hidden="','"\n        ></hax-context-item-textop>\n        <hax-context-item-textop\n          slot="primary"\n          icon="editor:format-clear"\n          label="Remove format"\n          event-name="text-remove-format"\n        ></hax-context-item-textop>\n        <hax-context-item\n          slot="primary"\n          icon="device:graphic-eq"\n          label="Advanced item"\n          event-name="insert-inline-gizmo"\n          .hidden="','"\n        ></hax-context-item>\n        <hax-context-item-textop\n          slot="primary"\n          icon="device:graphic-eq"\n          label="Advanced item"\n          event-name="insert-inline-gizmo"\n          .hidden="','"\n        ></hax-context-item-textop>\n\n        <hax-context-item-textop\n          menu\n          slot="more"\n          icon="mdextra:unlink"\n          event-name="text-unlink"\n          >Remove link</hax-context-item-textop\n        >\n        <hax-context-item-textop\n          menu\n          slot="more"\n          icon="mdextra:subscript"\n          event-name="text-subscript"\n          >Subscript</hax-context-item-textop\n        >\n        <hax-context-item-textop\n          menu\n          slot="more"\n          icon="mdextra:superscript"\n          event-name="text-superscript"\n          >Superscript</hax-context-item-textop\n        >\n        <hax-context-item-textop\n          menu\n          slot="more"\n          icon="editor:format-underlined"\n          event-name="text-underline"\n          >Underline</hax-context-item-textop\n        >\n        <hax-context-item-textop\n          menu\n          slot="more"\n          icon="editor:format-strikethrough"\n          event-name="text-strikethrough"\n          >Cross out</hax-context-item-textop\n        >\n      </hax-toolbar>\n    ']);return C=function(){return e},e}function _(){var e=N(["\n        :host {\n          display: block;\n          pointer-events: none;\n        }\n        :host [hidden] {\n          display: none;\n        }\n        paper-item {\n          -webkit-justify-content: flex-start;\n          justify-content: flex-start;\n          height: 36px;\n          padding: 0 8px;\n          min-height: 36px;\n        }\n        paper-item:hover {\n          background-color: #d3d3d3;\n          cursor: pointer;\n        }\n        iron-icon {\n          padding: 8px;\n        }\n        paper-item strong {\n          padding: 8px;\n          font-size: 12px;\n        }\n        :host(.hax-context-pin-top) hax-toolbar {\n          position: fixed;\n          top: 64px;\n          opacity: 0.95;\n        }\n        :host(.hax-context-pin-bottom) hax-toolbar {\n          position: fixed;\n          bottom: 0;\n          opacity: 0.95;\n        }\n      "]);return _=function(){return e},e}var k=function(e){function t(){var e;return u(this,t),e=w(this,v(t).call(this)),import("@polymer/paper-item/paper-item.js"),import("@polymer/iron-icons/iron-icons.js"),import("@polymer/iron-icon/iron-icon.js"),import("@lrnwebcomponents/md-extra-icons/md-extra-icons.js"),import("@lrnwebcomponents/hax-body/lib/hax-context-item-menu.js"),import("@lrnwebcomponents/hax-body/lib/hax-context-item.js"),import("@lrnwebcomponents/hax-body/lib/hax-context-item-textop.js"),import("@lrnwebcomponents/hax-body/lib/hax-toolbar.js"),e.addEventListener("hax-context-item-selected",e._haxContextOperation.bind(y(e))),e.selectedValue="p",e.selection=!1,e.isSafari=e._isSafari(),e.polyfillSafe=window.HaxStore.instance.computePolyfillSafe(),e.dispatchEvent(new CustomEvent("is-safari-changed",{bubbles:!0,cancelable:!0,composed:!0,detail:e.isSafari})),e}return x(t,l.LitElement),m(t,null,[{key:"styles",get:function(){return[l.css(_())]}}]),m(t,[{key:"render",value:function(){return l.html(C(),this.selection,this.selectedValue,this.selectedValueChanged,!this._showIndent,!this._showIndent,!this._showIndent,!this._showIndent,this.isSafari,!this.isSafari)}},{key:"selectedValueChanged",value:function(e){this.selectedValue=e.detail}},{key:"updated",value:function(e){var t=this;e.forEach(function(e,n){"selectedValue"!=n&&"polyfillSafe"!=n||(t._showIndent=t._computeShowIndent(t.selectedValue,t.polyfillSafe)),"selectedValue"==n&&t.dispatchEvent(new CustomEvent("selected-value-changed",{detail:t[n]}))})}},{key:"_computeShowIndent",value:function(e,t){return!(!t||"ol"!==e&&"ul"!==e)}},{key:"_haxContextOperation",value:function(e){var t=this,n=e.detail,o=window.HaxStore.getSelection();switch(n.eventName){case"close-menu":setTimeout(function(){t.shadowRoot.querySelector("#formatsize").shadowRoot.querySelector("#menu").hideMenu()},200);break;case"insert-inline-gizmo":if(window.HaxStore._tmpSelection&&window.HaxStore.instance.editMode){var i=!1;try{"HAX-BODY"!==window.HaxStore._tmpRange.startContainer.parentNode.parentNode.tagName&&"HAX-BODY"!==window.HaxStore._tmpRange.startContainer.parentNode.parentNode.parentNode.tagName||(window.HaxStore.write("activePlaceHolder",window.HaxStore._tmpRange,this),i=window.HaxStore._tmpRange)}catch(e){}}if(i||null!=window.HaxStore.instance.activePlaceHolder){var a={text:window.HaxStore.instance.activePlaceHolder.toString()},r=window.HaxStore.guessGizmo("inline",a);r.length>0&&window.HaxStore.instance.haxAppPicker.presentOptions(r,"inline","Transform selected text to..","gizmo")}break;case"text-bold":document.execCommand("bold"),e.preventDefault(),e.stopPropagation();break;case"text-italic":document.execCommand("italic"),e.preventDefault(),e.stopPropagation();break;case"text-underline":document.execCommand("underline"),e.preventDefault(),e.stopPropagation(),this.shadowRoot.querySelector("#toolbar").shadowRoot.querySelector("#moremenu").shadowRoot.querySelector("#menu").hideMenu();break;case"text-subscript":document.execCommand("subscript"),e.preventDefault(),e.stopPropagation(),this.shadowRoot.querySelector("#toolbar").shadowRoot.querySelector("#moremenu").shadowRoot.querySelector("#menu").hideMenu();break;case"text-superscript":document.execCommand("superscript"),e.preventDefault(),e.stopPropagation(),this.shadowRoot.querySelector("#toolbar").shadowRoot.querySelector("#moremenu").shadowRoot.querySelector("#menu").hideMenu();break;case"text-remove-format":document.execCommand("removeFormat"),e.preventDefault(),e.stopPropagation();break;case"text-strikethrough":document.execCommand("strikeThrough"),e.preventDefault(),e.stopPropagation(),this.shadowRoot.querySelector("#toolbar").shadowRoot.querySelector("#moremenu").shadowRoot.querySelector("#menu").hideMenu();break;case"text-link":var s="";"undefined"!==p(o.focusNode.parentNode.href)&&(s=o.focusNode.parentNode.href);var l=prompt("Enter a URL:",s);l&&(document.execCommand("createLink",!1,l),o.focusNode.parentNode&&(o.focusNode.parentNode.setAttribute("contenteditable",!0),o.focusNode.parentNode.setAttribute("data-editable",!0),o.focusNode.parentNode.removeEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation()}),o.focusNode.parentNode.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation()})),e.preventDefault(),e.stopPropagation());break;case"text-unlink":document.execCommand("unlink"),e.preventDefault(),e.stopPropagation();break;case"text-indent":document.execCommand("indent"),e.preventDefault(),e.stopPropagation();break;case"text-outdent":document.execCommand("outdent"),e.preventDefault(),e.stopPropagation();break;case"text-list-numbered":try{document.execCommand("insertOrderedList"),e.preventDefault(),e.stopPropagation()}catch(e){}break;case"text-list-bulleted":try{document.execCommand("insertUnorderedList"),e.preventDefault(),e.stopPropagation()}catch(e){}}}},{key:"_isSafari",value:function(){var e=navigator.userAgent.toLowerCase();return!(-1==e.indexOf("safari")||e.indexOf("chrome")>-1)}}],[{key:"tag",get:function(){return"hax-text-context"}},{key:"properties",get:function(){return{_showIndent:{type:Boolean},polyfillSafe:{type:Boolean,attribute:"polyfill-safe"},selectedValue:{type:String,attribute:"selected-value"},selection:{type:Boolean},isSafari:{type:Boolean,attribute:"is-safari"}}}}]),t}();function H(){var e=N(['\n      <hax-toolbar\n        id="toolbar"\n        size="','"\n        @size-changed="','"\n      >\n        <slot slot="primary"></slot>\n        <hax-context-item\n          slot="primary"\n          icon="icons:settings"\n          label="Settings"\n          event-name="hax-manager-configure"\n          .hidden="','"\n        ></hax-context-item>\n        <hax-context-item\n          slot="primary"\n          icon="icons:view-quilt"\n          label="','"\n          event-name="hax-manager-configure-container"\n          .hidden="','"\n        ></hax-context-item>\n      </hax-toolbar>\n    ']);return H=function(){return e},e}function L(){var e=N(["\n        :host *[hidden] {\n          display: none;\n        }\n        :host {\n          display: block;\n          height: 36px;\n        }\n        hax-context-item {\n          margin: 0;\n          height: 36px;\n        }\n        :host(.hax-context-pin-top) hax-toolbar {\n          position: fixed;\n          top: 64px;\n          opacity: 0.9;\n        }\n        :host(.hax-context-pin-bottom) hax-toolbar {\n          position: fixed;\n          bottom: 0;\n          opacity: 0.9;\n        }\n        :host(.hax-context-pin-top) hax-toolbar:hover,\n        :host(.hax-context-pin-bottom) hax-toolbar:hover {\n          opacity: 1;\n        }\n      "]);return L=function(){return e},e}window.customElements.define(k.tag,k);var T=function(e){function t(){var e;return u(this,t),(e=w(this,v(t).call(this))).ceSize=100,e.haxProperties={},import("@lrnwebcomponents/hax-body/lib/hax-context-item.js"),import("@lrnwebcomponents/hax-body/lib/hax-toolbar.js"),e}return x(t,l.LitElement),m(t,null,[{key:"styles",get:function(){return[l.css(L())]}}]),m(t,[{key:"render",value:function(){return l.html(H(),this.ceSize,this.ceSizeChanged,!this.__hasSettingsForm,this.__parentName,!this.__hasParentSettingsForm)}},{key:"updated",value:function(e){var t=this;e.forEach(function(e,n){"haxProperties"==n&&(t.shadowRoot.querySelector("#toolbar").haxProperties=t[n],t._haxPropertiesChanged(t[n],e)),"ceSize"==n&&t._ceSizeChanged(t[n],e)})}},{key:"ceSizeChanged",value:function(e){this.ceSize=e.detail}},{key:"setHaxProperties",value:function(e){this.haxProperties=e}},{key:"_ceSizeChanged",value:function(e,t){"undefined"!==p(e)&&"undefined"!==p(t)&&this.dispatchEvent(new CustomEvent("hax-context-item-selected",{bubbles:!0,cancelable:!0,composed:!0,detail:{eventName:"hax-size-change",value:e}}))}},{key:"_haxPropertiesChanged",value:function(e,t){if("undefined"!==p(t)&&"undefined"!==p(e.settings)){for(;null!==this.firstChild;)this.removeChild(this.firstChild);var n,o=e.settings.quick,i=e.settings.configure,a=e.settings.advanced;if((i.length||a.length)&&"HR"!==e.element.tagName?this.__hasSettingsForm=!0:this.__hasSettingsForm=!1,this.__hasParentSettingsForm=!1,window.HaxStore.instance.activeContainerNode!==window.HaxStore.instance.activeNode&&null!==window.HaxStore.instance.activeContainerNode)switch(this.__hasParentSettingsForm=!0,window.HaxStore.instance.activeContainerNode.tagName){case"P":case"UL":case"OL":case"DIV":this.__parentName="Text block settings";break;case"GRID-PLATE":this.__parentName="Layout settings";break;default:this.__parentName=window.HaxStore.instance.activeContainerNode.tagName.replace("-"," ").toLowerCase()}for(var r=0;r<o.length;r++){var s=o[r];(n=document.createElement("hax-context-item")).eventName="hax-edit-property",n.label=s.title,n.options=s.options,n.icon=s.icon,n.inputMethod=s.inputMethod,n.required=s.required,n.options=s.options,n.validation=s.validation,n.validationType=s.validationType,n.description=s.description,"undefined"!==p(s.property)?n.propertyToBind=s.property:"undefined"!==p(s.attribute)?n.propertyToBind=s.attribute:n.slotToBind=s.slot,this.appendChild(n)}}}}],[{key:"tag",get:function(){return"hax-ce-context"}},{key:"properties",get:function(){return{ceSize:{type:Number,attribute:"ce-size"},haxProperties:{type:Object,attribute:"hax-properties"}}}}]),t}();window.customElements.define(T.tag,T);var E=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return u(this,t),e=w(this,v(t).call(this)),import("@lrnwebcomponents/hax-body/lib/hax-context-item-menu.js"),import("@lrnwebcomponents/hax-body/lib/hax-context-item.js"),e.tag=t.tag,e.template=document.createElement("template"),e.attachShadow({mode:"open"}),n||e.render(),e}return x(t,g(HTMLElement)),m(t,[{key:"render",value:function(){this.shadowRoot.innerHTML=null,this.template.innerHTML=this.html,window.ShadyCSS&&window.ShadyCSS.prepareTemplate(this.template,this.tag),this.shadowRoot.appendChild(this.template.content.cloneNode(!0))}},{key:"html",get:function(){return'\n    <style>\n    :host {\n      display: block;\n      width: 32px;\n    }\n    hax-context-item {\n      display: block;\n      margin: 6px 0;\n      width: 28px;\n      height: 24px;\n    }\n    .area {\n      width: 32px;\n      float: left;\n      visibility: visible;\n      transition: 0.3s all ease;\n    }\n    </style>\n    <div class="area">\n      <hax-context-item\n        mini\n        light\n        icon="hardware:keyboard-arrow-up"\n        label="Move up"\n        event-name="grid-plate-up"\n        direction="left"\n      ></hax-context-item>\n      <hax-context-item\n        mini\n        light\n        icon="hardware:keyboard-arrow-down"\n        label="Move down"\n        event-name="grid-plate-down"\n        direction="left"\n      ></hax-context-item>\n    </div>'}}],[{key:"tag",get:function(){return"hax-plate-context"}}]),t}();function M(){var e=N(['\n      <style>\n        :host {\n          display: block;\n          margin: 0;\n          border: none;\n          padding: 0;\n          border: 1px solid var(--hax-color-border-outline);\n        }\n        .wrapper {\n          background-color: #ffffff;\n          color: #222222;\n          display: flex;\n          align-items: center;\n          justify-content: space-between;\n        }\n        hax-context-item {\n          margin: 0;\n        }\n        #elementoptions {\n          height: inherit;\n        }\n        #input {\n          color: var(--hax-color-text);\n        }\n        paper-checkbox {\n          --paper-checkbox-label-color: var(--hax-color-text);\n        }\n        paper-textarea,\n        paper-input {\n          height: 40px;\n          font-size: 14px;\n          margin-bottom: 6px;\n          --paper-input-container: {\n            padding: 0;\n            font-size: 14px;\n          }\n          --paper-input-container-label-floating: {\n            color: var(--hax-color-text);\n            font-size: 12px;\n          }\n          --paper-input-container-underline: {\n            margin: 0;\n          }\n          --paper-input-container-color: var(--hax-color-text);\n          --paper-input-container-focus-color: var(--hax-color-text);\n          --paper-input-container-invalid-color: var(--hax-color-text);\n          --paper-input-container-input-color: var(--hax-color-text);\n          --paper-input-container-shared-input-style: {\n            color: var(--hax-color-text);\n            background: transparent;\n            margin: 0;\n            padding: 0;\n            line-height: 14px;\n            font-size: 14px;\n            outline: none;\n            border: none;\n          }\n        }\n        .input-method {\n          color: var(--hax-color-text);\n          padding: 0 8px;\n          width: 80%;\n        }\n        #updatebutton {\n          outline: 1px solid black;\n        }\n        #updatebutton:hover {\n          border: none;\n        }\n      </style>\n      <div class="wrapper">\n        <template is="dom-if" if="[[__inputselect]]">\n          <span class="input-mixer-label">[[label]]</span>\n          <hax-context-item-menu\n            selected-value="{{__selectedValue}}"\n            icon="[[icon]]"\n            id="input"\n          >\n            <slot></slot>\n          </hax-context-item-menu>\n        </template>\n        <span class="input-method">\n          <template is="dom-if" if="[[__inputtextarea]]">\n            <paper-textarea\n              id="input"\n              label="[[label]]"\n              value="{{value}}"\n              auto-validate=""\n              pattern="[[validation]]"\n              required="[[required]]"\n            ></paper-textarea>\n          </template>\n          <template is="dom-if" if="[[__inputtextfield]]">\n            <paper-input\n              id="input"\n              type="[[validationType]]"\n              label="[[label]]"\n              value="{{value}}"\n              auto-validate=""\n              pattern="[[validation]]"\n              required="[[required]]"\n            ></paper-input>\n          </template>\n          <template is="dom-if" if="[[__inputboolean]]">\n            <paper-checkbox id="input" checked="{{value}}"\n              >[[label]]</paper-checkbox\n            >\n          </template>\n          <template is="dom-if" if="[[__inputflipboolean]]">\n            <paper-checkbox id="input" checked="{{value}}"\n              >[[label]]</paper-checkbox\n            >\n          </template>\n          <template is="dom-if" if="[[__inputcolorpicker]]">\n            <span>[[label]]</span>\n            <simple-colors-picker\n              id="input"\n              value="{{value}}"\n            ></simple-colors-picker>\n          </template>\n        </span>\n        <paper-tooltip for="input" position="top" offset="14">\n          [[description]]\n        </paper-tooltip>\n        <hax-context-item\n          id="updatebutton"\n          icon="subdirectory-arrow-right"\n          label$="Update [[label]]"\n          event-name="hax-update-tap"\n        ></hax-context-item>\n      </div>\n    '],['\n      <style>\n        :host {\n          display: block;\n          margin: 0;\n          border: none;\n          padding: 0;\n          border: 1px solid var(--hax-color-border-outline);\n        }\n        .wrapper {\n          background-color: #ffffff;\n          color: #222222;\n          display: flex;\n          align-items: center;\n          justify-content: space-between;\n        }\n        hax-context-item {\n          margin: 0;\n        }\n        #elementoptions {\n          height: inherit;\n        }\n        #input {\n          color: var(--hax-color-text);\n        }\n        paper-checkbox {\n          --paper-checkbox-label-color: var(--hax-color-text);\n        }\n        paper-textarea,\n        paper-input {\n          height: 40px;\n          font-size: 14px;\n          margin-bottom: 6px;\n          --paper-input-container: {\n            padding: 0;\n            font-size: 14px;\n          }\n          --paper-input-container-label-floating: {\n            color: var(--hax-color-text);\n            font-size: 12px;\n          }\n          --paper-input-container-underline: {\n            margin: 0;\n          }\n          --paper-input-container-color: var(--hax-color-text);\n          --paper-input-container-focus-color: var(--hax-color-text);\n          --paper-input-container-invalid-color: var(--hax-color-text);\n          --paper-input-container-input-color: var(--hax-color-text);\n          --paper-input-container-shared-input-style: {\n            color: var(--hax-color-text);\n            background: transparent;\n            margin: 0;\n            padding: 0;\n            line-height: 14px;\n            font-size: 14px;\n            outline: none;\n            border: none;\n          }\n        }\n        .input-method {\n          color: var(--hax-color-text);\n          padding: 0 8px;\n          width: 80%;\n        }\n        #updatebutton {\n          outline: 1px solid black;\n        }\n        #updatebutton:hover {\n          border: none;\n        }\n      </style>\n      <div class="wrapper">\n        <template is="dom-if" if="[[__inputselect]]">\n          <span class="input-mixer-label">[[label]]</span>\n          <hax-context-item-menu\n            selected-value="{{__selectedValue}}"\n            icon="[[icon]]"\n            id="input"\n          >\n            <slot></slot>\n          </hax-context-item-menu>\n        </template>\n        <span class="input-method">\n          <template is="dom-if" if="[[__inputtextarea]]">\n            <paper-textarea\n              id="input"\n              label="[[label]]"\n              value="{{value}}"\n              auto-validate=""\n              pattern="[[validation]]"\n              required="[[required]]"\n            ></paper-textarea>\n          </template>\n          <template is="dom-if" if="[[__inputtextfield]]">\n            <paper-input\n              id="input"\n              type="[[validationType]]"\n              label="[[label]]"\n              value="{{value}}"\n              auto-validate=""\n              pattern="[[validation]]"\n              required="[[required]]"\n            ></paper-input>\n          </template>\n          <template is="dom-if" if="[[__inputboolean]]">\n            <paper-checkbox id="input" checked="{{value}}"\n              >[[label]]</paper-checkbox\n            >\n          </template>\n          <template is="dom-if" if="[[__inputflipboolean]]">\n            <paper-checkbox id="input" checked="{{value}}"\n              >[[label]]</paper-checkbox\n            >\n          </template>\n          <template is="dom-if" if="[[__inputcolorpicker]]">\n            <span>[[label]]</span>\n            <simple-colors-picker\n              id="input"\n              value="{{value}}"\n            ></simple-colors-picker>\n          </template>\n        </span>\n        <paper-tooltip for="input" position="top" offset="14">\n          [[description]]\n        </paper-tooltip>\n        <hax-context-item\n          id="updatebutton"\n          icon="subdirectory-arrow-right"\n          label\\$="Update [[label]]"\n          event-name="hax-update-tap"\n        ></hax-context-item>\n      </div>\n    ']);return M=function(){return e},e}window.customElements.define(E.tag,E);var A=function(e){function n(){var e;return u(this,n),e=w(this,v(n).call(this)),import("@lrnwebcomponents/simple-colors/lib/simple-colors-picker.js"),import("@polymer/paper-input/paper-textarea.js"),import("@polymer/paper-input/paper-input.js"),import("@polymer/paper-checkbox/paper-checkbox.js"),import("@polymer/paper-slider/paper-slider.js"),import("@polymer/paper-tooltip/paper-tooltip.js"),import("@lrnwebcomponents/hax-body/lib/hax-context-item-menu.js"),import("@lrnwebcomponents/hax-body/lib/hax-context-item.js"),e}return x(n,t.PolymerElement),m(n,[{key:"ready",value:function(){S(v(n.prototype),"ready",this).call(this),this._resetInputMethods(),d.afterNextRender(this,function(){this.addEventListener("hax-context-item-selected",this._haxContextOperation.bind(this))})}},{key:"_inputMethodChanged",value:function(e,t){var n=this;if(null!=e&&"undefined"!==p(t)){var o=e;if(this.validInputMethods().includes(o)){for(this._resetInputMethods(),this["__input"+o]=!0;null!==this.firstChild;)this.removeChild(this.firstChild);var i;if("select"===o&&"undefined"!==p(this.options))for(var a in this.options)(i=document.createElement("paper-item")).attributes.value=a,i.innerHTML=this.options[a],this.appendChild(i.cloneNode(!0));setTimeout(function(){"function"==typeof n.shadowRoot.querySelector("#input").hideMenu&&n.shadowRoot.querySelector("#input").hideMenu(),n.shadowRoot.querySelector("#input").focus()},200)}}}},{key:"validInputMethods",value:function(){return["flipboolean","boolean","select","textfield","textarea","datepicker","haxupload","colorpicker","iconpicker","alt","number","code-editor","array"]}},{key:"_resetInputMethods",value:function(){for(var e=this.validInputMethods(),t=0;t<e.length;t++)this["__input"+e[t]]=!1}},{key:"_haxContextOperation",value:function(e){switch(e.detail.eventName){case"hax-update-tap":if("boolean"==this.inputMethod)this.value=this.value;else if("flipboolean"==this.inputMethod)this.value=!this.value;else if("select"==this.inputMethod){var t=0;for(var n in this.options)t==this.__selectedValue&&(this.value=n),t++}var o={value:this.value,propertyToBind:this.propertyToBind,slotToBind:this.slotToBind};this.dispatchEvent(new CustomEvent("hax-input-mixer-update",{bubbles:!0,cancelable:!0,composed:!0,detail:{inputMixer:o}}))}}}],[{key:"template",get:function(){return t.html(M())}},{key:"tag",get:function(){return"hax-input-mixer"}},{key:"properties",get:function(){return{value:{type:String,value:null},label:{type:String,reflectToAttribute:!0},validation:{type:String,reflectToAttribute:!0},validationType:{type:String,reflectToAttribute:!0},required:{type:Boolean,reflectToAttribute:!0},options:{type:Object,value:{},reflectToAttribute:!0},icon:{type:String,value:"android",reflectToAttribute:!0},description:{type:String,reflectToAttribute:!0},inputMethod:{type:String,value:null,reflectToAttribute:!0,observer:"_inputMethodChanged"},propertyToBind:{type:String,reflectToAttribute:!0},slotToBind:{type:String,reflectToAttribute:!0}}}}]),n}();window.customElements.define(A.tag,A);var R=document.createElement("dom-module");function P(){var e=N(['\n      <style include="simple-colors-shared-styles-polymer hax-shared-styles">\n        :host {\n          display: block;\n          min-height: 32px;\n          min-width: 32px;\n          outline: none;\n        }\n        .hax-context-menu {\n          padding: 0;\n          margin-left: -5000px;\n          position: absolute;\n          visibility: hidden;\n          opacity: 0;\n          z-index: 1000;\n          float: left;\n          display: block;\n          pointer-events: none;\n          transition: 0.8s opacity ease-in-out, 0.8s visibility ease-in-out;\n        }\n        #haxinputmixer {\n          z-index: 10000000;\n        }\n        .hax-context-visible.hax-active-hover {\n          visibility: visible;\n          opacity: 1;\n          pointer-events: all;\n          margin-left: unset;\n        }\n        :host #bodycontainer ::slotted(h1) {\n          font-size: var(--hax-base-styles-h1-font-size, 2.5em);\n          line-height: var(--hax-base-styles-h1-line-height, 2.5em);\n        }\n        :host #bodycontainer ::slotted(h2) {\n          font-size: var(--hax-base-styles-h2-font-size, 2em);\n        }\n        :host #bodycontainer ::slotted(h3) {\n          font-size: var(--hax-base-styles-h3-font-size, 1.75em);\n        }\n        :host #bodycontainer ::slotted(h4) {\n          font-size: var(--hax-base-styles-h4-font-size, 1.5em);\n        }\n        :host #bodycontainer ::slotted(h5) {\n          font-size: var(--hax-base-styles-h5-font-size, 1.25em);\n        }\n        :host #bodycontainer ::slotted(h6) {\n          font-size: var(--hax-base-styles-h6-font-size, 1.25em);\n        }\n        :host #bodycontainer ::slotted(p) {\n          min-height: var(--hax-base-styles-p-min-height, 43px);\n          font-size: var(--hax-base-styles-p-font-size, 24px);\n          line-height: var(--hax-base-styles-p-line-height, 1.8);\n          letter-spacing: var(--hax-base-styles-p-letter-spacing, 0.5px);\n        }\n        :host #bodycontainer ::slotted(a) {\n          color: var(--hax-base-styles-a-color, #000);\n          font-size: var(--hax-base-styles-a-font-size, 24px);\n          font-weight: var(--hax-base-styles-a-font-weight, normal);\n        }\n        :host #bodycontainer ::slotted(a:visited) {\n          color: var(--hax-base-styles-a-color-visited, #2196f3);\n        }\n        :host #bodycontainer ::slotted(a:active),\n        :host #bodycontainer ::slotted(a:focus),\n        :host #bodycontainer ::slotted(a:hover) {\n          color: var(--hax-base-styles-a-color-active, #2196f3);\n          font-weight: var(--hax-base-styles-a-font-weight-active, normal);\n        }\n        :host #bodycontainer ::slotted(ol),\n        :host #bodycontainer ::slotted(ul),\n        :host #bodycontainer ::slotted(li) {\n          padding-bottom: var(--hax-base-styles-list-padding-bottom, 1.5em);\n          line-height: var(--hax-base-styles-list-line-height, 40px);\n          font-size: var(--hax-base-styles-list-font-size, 24px);\n          max-width: var(--hax-base-styles-list-max-width, 28em);\n        }\n        :host #bodycontainer ::slotted(ol > li:last-child),\n        :host #bodycontainer ::slotted(ul > li:last-child) {\n          padding-bottom: var(\n            --hax-base-styles-list-last-child-padding-bottom,\n            1em\n          );\n        }\n        :host #bodycontainer ::slotted(ul),\n        :host #bodycontainer ::slotted(ol) {\n          padding-left: var(--hax-base-styles-list-padding-left, 20px);\n          padding-left: var(--hax-base-styles-list-margin-left, 20px);\n        }\n\n        :host([edit-mode]) #bodycontainer ::slotted(*[data-editable]) {\n          outline: none;\n          outline-offset: 2px;\n          transition: 0.2s width ease-in-out, 0.2s height ease-in-out,\n            0.2s margin ease-in-out;\n          caret-color: var(--hax-color-text);\n        }\n        :host([edit-mode]) #bodycontainer ::slotted(*[data-editable]:hover) {\n          outline: 1px solid rgba(145, 151, 162, 0.25);\n          caret-color: #000000;\n        }\n        :host([edit-mode])\n          #bodycontainer\n          ::slotted(*.hax-active[data-editable]:hover) {\n          cursor: text !important;\n          outline: 1px solid rgba(145, 151, 162, 0.25);\n        }\n        :host([edit-mode])\n          #bodycontainer\n          ::slotted(*[data-editable] .hax-active:hover) {\n          cursor: text !important;\n          outline: 1px solid rgba(145, 151, 162, 0.25);\n        }\n        :host([edit-mode])\n          #bodycontainer\n          ::slotted(code.hax-active[data-editable]) {\n          display: block;\n        }\n        :host([edit-mode]) #bodycontainer ::slotted(hr[data-editable]) {\n          height: 2px;\n          background-color: #eeeeee;\n          padding-top: 4px;\n          padding-bottom: 4px;\n        }\n        /** Fix to support safari as it defaults to none */\n        :host([edit-mode]) #bodycontainer ::slotted(*[data-editable]) {\n          -webkit-user-select: text;\n          cursor: pointer;\n        }\n\n        :host([edit-mode])\n          #bodycontainer\n          ::slotted(*[data-editable]::-moz-selection),\n        :host([edit-mode])\n          #bodycontainer\n          ::slotted(*[data-editable] *::-moz-selection) {\n          background-color: var(--hax-body-highlight, --paper-yellow-300);\n          color: black;\n        }\n        :host([edit-mode])\n          #bodycontainer\n          ::slotted(*[data-editable]::selection),\n        :host([edit-mode])\n          #bodycontainer\n          ::slotted(*[data-editable] *::selection) {\n          background-color: var(--hax-body-highlight, --paper-yellow-300);\n          color: black;\n        }\n        #bodycontainer {\n          -webkit-user-select: text;\n          user-select: text;\n        }\n        :host([edit-mode][hax-ray-mode])\n          #bodycontainer\n          ::slotted(*[data-editable]):before {\n          content: attr(data-hax-ray) " " attr(resource) " " attr(typeof) " "\n            attr(property) " " attr(content);\n          font-size: 10px;\n          font-style: italic;\n          left: unset;\n          right: unset;\n          top: unset;\n          background-color: #d3d3d3;\n          color: #000000;\n          bottom: unset;\n          width: auto;\n          padding: 8px;\n          margin: 0;\n          z-index: 1;\n          margin: -16px 0 0 0;\n          float: right;\n          line-height: 2;\n        }\n      </style>\n      <div id="bodycontainer" class="ignore-activation">\n        <slot id="body"></slot>\n      </div>\n      <hax-text-context\n        id="textcontextmenu"\n        class="hax-context-menu ignore-activation"\n      ></hax-text-context>\n      <hax-ce-context\n        id="cecontextmenu"\n        class="hax-context-menu ignore-activation"\n      ></hax-ce-context>\n      <hax-plate-context\n        id="platecontextmenu"\n        class="hax-context-menu ignore-activation"\n      ></hax-plate-context>\n      <hax-input-mixer\n        id="haxinputmixer"\n        class="hax-context-menu ignore-activation"\n      ></hax-input-mixer>\n    ']);return P=function(){return e},e}R.innerHTML="<template>\n  <style>\n  :host, :host * ::slotted(*) {\n    line-height: 1.8;\n  }\n  :host ul, :host * ::slotted(ul),\n  :host ol, :host * ::slotted(ol) {\n    padding-left: 20px;\n    margin-left: 20px;\n  }\n  :host ul, :host * ::slotted(ul) {\n    list-style-type: disc;\n  }\n  :host li, :host * ::slotted(li) {\n    margin-bottom: 6px;\n  }\n</style>\n</template>",R.register("hax-shared-styles");var q=function(e){function s(){var e;return u(this,s),e=w(this,v(s).call(this)),import("@polymer/iron-a11y-keys/iron-a11y-keys.js"),import("@polymer/paper-item/paper-item.js"),import("@lrnwebcomponents/grid-plate/grid-plate.js"),e}return x(s,t.PolymerElement),m(s,[{key:"ready",value:function(){var e=this;S(v(s.prototype),"ready",this).call(this),this.dispatchEvent(new CustomEvent("hax-register-body",{bubbles:!0,cancelable:!0,composed:!0,detail:this})),this.polyfillSafe=window.HaxStore.instance.computePolyfillSafe(),this._observer=new o.FlattenedNodesObserver(this,function(t){i.flush(),t.addedNodes.length>0&&t.addedNodes.map(function(t){if(e._haxElementTest(t)){e._HTMLPrimativeTest(t)&&(t.contentEditable=e.editMode),t.setAttribute("data-editable",e.editMode);var n=t.tagName.replace("-"," ").toLowerCase(),o=window.HaxStore.instance.gizmoList.findIndex(function(e){return e.tag===t.tagName.toLowerCase()});-1!==o&&(n=window.HaxStore.instance.gizmoList[o].title),t.setAttribute("data-hax-ray",n),e.dispatchEvent(new CustomEvent("hax-body-tag-added",{bubbles:!0,cancelable:!0,composed:!0,detail:{node:t}}))}}),t.removedNodes.length>0&&t.removedNodes.map(function(t){e._haxElementTest(t)&&!t.classList.contains("hax-active")&&e.dispatchEvent(new CustomEvent("hax-body-tag-removed",{bubbles:!0,cancelable:!0,composed:!0,detail:{node:t}}))})}),this.addEventListener("hax-context-item-selected",this._haxContextOperation.bind(this)),this.addEventListener("hax-input-mixer-update",this._haxInputMixerOperation.bind(this)),this.addEventListener("place-holder-replace",this.replacePlaceholder.bind(this));try{document.execCommand("enableObjectResizing",!1,!1),document.execCommand("defaultParagraphSeparator",!1,"p")}catch(e){console.warn(e)}window.addEventListener("keydown",this._onKeyDown.bind(this)),window.addEventListener("keypress",this._onKeyPress.bind(this)),this.shadowRoot.querySelector("slot").addEventListener("mousemove",this.hoverEvent.bind(this)),this.shadowRoot.querySelector("slot").addEventListener("mouseup",function(e){var t=window.HaxStore.getSelection();window.HaxStore._tmpSelection=t;try{var n=window.HaxStore.getRange();n.cloneRange&&(window.HaxStore._tmpRange=n.cloneRange())}catch(e){console.warn(e)}}),document.body.addEventListener("hax-store-property-updated",this._haxStorePropertyUpdated.bind(this)),window.addEventListener("scroll",this._keepContextVisible.bind(this)),this.addEventListener("focusin",this._focusIn.bind(this)),this.addEventListener("mousedown",this._focusIn.bind(this))}},{key:"connectedCallback",value:function(){S(v(s.prototype),"connectedCallback",this).call(this),this.editMode=window.HaxStore.instance.editMode,this.__tabTrap=!1}},{key:"disconnectedCallback",value:function(){this._observer&&(this._observer.disconnect(),this._observer=null),S(v(s.prototype),"disconnectedCallback",this).call(this)}},{key:"_keepContextVisible",value:function(e){var t=!1;this.shadowRoot.querySelector("#textcontextmenu").classList.contains("hax-context-visible")?t=this.shadowRoot.querySelector("#textcontextmenu"):this.shadowRoot.querySelector("#cecontextmenu").classList.contains("hax-context-visible")&&(t=this.shadowRoot.querySelector("#cecontextmenu")),t&&(this.elementInViewport(t)?t.classList.remove("hax-context-pin-bottom","hax-context-pin-top"):this.__OffBottom?t.classList.add("hax-context-pin-top"):t.classList.add("hax-context-pin-bottom"))}},{key:"_onKeyDown",value:function(e){var t=this;if(this.editMode&&this.getAttribute("contenteditable")){var n=window.HaxStore.getRange();switch(e.key){case"Tab":window.HaxStore.instance.isTextElement(this.activeContainerNode)&&(e.detail.keyboardEvent&&(e.detail.keyboardEvent.preventDefault(),e.detail.keyboardEvent.stopPropagation(),e.detail.keyboardEvent.stopImmediatePropagation()),e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),e.shiftKey?this._tabBackKeyPressed():this._tabKeyPressed());break;case"Enter":this.setAttribute("contenteditable",!0),setTimeout(function(){n.commonAncestorContainer&&"function"==typeof n.commonAncestorContainer.focus&&(n.commonAncestorContainer.focus(),t.__focusLogic(n.commonAncestorContainer))},900);break;case"ArrowUp":case"ArrowDown":case"ArrowLeft":case"ArrowRight":n.commonAncestorContainer&&this.activeNode!==n.commonAncestorContainer&&"function"==typeof n.commonAncestorContainer.focus?"HAX-BODY"!==n.commonAncestorContainer.tagName&&(window.HaxStore.instance.isTextElement(n.commonAncestorContainer)?this.setAttribute("contenteditable",!0):this.removeAttribute("contenteditable"),setTimeout(function(){n.commonAncestorContainer.focus(),t.__focusLogic(n.commonAncestorContainer)},900)):n.commonAncestorContainer&&n.commonAncestorContainer.parentNode&&this.activeNode!==n.commonAncestorContainer.parentNode&&"function"==typeof n.commonAncestorContainer.parentNode.focus&&"HAX-BODY"!==n.commonAncestorContainer.parentNode.tagName&&(window.HaxStore.instance.isTextElement(n.commonAncestorContainer.parentNode)?this.setAttribute("contenteditable",!0):this.removeAttribute("contenteditable"),setTimeout(function(){n.commonAncestorContainer.parentNode.focus(),t.__focusLogic(n.commonAncestorContainer.parentNode)},900))}this.shadowRoot.querySelector("#platecontextmenu").classList.contains("hax-active-hover")&&this.__dropActiveHover()}}},{key:"_onKeyPress",value:function(e){this.editMode&&this.shadowRoot.querySelector("#platecontextmenu").classList.contains("hax-active-hover")&&this.__dropActiveHover()}},{key:"hoverEvent",value:function(e){if(this.editMode&&(e.target&&null!=e.target.getAttribute("data-hax-ray")?(this.__activeHover=e.target,this.dispatchEvent(new CustomEvent("hax-active-hover-name",{bubbles:!0,cancelable:!0,composed:!0,detail:e.target.getAttribute("data-hax-ray")}))):e.target&&e.target.parentNode&&null!=e.target.parentNode.getAttribute("data-hax-ray")&&(this.__activeHover=e.target.parentNode,this.dispatchEvent(new CustomEvent("hax-active-hover-name",{bubbles:!0,cancelable:!0,composed:!0,detail:e.target.parentNode.getAttribute("data-hax-ray")}))),!this.shadowRoot.querySelector("#platecontextmenu").classList.contains("hax-active-hover"))){var t=e.target;e.target===this.shadowRoot.querySelector("#cecontextmenu")||e.target===this.shadowRoot.querySelector("#textcontextmenu")||e.target===this.shadowRoot.querySelector("#platecontextmenu")||t===this.activeNode||t===this.activeContainerNode||e.target===this.activeNode||e.target===this.activeContainerNode||t.parentNode===this.activeContainerNode||t.parentNode.parentNode===this.activeContainerNode||t.parentNode.parentNode.parentNode===this.activeContainerNode?(this.__addActiveHover(),this.__typeLock=!1):this.__dropActiveHover()}}},{key:"__addActiveHover",value:function(){this.shadowRoot.querySelector("#cecontextmenu").classList.add("hax-active-hover"),this.shadowRoot.querySelector("#textcontextmenu").classList.add("hax-active-hover"),this.shadowRoot.querySelector("#platecontextmenu").classList.add("hax-active-hover")}},{key:"__dropActiveHover",value:function(){this.shadowRoot.querySelector("#cecontextmenu").classList.remove("hax-active-hover"),this.shadowRoot.querySelector("#textcontextmenu").classList.remove("hax-active-hover"),this.shadowRoot.querySelector("#platecontextmenu").classList.remove("hax-active-hover")}},{key:"elementInViewport",value:function(e){for(var t=e.offsetTop-32-window.HaxStore.instance.haxPanel.shadowRoot.querySelector("#drawer").offsetHeight,n=e.offsetLeft,o=e.offsetWidth,i=e.offsetHeight;e.offsetParent;)t+=(e=e.offsetParent).offsetTop,n+=e.offsetLeft;return this.__OffBottom=t<window.pageYOffset+window.innerHeight,t<window.pageYOffset+window.innerHeight&&n<window.pageXOffset+window.innerWidth&&t+i>window.pageYOffset&&n+o>window.pageXOffset}},{key:"replacePlaceholder",value:function(e){var t=this;if("text"===e.detail){var n=document.createElement("p");n.innerHTML="<br/>",this.haxReplaceNode(this.activeNode,n,this.activeNode.parentNode),setTimeout(function(){t.activeNode=n,window.HaxStore.write("activeNode",n,t),t.activeContainerNode.setAttribute("contenteditable",!0),n.focus(),t.__focusLogic(n)},210)}else this.replaceElementWorkflow()}},{key:"replaceElementWorkflow",value:function(){var e=window.HaxStore.nodeToHaxElement(this.activeNode,null),t="*",n=!1;"place-holder"===e.tag&&"undefined"!==p(e.properties.type)&&(t=e.properties.type,n=!0);var o={};if("undefined"!==p(window.HaxStore.instance.elementList[e.tag])&&!1!==window.HaxStore.instance.elementList[e.tag].gizmo&&"undefined"!==p(window.HaxStore.instance.elementList[e.tag].gizmo.handles)&&window.HaxStore.instance.elementList[e.tag].gizmo.handles.length>0)for(var i=window.HaxStore.instance.elementList[e.tag].gizmo,a=0;a<i.handles.length;a++)for(var r in i.handles[a])"type"!==r&&"undefined"!==p(e.properties[i.handles[a][r]])&&(o[r]=e.properties[i.handles[a][r]]);var s=window.HaxStore.guessGizmo(t,o,n);if(s.length>0){var l=this.activeNode.tagName.toLowerCase(),c=l.replace("-"," ");"undefined"!==p(window.HaxStore.instance.elementList[l])&&!1!==window.HaxStore.instance.elementList[l].gizmo&&(c=window.HaxStore.instance.elementList[l].gizmo.title),window.HaxStore.instance.haxAppPicker.presentOptions(s,"__convert","Transform ".concat(c," to.."),"gizmo")}else window.HaxStore.toast("Sorry, this can not be transformed!",5e3)}},{key:"_globalPreferencesUpdated",value:function(e,t){"undefined"!==p(e)&&null!=e&&(this.haxRayMode=e.haxRayMode)}},{key:"_haxStorePropertyUpdated",value:function(e){e.detail&&"undefined"!==p(e.detail.value)&&e.detail.property&&("object"===p(e.detail.value)&&this.set(e.detail.property,null),this.set(e.detail.property,e.detail.value))}},{key:"haxClearBody",value:function(){var e=!0;(!(arguments.length>0&&void 0!==arguments[0])||arguments[0])&&(e=prompt("Are you sure you want to delete all content?")),e&&r.wipeSlot(this)}},{key:"haxInsert",value:function(e,t){var n=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];this.__activeHover=null;var a=document.createElement(e);a.innerHTML=t;var r=a.cloneNode(!0);for(var s in o){var l=window.HaxStore.camelToDash(s);o.hasOwnProperty(s)&&(!0===o[s]?r.setAttribute(l,l):!1===o[s]?r.removeAttribute(l):null!=o[s]&&o[s].constructor===Array?r.properties&&r.properties[s].readOnly||r.set(l,o[s]):null!=o[s]&&o[s].constructor===Object?r.properties&&r.properties[s].readOnly||r.set(l,o[s]):r.setAttribute(l,o[s]))}return null!==window.HaxStore.instance.activePlaceHolder&&"undefined"!==p(window.HaxStore.instance.activePlaceHolder.style)?(r.style.width=window.HaxStore.instance.activePlaceHolder.style.width,r.style.float=window.HaxStore.instance.activePlaceHolder.style.float,r.style.margin=window.HaxStore.instance.activePlaceHolder.style.margin,r.style.display=window.HaxStore.instance.activePlaceHolder.style.display,this.haxReplaceNode(window.HaxStore.instance.activePlaceHolder,r,window.HaxStore.instance.activePlaceHolder.parentNode),window.HaxStore.instance.activePlaceHolder=null):null!=this.activeContainerNode?"GRID-PLATE"!==r.tagName&&"GRID-PLATE"===this.activeContainerNode.tagName&&this.activeContainerNode!==this.activeNode?(null!=this.activeNode.getAttribute("slot")&&r.setAttribute("slot",this.activeNode.getAttribute("slot")),this.activeContainerNode.insertBefore(r,this.activeNode)):this.insertBefore(r,this.activeContainerNode.nextElementSibling):this.appendChild(r),this.shadowRoot.querySelector("#textcontextmenu").highlightOps=!1,this.__updateLockFocus=r,i&&setTimeout(function(){n.breakUpdateLock()},50),!0}},{key:"breakUpdateLock",value:function(){window.HaxStore.write("activeContainerNode",this.__updateLockFocus,this),window.HaxStore.write("activeNode",this.__updateLockFocus,this),this.__updateLockFocus.focus(),"function"==typeof this.__updateLockFocus.scrollIntoViewIfNeeded?this.__updateLockFocus.scrollIntoViewIfNeeded(!0):this.__updateLockFocus.scrollIntoView({behavior:"smooth",inline:"center"})}},{key:"haxToContent",value:function(){this.hideContextMenus();var e=this.activeNode;this.set("activeNode",null),this.set("activeContainerNode",null),window.HaxStore.write("activeNode",null,this),window.HaxStore.write("activeContainerNode",null,this);var t="slot"===this.shadowRoot.querySelector("#body").localName?n.wrap(this.shadowRoot.querySelector("#body")).assignedNodes({flatten:!0}):[];this.globalPreferences.haxDeveloperMode&&console.warn(t);for(var o="",i=0,a=t.length;i<a;i++)this._haxElementTest(t[i])?(t[i].removeAttribute("data-editable"),t[i].removeAttribute("data-hax-ray"),t[i].contentEditable=!1,o+=window.HaxStore.nodeToContent(t[i]),"grid-plate"===t[i].tagName.toLowerCase()&&this._applyContentEditable(this.editMode,t[i])):8===t[i].nodeType?o+="\x3c!-- "+t[i].textContent+" --\x3e":1!==t[i].nodeType&&"undefined"!==p(t[i].textContent)&&"undefined"!==t[i].textContent&&(o+=t[i].textContent);if(o=(o=(o=(o=(o=(o=(o=(o=(o=o.replace(/\scontenteditable=\"false\"/g,"")).replace(/\sdata-editable=\"true\"/g,"")).replace(/\sdata-editable=\"false\"/g,"")).replace(/\sdata-editable=\""/g,"")).replace(/\sdata-editable/g,"")).replace(/\scontenteditable/g,"")).replace(/\sdraggable/g,"")).replace(/\sdata-draggable/g,"")).replace(/\sdata-hax-ray=\".*?\"/g,""),this.parentNode.tagName){var s=this.parentNode.tagName.toLowerCase(),l="style-scope "+s+" x-scope",c=new RegExp(l,"g");o=o.replace(c,""),l="style-scope "+s,c=new RegExp(l,"g"),o=o.replace(c,""),l="x-scope "+s+"-0",c=new RegExp(l,"g"),o=o.replace(c,"");var d=window.HaxStore.instance.validTagList;for(var i in d.push("hax-preview"),d)l="style-scope "+d[i],c=new RegExp(l,"g"),o=o.replace(c,""),l="x-scope "+d[i]+"-0 ",c=new RegExp(l,"g"),o=o.replace(c,""),l="x-scope "+d[i]+"-0",c=new RegExp(l,"g"),o=o.replace(c,"")}return o=(o=o.replace(/\sclass=\"\"/g,"")).replace(/\sclass=\"\s\"/g,""),this._applyContentEditable(this.editMode),window.HaxStore.write("activeNode",e,this),window.HaxStore.write("activeContainerNode",e,this),o=r.encapScript(o),this.globalPreferences.haxDeveloperMode&&console.warn(o),o}},{key:"haxDuplicateNode",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this;this.hideContextMenus();var o=window.HaxStore.nodeToHaxElement(e,null);"undefined"!==p(e.preProcessHaxInsertContent)&&(o=e.preProcessHaxInsertContent(o));var i=window.HaxStore.haxElementToNode(o.tag,o.content,o.properties);return"webview"===i.tagName.toLowerCase()&&window.HaxStore.instance._isSandboxed&&"undefined"!==p(i.guestinstance)&&delete i.guestinstance,null!==e?n.insertBefore(i,e.nextSibling):n.appendChild(i),setTimeout(function(){n===t&&window.HaxStore.write("activeContainerNode",i,t),window.HaxStore.write("activeNode",i,t)},50),!0}},{key:"hideContextMenus",value:function(){this._hideContextMenu(this.shadowRoot.querySelector("#textcontextmenu")),this._hideContextMenu(this.shadowRoot.querySelector("#cecontextmenu")),this._hideContextMenu(this.shadowRoot.querySelector("#platecontextmenu")),this._hideContextMenu(this.shadowRoot.querySelector("#haxinputmixer")),this.shadowRoot.querySelector("#textcontextmenu").highlightOps=!1}},{key:"positionContextMenus",value:function(e,t){if(e){var n=e.tagName.toLowerCase();window.HaxStore.instance._isSandboxed&&"webview"===n&&(n="iframe");var o=window.HaxStore.instance.elementList[n];"undefined"===p(o)||window.HaxStore.instance.isTextElement(e)?this.__activeContextType=this.shadowRoot.querySelector("#textcontextmenu"):(this.__activeContextType=this.shadowRoot.querySelector("#cecontextmenu"),o.element=e,this.__activeContextType.setHaxProperties(o)),this._positionContextMenu(this.__activeContextType,t,-39,-39),this._positionContextMenu(this.shadowRoot.querySelector("#platecontextmenu"),t,-31,0),t&&!this._HTMLPrimativeTest(e)&&e!==t?t.contentEditable=!1:t&&this._HTMLPrimativeTest(t)&&(t.contentEditable=!0)}}},{key:"haxMoveGridPlate",value:function(e,t,n){var o=this;switch(e){case"first":null!==n.previousElementSibling&&this.insertBefore(n,this.firstChild);break;case"up":null!==n.previousElementSibling&&this.insertBefore(n,n.previousElementSibling);break;case"down":null!==n.nextElementSibling&&this.insertBefore(n.nextElementSibling,n);break;case"last":null!==n.nextElementSibling&&this.appendChild(n)}return setTimeout(function(){o.positionContextMenus(t,n),"function"==typeof n.scrollIntoViewIfNeeded?n.scrollIntoViewIfNeeded(!0):n.scrollIntoView({behavior:"smooth",inline:"center"})},50),!0}},{key:"haxReplaceNode",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this;this.hideContextMenus();try{null!=e.getAttribute("slot")&&t.setAttribute("slot",e.getAttribute("slot")),null==e&&(e=this.__oldActiveNode,n=this.__oldActiveNode.parentNode),n.replaceChild(t,e)}catch(e){console.warn(e)}return t}},{key:"haxChangeTagName",value:function(e,t,n){this.hideContextMenus();for(var i=document.createElement(t),a=0,r=e.attributes.length;a<r;++a){var s=e.attributes.item(a).nodeName,l=e.attributes.item(a).value;i.setAttribute(s,l)}i.innerHTML=e.innerHTML.trim(),"ul"==t||"ol"==t?""==i.innerHTML?i.innerHTML="<li></li>":"ul"!=e.tagName.toLowerCase()&&"ol"!=e.tagName.toLowerCase()&&(i.innerHTML="<li>"+e.innerHTML.trim().replace(/<br\/>/g,"</li>\n<li>").replace(/<br>/g,"</li>\n<li>")+"</li>"):"ul"!=e.tagName.toLowerCase()&&"ol"!=e.tagName.toLowerCase()||(i.innerHTML=i.innerHTML.replace(/<ul>/g,"").replace(/<\/ul>/g,"").replace(/<li><\/li>/g,"").replace(/<li>/g,"").replace(/<\/li>/g,"<br/>"));try{this.replaceChild(i,e),setTimeout(function(){var e=o.FlattenedNodesObserver.getFlattenedNodes(i);e[0]&&e.tagName?e[0].focus():i.focus()},50)}catch(t){console.warn(t),console.warn(i),console.warn(e)}return i}},{key:"haxDeleteNode",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this;if(this.hideContextMenus(),null!=this.activeContainerNode&&null!==this.activeContainerNode.previousElementSibling){if(this.activeContainerNode.previousElementSibling.focus(),null!=this.activeContainerNode&&window.HaxStore.instance.isTextElement(this.activeContainerNode)&&""!==this.activeContainerNode.textContent)try{var n=document.createRange(),o=window.HaxStore.getSelection();n.setStart(this.activeContainerNode,1),n.collapse(!0),o.removeAllRanges(),o.addRange(n),this.activeContainerNode.focus()}catch(e){console.warn(e)}}else null!=this.activeContainerNode&&null!==this.activeContainerNode.nextElementSibling?this.activeContainerNode.nextElementSibling.focus():(this.set("activeNode",null),this.set("activeContainerNode",null),window.HaxStore.write("activeNode",null,this),window.HaxStore.write("activeContainerNode",null,this));try{return t.removeChild(e)}catch(e){console.warn(e)}}},{key:"importContent",value:function(e){var t=this;(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&r.wipeSlot(this,"*"),setTimeout(function(){e=r.encapScript(e);var n=document.createElement("div");for(n.insertAdjacentHTML("beforeend",e);null!==n.firstChild;)if("undefined"!==p(n.firstChild.tagName))if(window.HaxStore.instance._isSandboxed&&"iframe"===n.firstChild.tagName.toLowerCase()){for(var o=document.createElement("webview"),i=0,a=n.firstChild.attributes.length;i<a;++i){var s=n.firstChild.attributes.item(i).nodeName,l=n.firstChild.attributes.item(i).value;"height"!==s&&"width"!==s||o.style[s],o.setAttribute(s,l)}t.appendChild(o)}else t.appendChild(n.firstChild);else n.removeChild(n.firstChild)},50)}},{key:"_haxContextOperation",value:function(e){var t,n=this,o=e.detail;switch(o.eventName){case"p":case"ol":case"ul":case"h2":case"h3":case"h4":case"h5":case"h6":case"blockquote":case"code":this.shadowRoot.querySelector("#textcontextmenu").selectedValue=o.eventName,window.HaxStore.write("activeContainerNode",this.haxChangeTagName(this.activeContainerNode,o.eventName),this),this.positionContextMenus(this.activeNode,this.activeContainerNode);break;case"text-align-left":this.activeNode.style.textAlign=null,this.positionContextMenus(this.activeNode,this.activeContainerNode);break;case"grid-plate-convert":this.replaceElementWorkflow();break;case"grid-plate-duplicate":this.activeNode===this.activeContainerNode?this.haxDuplicateNode(this.activeNode):this.haxDuplicateNode(this.activeNode,this.activeContainerNode);break;case"grid-plate-delete":if(null!=this.activeNode){var i=this.activeNode.tagName.toLowerCase(),a=i.replace("-"," ");"undefined"!==p(window.HaxStore.instance.elementList[i])&&!1!==window.HaxStore.instance.elementList[i].gizmo&&(a=window.HaxStore.instance.elementList[i].gizmo.title),window.HaxStore.instance.haxAppPicker.presentOptions([{icon:"thumb-up",color:"green",title:"Yes"},{icon:"thumb-down",color:"red",title:"No"}],"","Remove this `".concat(a,"`?"),"delete")}break;case"grid-plate-first":this.haxMoveGridPlate("first",this.activeNode,this.activeContainerNode);break;case"grid-plate-up":this.haxMoveGridPlate("up",this.activeNode,this.activeContainerNode);break;case"hax-manager-open":window.HaxStore.write("activeHaxElement",{},this),window.HaxStore.instance.haxManager.resetManager(parseInt(o.value)),window.HaxStore.instance.haxManager.toggleDialog();break;case"grid-plate-down":this.haxMoveGridPlate("down",this.activeNode,this.activeContainerNode);break;case"grid-plate-last":this.haxMoveGridPlate("last",this.activeNode,this.activeContainerNode);break;case"close-menu":this.set("activeNode",null),this.set("activeContainerNode",null),window.HaxStore.write("activeNode",null,this),window.HaxStore.write("activeContainerNode",null,this);break;case"hax-edit-property":var r=this.shadowRoot.querySelector("#haxinputmixer");r.label=o.target.label,r.options=o.target.options,r.icon=o.target.icon,r.description=o.target.description,r.required=o.target.required,r.validation=o.target.validation,r.validationType=o.target.validationType,r.inputMethod=o.target.inputMethod,r.value="","undefined"!==p(o.target.propertyToBind)&&null!=o.target.propertyToBind&&0!=o.target.propertyToBind&&(r.propertyToBind=o.target.propertyToBind,"undefined"!==p(this.activeNode[o.target.propertyToBind])?r.value=this.activeNode[o.target.propertyToBind]:r.value=this.activeNode.getAttribute(o.target.propertyToBind)),this._positionContextMenu(r,this.activeContainerNode,-1,-38);var s=this.shadowRoot.querySelector("#cecontextmenu").currentStyle||window.getComputedStyle(this.shadowRoot.querySelector("#cecontextmenu"));r.style.width=s.width.replace("px","")-40+"px";break;case"hax-align-left":this.activeNode.style.float=null,this.activeNode.style.margin=null,this.activeNode.style.display=null,setTimeout(function(){n.positionContextMenus(n.activeNode,n.activeContainerNode)},200);break;case"hax-align-center":this.activeNode.style.float=null,this.activeNode.style.margin="0 auto",this.activeNode.style.display="block",setTimeout(function(){n.positionContextMenus(n.activeNode,n.activeContainerNode)},200);break;case"hax-size-change":this.activeNode&&(this.activeNode.style.width=o.value+"%",setTimeout(function(){n.positionContextMenus(n.activeNode,n.activeContainerNode)},200));break;case"hax-manager-configure":this._hideContextMenu(this.shadowRoot.querySelector("#haxinputmixer")),window.HaxStore.instance.haxManager.resetManager(),t=window.HaxStore.nodeToHaxElement(this.activeNode),window.HaxStore.write("activeHaxElement",t,this),window.HaxStore.instance.haxManager.editExistingNode=!0,window.HaxStore.instance.haxManager.selectStep("configure"),window.HaxStore.instance.haxManager.toggleDialog(),setTimeout(function(){window.HaxStore.instance.haxManager.shadowRoot.querySelector("#preview").shadowRoot.querySelector("#configurebutton").focus()},100);break;case"hax-manager-configure-container":window.HaxStore.write("activeNode",window.HaxStore.instance.activeContainerNode,this),this._hideContextMenu(this.shadowRoot.querySelector("#haxinputmixer")),window.HaxStore.instance.haxManager.resetManager(),t=window.HaxStore.nodeToHaxElement(window.HaxStore.instance.activeNode),window.HaxStore.write("activeHaxElement",t,this),window.HaxStore.instance.haxManager.editExistingNode=!0,window.HaxStore.instance.haxManager.selectStep("configure"),window.HaxStore.instance.haxManager.toggleDialog(),setTimeout(function(){window.HaxStore.instance.haxManager.shadowRoot.querySelector("#preview").shadowRoot.querySelector("#configurebutton").focus()},100)}}},{key:"_haxInputMixerOperation",value:function(e){var t=e.detail.inputMixer;null!=t.propertyToBind?this.activeNode[t.propertyToBind]=t.value:null!=t.slotToBind&&(item=document.createElement("span"),item.style.height="inherit",item.innerHTML=t.value,item.slot=t.slotToBind,this.activeNode.appendChild(item)),this._hideContextMenu(this.shadowRoot.querySelector("#haxinputmixer"))}},{key:"_focusIn",value:function(e){this.__focusLogic(e.target)&&e.stopPropagation()}},{key:"__focusLogic",value:function(e){var t=!1;if(this.editMode&&!this.__tabTrap){var n=e,o=null;if(this._haxElementTest(n)&&null!=n.parentNode){for(;"HAX-BODY"!=n.parentNode.tagName;)null===o&&"LI"!==n.tagName&&"B"!==n.tagName&&"I"!==n.tagName&&"STRONG"!==n.tagName&&"EM"!==n.tagName&&(o=n),n=n.parentNode;null===o?o=n:window.HaxStore.instance.isGridPlateElement(n)?["UL","OL","LI","P","GRID-PLATE"].includes(n.tagName)&&["UL","OL","LI"].includes(o.tagName)&&(o=n):o=n,this.activeContainerNode===n||n.classList.contains("ignore-activation")?n.classList.contains("ignore-activation")&&(t=!0):(this.hideContextMenus(),this.activeContainerNode=n,window.HaxStore.write("activeContainerNode",n,this),t=!0),this.activeNode===o||o.classList.contains("ignore-activation")||(this.activeNode=o,window.HaxStore.write("activeNode",o,this),this.positionContextMenus(o,n),t=!0)}}else this.__tabTrap=!1;return t}},{key:"_editModeChanged",value:function(e,t){"undefined"!==p(t)&&(this._applyContentEditable(e),this.setAttribute("tabindex","-1"),!1!==e&&"undefined"!==p(this.activeNode)&&null!==this.activeNode&&this.positionContextMenus(this.activeNode,this.activeContainerNode)),!1===e&&(this.removeAttribute("contenteditable"),this.hideContextMenus())}},{key:"_haxResolvePreviousElement",value:function(e){for(e=e.previousElementSibling;null!=e&&"undefined"!==p(e.tagName)&&"HAX-"===e.tagName.substring(0,4);)e=e.previousElementSibling;return e}},{key:"_haxElementTest",value:function(e){return"undefined"!==p(e.tagName)&&"HAX-"!==e.tagName.substring(0,4)}},{key:"_HTMLPrimativeTest",value:function(e){return null!=e&&"undefined"!==p(e.tagName)&&-1==e.tagName.indexOf("-")}},{key:"_applyContentEditable",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.shadowRoot.querySelector("#body"),i="slot"===t.localName?n.wrap(t).assignedNodes({flatten:!0}):[];0===i.length&&(i=o.FlattenedNodesObserver.getFlattenedNodes(t));for(var a=0,r=i.length;a<r;a++){if(this._HTMLPrimativeTest(i[a]))if(e){if(i[a].setAttribute("contenteditable",e),i[a].setAttribute("data-editable",e),i[a].querySelectorAll("a").length>0)for(var s=i[a].querySelectorAll("a"),l=0,c=s.length;l<c;l++)s[l].setAttribute("contenteditable",e),s[l].setAttribute("data-editable",e),s[l].addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation()})}else if(i[a].removeAttribute("data-editable",e),i[a].removeAttribute("contenteditable",e),i[a].querySelectorAll("a").length>0){var d=i[a].querySelectorAll("a");for(l=0,c=d.length;l<c;l++)d[l].removeAttribute("data-editable",e),d[l].removeAttribute("contenteditable",e),d[l].removeEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation()})}if(this._haxElementTest(i[a]))if(e){i[a].setAttribute("data-editable",e);var p=i[a].tagName.replace("-"," ").toLowerCase(),u=window.HaxStore.instance.gizmoList.findIndex(function(e){return e.tag===i[a].tagName.toLowerCase()});-1!==u&&(p=window.HaxStore.instance.gizmoList[u].title),i[a].setAttribute("data-hax-ray",p)}else i[a].removeAttribute("data-editable"),i[a].removeAttribute("data-hax-ray")}}},{key:"_activeContainerNodeChanged",value:function(e,t){this.editMode&&"undefined"!==p(e)&&null!=e&&null!=e.tagName&&(window.HaxStore.instance.isTextElement(e)||window.HaxStore.instance.isGridPlateElement(e)?(e.setAttribute("contenteditable",!0),this.setAttribute("contenteditable",!0)):(e.removeAttribute("contenteditable"),this.removeAttribute("contenteditable")),"grid-plate"===e.tagName.toLowerCase()&&(e.editMode=this.editMode,this._applyContentEditable(this.editMode,e)))}},{key:"_activeNodeChanged",value:function(e,t){var n=this;if("undefined"!==p(t)&&null!=t&&t.classList.remove("hax-active"),this.editMode&&"undefined"!==p(e)&&null!==e){var o=e.tagName.toLowerCase();e.classList.add("hax-active"),window.HaxStore.instance.isTextElement(e)||window.HaxStore.instance.isGridPlateElement(e)?(e.setAttribute("contenteditable",!0),this.setAttribute("contenteditable",!0)):(e.removeAttribute("contenteditable"),this.removeAttribute("contenteditable")),this.shadowRoot.querySelector("#textcontextmenu").selectedValue=o,setTimeout(function(){n.positionContextMenus(e,window.HaxStore.instance.activeContainerNode)},100),"left"==e.style.textAlign?(this.shadowRoot.querySelector("#textcontextmenu").justifyIcon="editor:format-align-left",this.shadowRoot.querySelector("#textcontextmenu").justifyValue="text-align-left"):"left"==e.style.float?(this.shadowRoot.querySelector("#cecontextmenu").justifyIcon="editor:format-align-left",this.shadowRoot.querySelector("#cecontextmenu").justifyValue="hax-align-left"):"0 auto"==e.style.margin&&(this.shadowRoot.querySelector("#cecontextmenu").justifyIcon="editor:format-align-center",this.shadowRoot.querySelector("#cecontextmenu").justifyValue="hax-align-center")}else null===e&&(this.hideContextMenus(),this.__oldActiveNode=t,this.shadowRoot.querySelector("#textcontextmenu").justifyIcon="editor:format-align-left",this.shadowRoot.querySelector("#textcontextmenu").justifyValue="text-align-left")}},{key:"_getPosition",value:function(e){return{x:e.offsetLeft-e.scrollLeft+e.clientLeft,y:e.offsetTop-e.scrollTop+e.clientTop}}},{key:"_positionContextMenu",value:function(e,t,n,o){var i=this;if(null!=t){var r=this._getPosition(t);e.style.left=null!=n?r.x+n+"px":r.x+"px",e.style.top=null!=o?r.y+o+"px":r.y+"px"}e.classList.add("hax-context-visible"),this.__activeHover&&(e.classList.add("hax-active-hover"),e.style.marginLeft="",this.__typeLock=!1),setTimeout(function(){a.microTask.run(i._keepContextVisible())},100)}},{key:"_hideContextMenu",value:function(e){e.classList.remove("hax-context-visible","hax-context-pin-top","hax-context-pin-bottom"),e.style.left="-100px"}},{key:"_tabKeyPressed",value:function(){var e=!1,t=this.activeContainerNode,n=this.activeContainerNode.tagName;try{var o=window.HaxStore.getRange().cloneRange(),i=o.commonAncestorContainer.tagName;if("undefined"===p(i)&&(i=o.commonAncestorContainer.parentNode.tagName),["UL","OL","LI"].includes(n)||["UL","OL","LI"].includes(i))this.polyfillSafe&&(document.execCommand("indent"),this.__tabTrap=!0);else for(;!e;)null==t.nextSibling?e=!0:"function"===t.nextSibling.focus?(t.nextSibling.focus(),e=!0):t=t.nextSibling}catch(e){console.warn(e)}}},{key:"_tabBackKeyPressed",value:function(){var e=this.activeContainerNode,t=this.activeContainerNode.tagName;try{var n=window.HaxStore.getRange().cloneRange(),o=n.commonAncestorContainer.tagName;if("undefined"===p(o)&&(o=n.commonAncestorContainer.parentNode.tagName),["UL","OL","LI"].includes(t)||["UL","OL","LI"].includes(o))this.polyfillSafe&&(document.execCommand("outdent"),this.__tabTrap=!0);else{if(null!=e)for(;null!=e&&!this._haxElementTest(e);)e=e.previousSibling;null!=e&&setTimeout(function(){e.focus()},50)}}catch(e){console.warn(e)}}}],[{key:"tag",get:function(){return"hax-body"}},{key:"template",get:function(){return t.html(P())}},{key:"properties",get:function(){return{editMode:{type:Boolean,value:!1,reflectToAttribute:!0,observer:"_editModeChanged"},globalPreferences:{type:Object,value:{},observer:"_globalPreferencesUpdated"},haxRayMode:{type:Boolean,value:!1,reflectToAttribute:!0},activeNode:{type:Object,value:null,notify:!0,observer:"_activeNodeChanged"},activeContainerNode:{type:Object,value:null,notify:!0,observer:"_activeContainerNodeChanged"}}}}]),s}();window.customElements.define(q.tag,q),e.HaxBody=q,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=hax-body.umd.js.map
