{"version":3,"file":"wysiwyg-hax.umd.js","sources":["wysiwyg-hax.umd.js"],"sourcesContent":["import { LitElement, html, css } from \"lit-element/lit-element.js\";\nimport \"@lrnwebcomponents/cms-hax/cms-hax.js\";\n/**\n * `wysiwyg-hax`\n * `Integration of wysiwyg edit form for a page with HAX.`\n * @demo demo/index.html\n * @customElement wysiwyg-hax\n */\nclass WysiwygHax extends LitElement {\n  /**\n   * LitElement constructable styles enhancement\n   */\n  static get styles() {\n    return [\n      css`\n        :host {\n          display: block;\n        }\n      `\n    ];\n  }\n  render() {\n    return html`\n      <textarea\n        class=\"${this.fieldClass}\"\n        id=\"${this.fieldId}\"\n        name=\"${this.fieldName}\"\n        hidden=\"\"\n      >\n      ${this.bodyValue}\n      </textarea\n      >\n      <cms-hax\n        hide-message=\"\"\n        redirect-location=\"${this.redirectLocation}\"\n        update-page-data=\"${this.updatePageData}\"\n        end-point=\"${this.endPoint}\"\n        app-store-connection=\"${this.appStoreConnection}\"\n        ?open-default=\"${this.openDefault}\"\n        ?sync-body=\"${this.syncBody}\"\n        ?hide-export-button=\"${this.hideExportButton}\"\n        ?hide-panel-ops=\"${this.hidePanelOps}\"\n        ?hide-preferences-button=\"${this.hidePreferencesButton}\"\n        align=\"${this.align}\"\n      >\n      </cms-hax>\n    `;\n  }\n\n  static get tag() {\n    return \"wysiwyg-hax\";\n  }\n  constructor() {\n    super();\n    // import child nodes before things start deleting whats in there\n    let children = this.querySelector(\"template\");\n    if (children) {\n      this.__importContent = children.innerHTML;\n    }\n    this.openDefault = false;\n    this.hideExportButton = false;\n    this.align = \"right\";\n    this.fieldId = \"textarea-input-field\";\n    this.fieldName = \"data[content]\";\n    this.__imported = false;\n    this.redirectLocation = \"\";\n    this.updatePageData = \"\";\n    window.addEventListener(\"hax-save\", this._bodyContentUpdated.bind(this));\n    window.addEventListener(\n      \"hax-store-property-updated\",\n      this._haxStorePropertyUpdated.bind(this)\n    );\n  }\n  updated(changedProperties) {\n    changedProperties.forEach((oldValue, propName) => {\n      if (propName == \"activeHaxBody\") {\n        this._activeHaxBodyUpdated(this[propName]);\n      }\n    });\n  }\n  static get properties() {\n    return {\n      /**\n       * Default the panel to open\n       */\n      openDefault: {\n        type: Boolean,\n        attribute: \"open-default\"\n      },\n      redirectLocation: {\n        type: String,\n        attribute: \"redirect-location\"\n      },\n      hideExportButton: {\n        type: Boolean,\n        attribute: \"hide-export-button\"\n      },\n      /**\n       * Hide the panel operations (save and cancel),\n       */\n      hidePanelOps: {\n        type: Boolean,\n        attribute: \"hide-panel-ops\"\n      },\n      /**\n       * Hide preferences button\n       */\n      hidePreferencesButton: {\n        type: Boolean,\n        attribute: \"hide-preferences-button\"\n      },\n      /**\n       * Direction to align the hax edit panel\n       */\n      align: {\n        type: String\n      },\n      /**\n       * Data binding of a hidden text area with the value from the hax-body tag\n       */\n      bodyValue: {\n        type: String,\n        attribute: \"body-value\"\n      },\n      /**\n       * Connection object for talking to an app store.\n       */\n      appStoreConnection: {\n        type: String,\n        attribute: \"app-store-connection\"\n      },\n      /**\n       * class on the field\n       */\n      fieldClass: {\n        type: String,\n        attribute: \"field-class\"\n      },\n      /**\n       * fieldId, id value on the input field.\n       */\n      fieldId: {\n        type: String,\n        attribute: \"field-id\"\n      },\n      /**\n       * fieldName, internal to the form in whatever system it's in.\n       */\n      fieldName: {\n        type: String,\n        attribute: \"field-name\"\n      },\n      syncBody: {\n        type: Boolean,\n        attribute: \"sync-body\",\n        reflect: true\n      },\n      /**\n       * State of the panel\n       */\n      editMode: {\n        type: Boolean,\n        reflect: true,\n        attribute: \"edit-mode\"\n      },\n      /**\n       * Location to save content to.\n       */\n      endPoint: {\n        type: String,\n        attribute: \"end-point\"\n      },\n      /**\n       * Page data, body of text as a string.\n       */\n      updatePageData: {\n        type: String,\n        attribute: \"update-page-data\"\n      },\n      /**\n       * Reference to activeBody.\n       */\n      activeHaxBody: {\n        type: Object\n      },\n      __imported: {\n        type: Boolean\n      }\n    };\n  }\n  createRenderRoot() {\n    return this;\n  }\n  /**\n   * Ensure we've imported our content on initial setup\n   */\n  _activeHaxBodyUpdated(newValue) {\n    // ensure we import our content once we get an initial registration of active body\n    if (newValue != null && !this.__imported) {\n      this.__imported = true;\n      if (this.__importContent) {\n        newValue.importContent(this.__importContent);\n      }\n    }\n  }\n  disconnectedCallback() {\n    window.removeEventListener(\"hax-save\", this._bodyContentUpdated.bind(this));\n    window.removeEventListener(\n      \"hax-store-property-updated\",\n      this._haxStorePropertyUpdated.bind(this)\n    );\n    super.disconnectedCallback();\n  }\n  /**\n   * Store updated, sync.\n   */\n  _haxStorePropertyUpdated(e) {\n    if (\n      e.detail &&\n      typeof e.detail.value !== typeof undefined &&\n      e.detail.property\n    ) {\n      if (typeof e.detail.value === \"object\") {\n        this[e.detail.property] = null;\n      }\n      this[e.detail.property] = e.detail.value;\n    }\n  }\n\n  /**\n   * Set the bubbled up event to the body value that just got changed\n   */\n  _bodyContentUpdated(e) {\n    this.bodyValue = window.HaxStore.instance.activeHaxBody.haxToContent();\n  }\n}\nwindow.customElements.define(WysiwygHax.tag, WysiwygHax);\nexport { WysiwygHax };\n"],"names":["WysiwygHax","children","querySelector","__importContent","innerHTML","openDefault","hideExportButton","align","fieldId","fieldName","__imported","redirectLocation","updatePageData","window","addEventListener","_this","_bodyContentUpdated","bind","_haxStorePropertyUpdated","LitElement","html","this","fieldClass","bodyValue","endPoint","appStoreConnection","syncBody","hidePanelOps","hidePreferencesButton","css","changedProperties","forEach","oldValue","propName","_this2","_activeHaxBodyUpdated","newValue","importContent","removeEventListener","e","detail","_typeof","value","property","HaxStore","instance","activeHaxBody","haxToContent","type","Boolean","attribute","String","reflect","editMode","Object","customElements","define","tag"],"mappings":"6uEAQMA,sJA+CEC,4EAAgBC,cAAc,mBAC9BD,MACGE,gBAAkBF,EAASG,aAE7BC,aAAc,IACdC,kBAAmB,IACnBC,MAAQ,UACRC,QAAU,yBACVC,UAAY,kBACZC,YAAa,IACbC,iBAAmB,KACnBC,eAAiB,GACtBC,OAAOC,iBAAiB,WAAYC,EAAKC,oBAAoBC,YAC7DJ,OAAOC,iBACL,6BACAC,EAAKG,yBAAyBD,0PA9DXE,yDAcdC,WAEMC,KAAKC,WACRD,KAAKb,QACHa,KAAKZ,UAGbY,KAAKE,UAKgBF,KAAKV,iBACNU,KAAKT,eACZS,KAAKG,SACMH,KAAKI,mBACZJ,KAAKhB,YACRgB,KAAKK,SACIL,KAAKf,iBACTe,KAAKM,aACIN,KAAKO,sBACxBP,KAAKd,8CA9BX,CACLsB,8CAoCK,qDAuBDC,cACNA,EAAkBC,QAAQ,SAACC,EAAUC,GACnB,iBAAZA,GACFC,EAAKC,sBAAsBD,EAAKD,wDAmH7BZ,mDAKae,GAEJ,MAAZA,GAAqBf,KAAKX,kBACvBA,YAAa,EACdW,KAAKlB,iBACPiC,EAASC,cAAchB,KAAKlB,iEAKhCU,OAAOyB,oBAAoB,WAAYjB,KAAKL,oBAAoBC,KAAKI,OACrER,OAAOyB,oBACL,6BACAjB,KAAKH,yBAAyBD,KAAKI,iHAOdkB,GAErBA,EAAEC,sBACFC,EAAOF,EAAEC,OAAOE,QAChBH,EAAEC,OAAOG,WAEqB,WAA1BF,EAAOF,EAAEC,OAAOE,cACbH,EAAEC,OAAOG,UAAY,WAEvBJ,EAAEC,OAAOG,UAAYJ,EAAEC,OAAOE,mDAOnBH,QACbhB,UAAYV,OAAO+B,SAASC,SAASC,cAAcC,0DAxJjD,CAIL1C,YAAa,CACX2C,KAAMC,QACNC,UAAW,gBAEbvC,iBAAkB,CAChBqC,KAAMG,OACND,UAAW,qBAEb5C,iBAAkB,CAChB0C,KAAMC,QACNC,UAAW,sBAKbvB,aAAc,CACZqB,KAAMC,QACNC,UAAW,kBAKbtB,sBAAuB,CACrBoB,KAAMC,QACNC,UAAW,2BAKb3C,MAAO,CACLyC,KAAMG,QAKR5B,UAAW,CACTyB,KAAMG,OACND,UAAW,cAKbzB,mBAAoB,CAClBuB,KAAMG,OACND,UAAW,wBAKb5B,WAAY,CACV0B,KAAMG,OACND,UAAW,eAKb1C,QAAS,CACPwC,KAAMG,OACND,UAAW,YAKbzC,UAAW,CACTuC,KAAMG,OACND,UAAW,cAEbxB,SAAU,CACRsB,KAAMC,QACNC,UAAW,YACXE,SAAS,GAKXC,SAAU,CACRL,KAAMC,QACNG,SAAS,EACTF,UAAW,aAKb1B,SAAU,CACRwB,KAAMG,OACND,UAAW,aAKbtC,eAAgB,CACdoC,KAAMG,OACND,UAAW,oBAKbJ,cAAe,CACbE,KAAMM,QAER5C,WAAY,CACVsC,KAAMC,mBAkDdpC,OAAO0C,eAAeC,OAAOxD,EAAWyD,IAAKzD"}