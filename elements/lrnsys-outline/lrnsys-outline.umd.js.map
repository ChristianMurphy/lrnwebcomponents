{"version":3,"file":"lrnsys-outline.umd.js","sources":["lib/lrnsys-outline-item.js","lrnsys-outline.umd.js"],"sourcesContent":["import { html, PolymerElement } from \"@polymer/polymer/polymer-element.js\";\nimport { afterNextRender } from \"@polymer/polymer/lib/utils/render-status.js\";\nimport \"@polymer/iron-list/iron-list.js\";\nimport \"@polymer/iron-a11y-keys/iron-a11y-keys.js\";\nimport \"@polymer/paper-input/paper-input.js\";\nimport \"@polymer/iron-icons/iron-icons.js\";\nimport \"@polymer/paper-icon-button/paper-icon-button.js\";\nimport \"@lrnwebcomponents/drawing-icons/drawing-icons.js\";\n/**\n`lrnsys-outline-item`\nA LRN element\n\n* @demo demo/index.html\n\n@microcopy - the mental model for this element\n -\n\n*/\nclass LrnsysOutlineItem extends PolymerElement {\n  static get template() {\n    return html`\n    <style>\n      :host {\n        display: block;\n        --indent-multiplier: 36px;\n      }\n      :host(.collapse-to-remove) #wrapper {\n        height: 0px;\n        background-color: var(--lrnsys-outline-gap-color, #eeeeee);\n        border: 1px solid #999999;\n        overflow: hidden;\n      }\n      :host #wrapper[data-indent=\"0\"] #gap {\n        margin-right: calc(var(--indent-multiplier) * 0);\n      }\n      :host #wrapper[data-indent=\"1\"] #gap {\n        margin-right: calc(var(--indent-multiplier) * 1);\n      }\n      :host #wrapper[data-indent=\"2\"] #gap {\n        margin-right: calc(var(--indent-multiplier) * 2);\n      }\n      :host #wrapper[data-indent=\"3\"] #gap {\n        margin-right: calc(var(--indent-multiplier) * 3);\n      }\n      :host #wrapper[data-indent=\"4\"] #gap {\n        margin-right: calc(var(--indent-multiplier) * 4);\n      }\n      :host #wrapper[data-indent=\"5\"] #gap {\n        margin-right: calc(var(--indent-multiplier) * 5);\n      }\n      :host #wrapper[data-indent=\"6\"] #gap {\n        margin-right: calc(var(--indent-multiplier) * 6);\n      }\n      :host #wrapper[data-indent=\"7\"] #gap {\n        margin-right: calc(var(--indent-multiplier) * 7);\n      }\n      :host #wrapper[data-indent=\"8\"] #gap {\n        margin-right: calc(var(--indent-multiplier) * 8);\n      }\n      :host #wrapper[data-indent=\"9\"] #gap {\n        margin-right: calc(var(--indent-multiplier) * 9);\n      }\n      :host #input {\n        flex-grow: 1;\n        margin-right: 10px;\n      }\n      :host #wrapper {\n        display: flex;\n        height: 40px;\n        border-radius: 16px;\n        transition: 0.1s all ease;\n        background-color: transparent;\n        border: 1px solid transparent;\n        padding: 8px;\n        transition: 0.3s all linear;\n      }\n      :host([focus-state]) #wrapper,\n      :host(:focus) #wrapper,\n      :host(:hover) #wrapper {\n        cursor: pointer;\n        background-color: var(--lrnsys-outline-gap-color, #eeeeee);\n        border: 1px solid #999999;\n      }\n      #gap {\n        padding: 2px;\n        transition: 0.3s all ease;\n        border-left: solid 4px transparent;\n      }\n      :host([focus-state]) #gap,\n      :host(:focus) #gap,\n      :host(:hover) #gap {\n        border-left: solid 4px var(--lrnsys-outline-gap-color, #aaaaaa);\n      }\n      paper-icon-button {\n        font-size: 16px;\n        height: 36px;\n        padding: 10px;\n        margin: 4px;\n        display: none;\n        border-radius: 0.16px;\n      }\n      :host([focus-state]) paper-icon-button,\n      :host(:focus) paper-icon-button,\n      :host(:hover) paper-icon-button {\n        width: 36px;\n        display: inline-flex;\n      }\n      paper-icon-button#add {\n        width: 36px;\n        margin-right: 2px;\n        color: white;\n        background-color: var(--lrnsys-outline-add-button-color, #018dff);\n      }\n      paper-icon-button#delete {\n        color: white;\n        background-color: var(--lrnsys-outline-delete-button-color, #cc0000);\n      }\n    </style>\n    <div id=\"wrapper\" data-indent$=\"[[indentLevel]]\">\n      <div id=\"gap\"></div>\n      <paper-input\n        id=\"input\"\n        label=\"Enter a page title\"\n        value=\"{{title}}\"\n        no-label-float=\"\"\n      >\n      </paper-input>\n      <paper-icon-button\n        id=\"down\"\n        title=\"Move downwards\"\n        icon=\"icons:arrow-downward\"\n        on-tap=\"moveDown\"\n      ></paper-icon-button>\n      <paper-icon-button\n        id=\"left\"\n        title=\"Outdent\"\n        icon=\"icons:arrow-back\"\n        on-tap=\"moveOut\"\n      ></paper-icon-button>\n      <paper-icon-button\n        id=\"right\"\n        title=\"Indent\"\n        icon=\"icons:arrow-forward\"\n        on-tap=\"moveIn\"\n      ></paper-icon-button>\n      <paper-icon-button\n        id=\"up\"\n        title=\"Move upwards\"\n        icon=\"icons:arrow-upward\"\n        on-tap=\"moveUp\"\n      ></paper-icon-button>\n      <paper-icon-button\n        id=\"add\"\n        title=\"Add Item\"\n        icon=\"icons:add\"\n        on-tap=\"add\"\n      ></paper-icon-button>\n      <paper-icon-button\n        id=\"delete\"\n        title=\"Delete\"\n        icon=\"icons:delete\"\n        on-tap=\"delete\"\n      ></paper-icon-button>\n    </div>\n    <iron-a11y-keys\n      target=\"[[__inputTarget]]\"\n      keys=\"esc\"\n      on-keys-pressed=\"_onEsc\"\n    ></iron-a11y-keys>\n    <iron-a11y-keys\n      target=\"[[__inputTarget]]\"\n      keys=\"enter\"\n      on-keys-pressed=\"_onEnter\"\n    ></iron-a11y-keys>\n    <iron-a11y-keys\n      target=\"[[__inputTarget]]\"\n      keys=\"backspace\"\n      on-keys-pressed=\"_onBackspace\"\n    ></iron-a11y-keys>\n    <iron-a11y-keys\n      target=\"[[__inputTarget]]\"\n      keys=\"up\"\n      on-keys-pressed=\"_onArrowUp\"\n    ></iron-a11y-keys>\n    <iron-a11y-keys\n      target=\"[[__inputTarget]]\"\n      keys=\"down\"\n      on-keys-pressed=\"_onArrowDown\"\n    ></iron-a11y-keys>\n    <iron-a11y-keys\n      target=\"[[__inputTarget]]\"\n      keys=\"tab\"\n      on-keys-pressed=\"_onTab\"\n    ></iron-a11y-keys>\n    <iron-a11y-keys\n      target=\"[[__inputTarget]]\"\n      keys=\"shift+tab\"\n      on-keys-pressed=\"_onShiftTab\"\n    ></iron-a11y-keys>\n    <iron-a11y-keys\n      target=\"[[__inputTarget]]\"\n      keys=\"shift+up\"\n      on-keys-pressed=\"_onShiftArrowUp\"\n    ></iron-a11y-keys>\n    <iron-a11y-keys\n      target=\"[[__inputTarget]]\"\n      keys=\"shift+down\"\n      on-keys-pressed=\"_onShiftArrowDown\"\n    ></iron-a11y-keys>`;\n  }\n  static get tag() {\n    return \"lrnsys-outline-item\";\n  }\n  static get properties() {\n    return {\n      indentLevel: {\n        type: Number,\n        value: 0\n      },\n      index: {\n        type: Number,\n        value: 0\n      },\n      parent: {\n        type: String,\n        value: null\n      },\n      title: {\n        type: String,\n        value: null,\n        notify: true,\n        reflectToAttribute: true\n      },\n      /**\n       * Tracks if focus state is applied\n       */\n      focusState: {\n        type: Boolean,\n        value: false,\n        reflectToAttribute: true\n      }\n    };\n  }\n  _focusin(e) {\n    this.focusState = true;\n  }\n  _focusout(e) {\n    this.focusState = false;\n  }\n  /**\n   * attached life cycle\n   */\n  connectedCallback() {\n    super.connectedCallback();\n    this.dispatchEvent(new CustomEvent(\"attached-item\", {\n      bubbles: true,\n      cancelable: true,\n      composed: true,\n      detail:  { item: this }\n    }));\n  }\n  /**\n   * ready life cycle\n   */\n  ready() {\n    super.ready();\n    this.__inputTarget = this.$.input;\n    this.dispatchEvent(new CustomEvent(\"focus-item\", {\n      bubbles: true,\n      cancelable: true,\n      composed: true,\n      detail:  this\n    }));\n    afterNextRender(this, function () {\n      this.addEventListener('change', this._onChange.bind(this));\n      this.addEventListener(\"focus\", e => {\n        this.dispatchEvent(new CustomEvent(\"focus-item\", {\n        bubbles: true,\n        cancelable: true,\n        composed: true,\n        detail:  this\n      }));\n      });\n      this.addEventListener(\"mouseover\", e => {\n        this.dispatchEvent(new CustomEvent(\"focus-item\", {\n        bubbles: true,\n        cancelable: true,\n        composed: true,\n        detail:  this\n      }));\n      });\n      this.addEventListener(\"blur\", e => {\n        this.dispatchEvent(new CustomEvent(\"blur-item\", {\n        bubbles: true,\n        cancelable: true,\n        composed: true,\n        detail:  this\n      }));\n      });\n      this.addEventListener(\"mouseout\", e => {\n        this.dispatchEvent(new CustomEvent(\"blur-item\", {\n        bubbles: true,\n        cancelable: true,\n        composed: true,\n        detail:  this\n      }));\n      });\n      this.$.input.addEventListener(\"focused-changed\", this._focusin.bind(this));\n      this.addEventListener(\"focusin\", this._focusin.bind(this));\n      this.addEventListener(\"focusout\", this._focusout.bind(this));\n    });\n  }\n  /**\n   * detached life cycle\n   */\n  disconnectedCallback() {\n    this.removeEventListener('change', this._onChange.bind(this));\n    this.removeEventListener(\"focus\", e => {\n      this.dispatchEvent(new CustomEvent(\"focus-item\", {\n      bubbles: true,\n      cancelable: true,\n      composed: true,\n      detail:  this\n    }));\n    });\n    this.removeEventListener(\"mouseover\", e => {\n      this.dispatchEvent(new CustomEvent(\"focus-item\", {\n      bubbles: true,\n      cancelable: true,\n      composed: true,\n      detail:  this\n    }));\n    });\n    this.removeEventListener(\"blur\", e => {\n      this.dispatchEvent(new CustomEvent(\"blur-item\", {\n      bubbles: true,\n      cancelable: true,\n      composed: true,\n      detail:  this\n    }));\n    });\n    this.removeEventListener(\"mouseout\", e => {\n      this.dispatchEvent(new CustomEvent(\"blur-item\", {\n      bubbles: true,\n      cancelable: true,\n      composed: true,\n      detail:  this\n    }));\n    });\n    this.$.input.removeEventListener(\n      \"focused-changed\",\n      this._focusin.bind(this)\n    );\n    this.removeEventListener(\"focusin\", this._focusin.bind(this));\n    this.removeEventListener(\"focusout\", this._focusout.bind(this));\n    super.disconnectedCallback();\n  }\n\n  focus() {\n    this.$.input.focus();\n    return this;\n  }\n\n  value() {\n    this.title = this.$.input.value;\n    return this.title;\n  }\n\n  delete() {\n    this.dispatchEvent(new CustomEvent(\"delete-item\", {\n      bubbles: true,\n      cancelable: true,\n      composed: true,\n      detail:  { item: this }\n    }));\n  }\n\n  setIndent(amount) {\n    this.dispatchEvent(new CustomEvent(\"indent-item\", {\n      bubbles: true,\n      cancelable: true,\n      composed: true,\n      detail:  { item: this, increase: amount > 0 }\n    }));\n  }\n\n  add() {\n    let i = this.$.input.shadowRoot.querySelector(\"#\" + this.$.input._inputId)\n        .inputElement.selectionStart,\n      j = this.title;\n    this.dispatchEvent(new CustomEvent(\"add-item\", {\n      bubbles: true,\n      cancelable: true,\n      composed: true,\n      detail: {\n        item: this,\n        value: j.slice(0, i),\n        new: j.slice(i, j.length)\n      }\n    }));\n    this.title = j.slice(0, i);\n  }\n\n  move(amount) {\n    this.dispatchEvent(new CustomEvent(\"move-item\", {\n      bubbles: true,\n      cancelable: true,\n      composed: true,\n      detail:  { item: this, moveUp: amount < 0 }\n    }));\n  }\n  moveUp(e) {\n    this.move(-1);\n  }\n  moveDown(e) {\n    this.move(1);\n  }\n  moveOut(e) {\n    this.setIndent(-1);\n  }\n  moveIn(e) {\n    this.setIndent(1);\n  }\n  setSelection(start, end) {\n    let s = start !== undefined ? start : 0,\n      n = end !== undefined ? end : s;\n    try {\n      this.$.input.querySelector(\"input\").setSelectionRange(s, n);\n    } catch (e) {\n      console.log(e);\n    }\n    this.focus();\n  }\n\n  _onChange() {\n    this.dispatchEvent(new CustomEvent(\"change-item\", {\n      bubbles: true,\n      cancelable: true,\n      composed: true,\n      detail:  { item: this, value: this.title }\n    }));\n  }\n  _onEsc() {\n    this.focus();\n    this._focusout();\n  }\n  _onEnter() {\n    let i = this.$.input.shadowRoot.querySelector(\"#\" + this.$.input._inputId)\n        .inputElement.selectionStart,\n      j = this.title;\n    this.dispatchEvent(new CustomEvent(\"add-item\", {\n      bubbles: true,\n      cancelable: true,\n      composed: true,\n      detail: {\n        item: this,\n        value: j.slice(0, i),\n        new: j.slice(i, j.length)\n      }\n    }));\n    this.title = j.slice(0, i);\n    this._focusout();\n  }\n\n  _onBackspace(e) {\n    if (this._getSelection().toString() == this.title) {\n      e.detail.keyboardEvent.preventDefault();\n      this.dispatchEvent(new CustomEvent(\"delete-item\", {\n      bubbles: true,\n      cancelable: true,\n      composed: true,\n      detail:  { item: this }\n    }));\n    } else if (\n      this.$.input.shadowRoot.querySelector(\"#\" + this.$.input._inputId)\n        .inputElement.selectionStart == 0\n    ) {\n      this.dispatchEvent(new CustomEvent(\"indent-item\", {\n      bubbles: true,\n      cancelable: true,\n      composed: true,\n      detail:  { item: this, increase: false }\n    }));\n    }\n  }\n\n  /**\n   * Selection normalizer\n   */\n  _getSelection() {\n    // try and obtain the selection from the nearest shadow\n    // which would give us the selection object when running native ShadowDOM\n    // with fallback support for the entire window which would imply Shady\n    if (\n      this.parentNode &&\n      this.parentNode.parentNode &&\n      this.parentNode.parentNode.getSelection\n    ) {\n      return this.parentNode.parentNode.getSelection();\n    }\n    return window.getSelection();\n  }\n\n  _onArrowUp() {\n    if (\n      this.$.input.shadowRoot.querySelector(\"#\" + this.$.input._inputId)\n        .inputElement.selectionStart == 0\n    ) {\n      this.dispatchEvent(new CustomEvent(\"focus-item\", {\n      bubbles: true,\n      cancelable: true,\n      composed: true,\n      detail:  { item: this, moveUp: true }\n    }));\n    }\n  }\n\n  _onArrowDown() {\n    if (\n      this.$.input.shadowRoot.querySelector(\"#\" + this.$.input._inputId)\n        .inputElement.selectionStart == this.title.length\n    ) {\n      this.dispatchEvent(new CustomEvent(\"focus-item\", {\n      bubbles: true,\n      cancelable: true,\n      composed: true,\n      detail:  { item: this, moveUp: false }\n    }));\n    }\n  }\n\n  _onShiftTab() {\n    this.setIndent(-1);\n  }\n\n  _onTab(e) {\n    if (\n      this.$.input.shadowRoot.querySelector(\"#\" + this.$.input._inputId)\n        .inputElement.selectionStart == 0\n    ) {\n      e.preventDefault();\n      this.setIndent(1);\n    }\n  }\n\n  _onShiftArrowUp() {\n    this.move(-1);\n  }\n\n  _onShiftArrowDown() {\n    this.move(1);\n  }\n}\nwindow.customElements.define(LrnsysOutlineItem.tag, LrnsysOutlineItem);\nexport { LrnsysOutlineItem };","/**\n * Copyright 2018 The Pennsylvania State University\n * @license Apache-2.0, see License.md for full text.\n */\nimport { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport * as async from \"@polymer/polymer/lib/utils/async.js\";\nimport \"@polymer/paper-input/paper-input.js\";\nimport \"@polymer/paper-dialog/paper-dialog.js\";\nimport \"@lrnwebcomponents/simple-modal/simple-modal.js\";\nimport \"@polymer/paper-icon-button/paper-icon-button.js\";\nimport \"@polymer/paper-button/paper-button.js\";\nimport \"./lib/lrnsys-outline-item.js\";\n/**\n * `lrnsys-outline`\n * `Outline that items can be shuffled around in`\n *\n * @demo demo/index.html\n * @microcopy - the mental model for this element\n *  -\n */\nlet LrnsysOutline = Polymer({\n  _template: html`\n    <style>\n      :host {\n        display: block;\n      }\n      :host kbd {\n        display: inline-block;\n        background: #333;\n        color: white;\n        border-radius: 4px;\n        margin: 4px 4px 4px 0;\n        padding: 8px;\n        font-family: Verdana, Geneva, Tahoma, sans-serif;\n        font-size: 85%;\n      }\n    </style>\n    <paper-icon-button\n      title=\"Keyboard directions\"\n      id=\"dialogtrigger\"\n      icon=\"icons:help\"\n      on-tap=\"openDirections\"\n    ></paper-icon-button>\n    <paper-dialog id=\"modal\" with-backdrop=\"\">\n      <h2>Keyboard shortcuts</h2>\n      <div>\n        <paper-icon-button\n          title=\"close directions\"\n          style=\"position: absolute;top: 0; right:0;\"\n          icon=\"icons:cancel\"\n          on-tap=\"closeDirections\"\n        ></paper-icon-button>\n        <ul>\n          <li><kbd>Enter</kbd> to <strong>add</strong> an item</li>\n          <li>\n            <kbd>Backspace</kbd> <em>with entire item selected</em> to\n            <strong>delete</strong> an item.\n          </li>\n          <li>\n            <kbd>↑</kbd> / <kbd>↓</kbd> / <kbd>←</kbd> / <kbd>→</kbd> to\n            <strong>navigate</strong> through items\n          </li>\n          <li>\n            <kbd>Tab</kbd> / <kbd>Shift+Tab</kbd>\n            <em>at the beginning of a line</em> to\n            <strong>indent/outdent</strong>\n          </li>\n          <li><kbd>Shift+↑</kbd> / <kbd>Shift+↓</kbd> to items up/down</li>\n        </ul>\n      </div>\n    </paper-dialog>\n    <div id=\"itemslist\">\n      <template is=\"dom-repeat\" items=\"{{items}}\" as=\"item\">\n        <lrnsys-outline-item\n          disable-down=\"[[item.disableDown]]\"\n          disable-left=\"[[item.disableLeft]]\"\n          disable-right=\"[[item.disableRight]]\"\n          disable-up=\"[[item.disableUp]]\"\n          id$=\"[[item.id]]\"\n          index$=\"[[item.index]]\"\n          indent-level=\"{{item.indent}}\"\n          parent=\"{{item.parent}}\"\n          title=\"{{item.title}}\"\n        >\n        </lrnsys-outline-item>\n      </template>\n    </div>\n  `,\n\n  is: \"lrnsys-outline\",\n\n  listeners: {\n    \"delete-item\": \"_handleRemoveItem\",\n    \"indent-item\": \"_handleIndentItem\",\n    \"focus-item\": \"_handleFocusItem\",\n    \"add-item\": \"_handleAddItem\",\n    \"move-item\": \"_handleMoveItem\",\n    \"change-item\": \"_handleChangeItem\",\n    \"focus-item\": \"_handleFocusItem\",\n    \"blur-item\": \"_handleBlurItem\"\n  },\n\n  properties: {\n    data: {\n      type: Array,\n      value: null\n    },\n    items: {\n      type: Array,\n      value: null,\n      notify: true\n    },\n    activeItem: {\n      type: Object,\n      notify: true\n    }\n  },\n\n  /**\n   * Display directions for keyboard usage\n   */\n  openDirections: function(e) {\n    this.$.modal.opened = true;\n  },\n\n  /**\n   * Display directions for keyboard usage\n   */\n  closeDirections: function(e) {\n    this.$.modal.opened = false;\n    async.microTask.run(() => {\n      setTimeout(() => {\n        this.$.dialogtrigger.focus();\n      }, 50);\n    });\n  },\n\n  /**\n   * Attached lifecycle\n   */\n  attached: function() {\n    window.SimpleModal.requestAvailability();\n    this.__modal = this.$.modal;\n    document.body.addEventListener(\n      \"iron-overlay-canceled\",\n      this._accessibleFocus.bind(this)\n    );\n    // fix stack order\n    document.body.appendChild(this.$.modal);\n  },\n\n  /**\n   * Set ourselves as having focus after the modal closes.\n   */\n  _accessibleFocus: function(e) {\n    // this is OUR modal, we found her, oh modal, We've missed\n    // you so much. thank you for coming home. We're so, so, so\n    // sorry that we appended you to the body. We'll never do it\n    // again (until the next time you open).\n    if (e.detail === this.__modal) {\n      // focus on our dialog triggering button\n      async.microTask.run(() => {\n        setTimeout(() => {\n          this.$.dialogtrigger.focus();\n        }, 50);\n      });\n    }\n  },\n\n  ready: function() {\n    if (this.data === null || this.data.length < 1) {\n      this.__tempid = this.__tempid === undefined ? 0 : this.__tempid + 1;\n      this.data = [\n        {\n          id: \"outline-item-\" + this.__tempid,\n          title: \"\",\n          order: 0,\n          parent: null\n        }\n      ];\n    }\n    this.setData(this.data);\n  },\n\n  /**\n   * gets a nested array of items to convert & updates the dom-repeat\n   */\n  setData: function(data) {\n    if (data !== undefined && data.length > 0) {\n      let prevIndent = -1;\n      for (var i in data) {\n        let indent = parseInt(this._getIndent(data, i));\n        this.__tempid = this.__tempid === undefined ? 0 : this.__tempid + 1;\n        data[i].index = parseInt(i);\n        data[i].indent = indent;\n        data[i].prevSibling = this._getSibling(parseInt(i), indent, true);\n        data[i].nextSibling = this._getSibling(parseInt(i), indent, false);\n        data[i].disableUp = data[i].prevSibling === null;\n        data[i].disableDown = data[i].nextSibling === null;\n        data[i].disableLeft = indent === 0;\n        data[i].disableRight = indent > prevIndent;\n        data[i].id =\n          data[i].id === undefined\n            ? \"outline-item-\" + this.__tempid\n            : data[i].id;\n        prevIndent = indent;\n      }\n    }\n    this.set(\"items\", []);\n    this.set(\"items\", data);\n  },\n\n  /**\n   * gets a flat array of items to convert & updates it to a nested array\n   */\n  getData: function() {\n    for (var i in this.items) {\n      this.items[i].order = this._getOrder(this.items[i]);\n      this.notifyPath(`items.${i}.order`);\n    }\n    return this.items;\n  },\n\n  /**\n   * adds a new item\n   */\n  addItem: function(detail) {\n    let item = detail.item;\n    let title = detail.new;\n    let spliceIndex = this.items.findIndex(j => j.id === item.id) + 1;\n    this.__tempid = this.__tempid + 1;\n    this.splice(\"items\", spliceIndex, 0, {\n      id: \"outline-item-\" + this.__tempid,\n      title: title,\n      indent: item.indent,\n      parent: item.parent\n    });\n    this.items[spliceIndex].indentLevel = item.indent;\n    this.notifyPath(`items.${spliceIndex}.indentLevel`);\n    this.setData(this.items);\n    if (this.__focusedItem !== undefined && this.__focusedItem !== null) {\n      async.microTask.run(() => {\n        setTimeout(() => {\n          this.__focusedItem = item.nextElementSibling;\n          this.__focusedItem.focus();\n        }, 50);\n      });\n    }\n  },\n\n  /**\n   * removes an item\n   */\n  removeItem: function(item) {\n    let i = this.items.findIndex(j => j.id === item.id);\n    let b = document.createElement(\"paper-button\");\n    b.raised = true;\n    b.addEventListener(\"click\", this._deleteItemConfirm.bind(this));\n    b.appendChild(document.createTextNode(\"Yes, delete\"));\n    const evt = new CustomEvent(\"simple-modal-show\", {\n      bubbles: true,\n      cancelable: true,\n      detail: {\n        title: `Do you really want to delete ${this.items[i].title}?`,\n        elements: {\n          buttons: b\n        },\n        invokedBy: item.$.delete,\n        clone: false\n      }\n    });\n    this.dispatchEvent(evt);\n  },\n  /**\n   * Delete item confirmation\n   */\n  _deleteItemConfirm: function(e) {\n    let i = this.items.findIndex(j => j.id === this.activeItem.id);\n    this.activeItem.classList.add(\"collapse-to-remove\");\n    const evt = new CustomEvent(\"simple-modal-hide\", {\n      bubbles: true,\n      cancelable: true,\n      detail: {}\n    });\n    this.dispatchEvent(evt);\n    setTimeout(() => {\n      this.__focusedItem = this.activeItem.previousElementSibling;\n      for (var k in this.items) {\n        if (this.items[k].parent == this.items[i].id) {\n          this.items[k].parent = this.items[i].parent;\n        }\n      }\n      this.activeItem.classList.remove(\"collapse-to-remove\");\n      this.splice(\"items\", i, 1);\n      if (this.__focusedItem !== undefined && this.__focusedItem !== null) {\n        async.microTask.run(() => {\n          setTimeout(() => {\n            this.__focusedItem.focus();\n          }, 50);\n        });\n      }\n    }, 300);\n  },\n\n  /**\n   * moves an grop of items down\n   */\n  moveItem: function(item, moveUp) {\n    let sourceStart = item.index,\n      sourceEnd = this._getLastChild(item),\n      sourceCount = sourceEnd - sourceStart + 1;\n    let target = moveUp\n      ? this.items[sourceStart].prevSibling\n      : this._getLastChild(this.items[sourceEnd + 1]) - sourceCount + 1;\n    if (target > -1 && target < this.items.length) {\n      if ((moveUp && !item.disableUp) || (!moveUp && !item.disableDown)) {\n        let item2 = this.splice(\"items\", sourceStart, sourceCount);\n        this.splice(\"items\", target, 0, item2);\n        this.__focusedItem = this.$.itemslist.querySelectorAll(\n          \"lrnsys-outline-item\"\n        )[target];\n        this.setData(this.items);\n        if (this.__focusedItem !== undefined && this.__focusedItem !== null) {\n          async.microTask.run(() => {\n            setTimeout(() => {\n              this.__focusedItem.focus();\n            }, 50);\n          });\n        }\n      }\n    }\n  },\n  /**\n   * adjust indent\n   */\n  _adjustIndent: function(item, amount) {\n    if (\n      (amount > 0 && !item.disableRight) ||\n      (amount < 0 && !item.disableLeft)\n    ) {\n      let i = parseInt(item.index),\n        oldIndent = item.indent,\n        indent = item.indent + amount,\n        n = i + 1;\n      let prevParent =\n        item.prevSibling !== null &&\n        typeof item.prevSibling !== typeof undefined\n          ? item.prevSibling.id\n          : null;\n      let grandParent =\n        this._getItemById(item.parent) && this._getItemById(item.parent).parent\n          ? this._getItemById(item.parent).parent.id\n          : null;\n      item.indent = indent;\n      item.parent = amount > 0 ? prevParent : grandParent;\n      item.prevSibling = this._getSibling(i, indent, true);\n      item.nextSibling = this._getSibling(i, indent, false);\n      item.disableUp = item.prevSibling === null;\n      item.disableDown = item.nextSibling === null;\n      item.disableLeft = indent === 0;\n      item.disableRight =\n        this.items[i - 1] === null ||\n        typeof this.items[i - 1] === typeof undefined ||\n        indent > this.items[i - 1].indentLevel;\n      this.set(`items.${i}`, item);\n      this.notifyPath(`items.${i}.*`);\n      while (\n        this.items[n] !== null &&\n        this.items[n] !== undefined &&\n        oldIndent < this.items[n].indentLevel\n      ) {\n        this.items[n].indentLevel = this.items[n].indentLevel + amount;\n        this.notifyPath(`items.${n}.indentLevel`);\n        n++;\n        next = this.items[n];\n      }\n    }\n  },\n\n  /**\n   * gets all children of an item\n   */\n  _getLastChild: function(item) {\n    let next =\n      item !== undefined && item !== null\n        ? this._getSibling(item.index, item.indent, false)\n        : null;\n    if (next !== null && next !== undefined) {\n      return next - 1;\n    } else if (\n      typeof item !== typeof undefined &&\n      item.parent !== null &&\n      item.parent !== null &&\n      this._getItemById(item.parent) !== null\n    ) {\n      return this._getLastChild(this._getItemById(item.parent));\n    } else {\n      return this.items.length - 1;\n    }\n  },\n\n  /**\n   * converts a nested array of items and returns a flat list with indents\n   */\n  _getIndent: function(data, i) {\n    if (typeof data[i].parent !== typeof undefined) {\n      let k = data.findIndex(j => j.id === data[i].parent);\n      if (\n        k !== -1 &&\n        typeof data[k] !== typeof undefined &&\n        data[k].indent !== undefined\n      ) {\n        return data[k].indent + 1;\n      }\n    }\n    return 0;\n  },\n\n  /**\n   * returns order relative to siblings\n   */\n  _getOrder: function(item) {\n    let ctr = 0,\n      order = 0;\n    for (var i in this.items) {\n      if (this.items[i].parent == item.parent && this.items[i].id == item.id) {\n        order = ctr;\n      } else if (this.items[i].parent == item.parent) {\n        ctr++;\n      }\n    }\n    return order;\n  },\n\n  /**\n   * returns previous or next sibling\n   */\n  _getSibling: function(index, indent, prev) {\n    let inc = prev ? -1 : 1,\n      i = index + inc,\n      sib = null;\n    if (this.items !== null) {\n      while (i < this.items.length && i > -1) {\n        if (\n          sib === null &&\n          typeof this.items[i] !== typeof undefined &&\n          typeof this.items[index] !== typeof undefined &&\n          this.items[i].parent === this.items[index].parent\n        ) {\n          sib = i;\n        }\n        i += inc;\n      }\n    }\n    return sib;\n  },\n\n  /**\n   * get an item by item id\n   */\n  _getItemById: function(id, offset) {\n    let i = this.items.findIndex(j => j.id === id);\n    offset = offset === undefined ? 0 : offset;\n    if (this.items[i + offset] !== undefined) {\n      return this.items[i + offset];\n    } else {\n      return null;\n    }\n  },\n\n  /**\n   * listener to add an item\n   */\n  _handleAddItem: function(e) {\n    this.addItem(e.detail);\n  },\n\n  /**\n   * listener to delete an item\n   */\n  _handleRemoveItem: function(e) {\n    this.activeItem = e.detail.item;\n    this.removeItem(e.detail.item);\n  },\n\n  /**\n   * listener to move an item\n   */\n  _handleMoveItem: function(e) {\n    this.activeItem = e.detail.item;\n    this.moveItem(e.detail.item, e.detail.moveUp, e.detail.byGroup);\n  },\n\n  /**\n   * listener to move focus up or down\n   */\n  _handleFocusItem: function(e) {\n    let item = e.detail.moveUp\n      ? e.detail.item.previousElementSibling\n      : e.detail.item.nextElementSibling;\n    item.setSelection();\n  },\n\n  /**\n   * listener to increase or decrease indent\n   */\n  _handleIndentItem: function(e) {\n    let amt = e.detail.increase ? 1 : -1;\n    this._adjustIndent(this._getItemById(e.detail.item.id), amt);\n    this.setData(this.items);\n  },\n\n  /**\n   * listener to handle changes to text inputs\n   */\n  _handleChangeItem: function(e) {\n    if (this._getItemById(e.detail.item.id) != null) {\n      let i = this.items.findIndex(j => j.id === e.detail.item.id);\n      if (typeof this.items[i] !== typeof undefined) {\n        this.items[i].title = e.detail.value;\n        this.notifyPath(`items.${i}.title`);\n      }\n    }\n  },\n\n  /**\n   * listener for focus or mouseover\n   */\n  _handleFocusItem: function(e) {\n    this.__focusedItem = e.srcElement;\n  },\n\n  /**\n   * listener for blur or mouseout\n   */\n  _handleBlurItem: function(e) {}\n});\nexport { LrnsysOutline };\n"],"names":["LrnsysOutlineItem","PolymerElement","html","indentLevel","type","Number","value","index","parent","String","title","notify","reflectToAttribute","focusState","Boolean","e","dispatchEvent","CustomEvent","bubbles","cancelable","composed","detail","item","this","__inputTarget","$","input","afterNextRender","addEventListener","_onChange","bind","_this","_focusin","_focusout","removeEventListener","_this2","focus","amount","increase","i","shadowRoot","querySelector","_inputId","inputElement","selectionStart","j","slice","length","moveUp","move","setIndent","start","end","s","undefined","n","setSelectionRange","console","log","_getSelection","toString","keyboardEvent","preventDefault","parentNode","getSelection","window","customElements","define","tag","LrnsysOutline","Polymer","_template","is","listeners","properties","data","Array","items","activeItem","Object","openDirections","modal","opened","closeDirections","async","run","setTimeout","dialogtrigger","attached","SimpleModal","requestAvailability","__modal","document","body","_accessibleFocus","appendChild","ready","__tempid","id","order","setData","prevIndent","indent","parseInt","_getIndent","prevSibling","_getSibling","nextSibling","disableUp","disableDown","disableLeft","disableRight","set","getData","_getOrder","notifyPath","addItem","spliceIndex","findIndex","splice","__focusedItem","_this3","nextElementSibling","removeItem","b","createElement","raised","_deleteItemConfirm","createTextNode","evt","elements","buttons","invokedBy","clone","_this4","classList","add","k","previousElementSibling","remove","moveItem","sourceStart","sourceEnd","_getLastChild","sourceCount","target","item2","itemslist","querySelectorAll","_this5","_adjustIndent","oldIndent","prevParent","_typeof","grandParent","_getItemById","next","ctr","prev","inc","sib","offset","_handleAddItem","_handleRemoveItem","_handleMoveItem","byGroup","_handleFocusItem","setSelection","_handleIndentItem","amt","_handleChangeItem","srcElement"],"mappings":"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"}