{"version":3,"file":"media-behaviors.umd.js","sources":["media-behaviors.umd.js"],"sourcesContent":["// ensure MediaBehaviors exists\nwindow.MediaBehaviors = window.MediaBehaviors || {};\n/**\n * `MediaBehaviors.Video` provides some helper functions for working with video\n * from multiple sources. It helps resolve a video by type and currently supports\n * youtube, vimeo, and a few other sources and helps to determine if we need\n * an iframe to display the media or a local `<video>` tag.\n *\n * This also provides a powerful little utility to clean up embedded\n * URLs that reference popular media sources in order to make sure\n * that their embed URLs are structured correctly. This is especially\n * useful for allowing users to copy and paste links from youtube's URL\n * bar yet actually transform that address into a cookie free embed that\n * strips off the related videos and other options.\n *\n * @polymerBehavior MediaBehaviors.Video\n **/\nwindow.MediaBehaviors.Video = {\n  /**\n   * Compute iframe or video tag for implementation.\n   */\n  _sourceIsIframe: function(source) {\n    let type = this.getVideoType(source);\n    if (type == \"local\") {\n      return false;\n    } else {\n      return true;\n    }\n  },\n  /**\n   * Check source of the video, potentially correcting bad links.\n   */\n  cleanVideoSource: function(input, type) {\n    if (type != \"local\") {\n      // strip off the ? modifier for youtube/vimeo so we can build ourselves\n      var tmp = input.split(\"?\");\n      var v = \"\";\n      input = tmp[0];\n      if (tmp.length == 2) {\n        let tmp2 = tmp[1].split(\"&\"),\n          args = tmp2[0].split(\"=\"),\n          qry = Array.isArray(tmp2.shift())\n            ? tmp2.shift().join(\"\")\n            : tmp2.shift();\n        if (args[0] == \"v\") {\n          v = args[1] + \"?\" + qry;\n        }\n      }\n      // link to the vimeo video instead of the embed player address\n      if (\n        input.indexOf(\"player.vimeo.com\") == -1 &&\n        input.indexOf(\"vimeo.com\") != -1\n      ) {\n        // normalize what the API will return since it is API based\n        // and needs cleaned up for front-end\n        if (input.indexOf(\"/videos/\") != -1) {\n          input = input.replace(\"/videos/\", \"/\");\n        }\n        return input.replace(\"vimeo.com/\", \"player.vimeo.com/video/\");\n      }\n      // copy and paste from the URL\n      else if (input.indexOf(\"youtube.com/watch\") != -1) {\n        return input.replace(\"youtube.com/watch\", \"youtube.com/embed/\") + v;\n      }\n      // copy and paste from the URL\n      else if (input.indexOf(\"youtube-no-cookie.com/embed\") != -1) {\n        return (\n          input.replace(\"youtube-no-cookie.com/embed\", \"youtube.com/embed/\") + v\n        );\n      }\n      // weird share-ly style version\n      else if (input.indexOf(\"youtu.be\") != -1) {\n        return input.replace(\"youtu.be/\", \"www.youtube.com/embed/\") + v;\n      }\n      // copy and paste from the URL for sketchfab\n      else if (\n        input.indexOf(\"sketchfab.com\") != -1 &&\n        input.indexOf(\"/embed\") == -1\n      ) {\n        return input + \"/embed\";\n      }\n      // copy and paste from the URL for sketchfab\n      else if (\n        input.indexOf(\"dailymotion.com\") != -1 &&\n        input.indexOf(\"/embed\") == -1\n      ) {\n        return input.replace(\"/video/\", \"/embed/video/\");\n      }\n    }\n    return input;\n  },\n  /**\n   * Figure out the type of video based on source.\n   */\n  getVideoType: function(source) {\n    let localFormats = [\n        \"aac\",\n        \"flac\",\n        \"mov\",\n        \"mp3\",\n        \"mp4\",\n        \"oga\",\n        \"ogg\",\n        \"ogv\",\n        \"wav\",\n        \"webm\"\n      ],\n      isLocal = false;\n    // some common ones\n    if (source.indexOf(\"vimeo\") != -1) {\n      return \"vimeo\";\n    } else if (\n      source.indexOf(\"youtube\") != -1 ||\n      source.indexOf(\"youtu.be\") != -1\n    ) {\n      return \"youtube\";\n    } else if (source.indexOf(\"sketchfab.com\") != -1) {\n      return \"sketchfab\";\n    } else if (source.indexOf(\"dailymotion.com\") != -1) {\n      return \"dailymotion\";\n    }\n    for (let i = 0; i < localFormats.length; i++) {\n      if (!isLocal && source.toLowerCase().indexOf(\".\" + localFormats[i]) > -1)\n        isLocal = true;\n    }\n    // see if it's a direct file reference, otherwise we'll assume it's external\n    if (isLocal) {\n      return \"local\";\n    } else {\n      // not sure but iframe it for funzies\n      return \"external\";\n    }\n  }\n};\n"],"names":["window","MediaBehaviors","Video","_sourceIsIframe","source","this","getVideoType","cleanVideoSource","input","type","tmp","split","v","length","tmp2","args","qry","Array","isArray","shift","join","indexOf","replace","localFormats","isLocal","i","toLowerCase"],"mappings":"0FACAA,OAAOC,eAAiBD,OAAOC,gBAAkB,GAgBjDD,OAAOC,eAAeC,MAAQ,CAI5BC,gBAAiB,SAASC,SAEZ,SADDC,KAAKC,aAAaF,IAU/BG,iBAAkB,SAASC,EAAOC,MACpB,SAARA,EAAiB,KAEfC,EAAMF,EAAMG,MAAM,KAClBC,EAAI,MACRJ,EAAQE,EAAI,GACM,GAAdA,EAAIG,OAAa,KACfC,EAAOJ,EAAI,GAAGC,MAAM,KACtBI,EAAOD,EAAK,GAAGH,MAAM,KACrBK,EAAMC,MAAMC,QAAQJ,EAAKK,SACrBL,EAAKK,QAAQC,KAAK,IAClBN,EAAKK,QACI,KAAXJ,EAAK,KACPH,EAAIG,EAAK,GAAK,IAAMC,OAKgB,GAAtCR,EAAMa,QAAQ,sBACiB,GAA/Bb,EAAMa,QAAQ,oBAIoB,GAA9Bb,EAAMa,QAAQ,cAChBb,EAAQA,EAAMc,QAAQ,WAAY,MAE7Bd,EAAMc,QAAQ,aAAc,2BAGhC,IAA2C,GAAvCd,EAAMa,QAAQ,4BACdb,EAAMc,QAAQ,oBAAqB,sBAAwBV,EAG/D,IAAqD,GAAjDJ,EAAMa,QAAQ,sCAEnBb,EAAMc,QAAQ,8BAA+B,sBAAwBV,EAIpE,IAAkC,GAA9BJ,EAAMa,QAAQ,mBACdb,EAAMc,QAAQ,YAAa,0BAA4BV,EAG3D,IACgC,GAAnCJ,EAAMa,QAAQ,mBACc,GAA5Bb,EAAMa,QAAQ,iBAEPb,EAAQ,SAGZ,IACkC,GAArCA,EAAMa,QAAQ,qBACc,GAA5Bb,EAAMa,QAAQ,iBAEPb,EAAMc,QAAQ,UAAW,wBAG7Bd,GAKTF,aAAc,SAASF,OACjBmB,EAAe,CACf,MACA,OACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,QAEFC,GAAU,MAEoB,GAA5BpB,EAAOiB,QAAQ,eACV,QACF,IACyB,GAA9BjB,EAAOiB,QAAQ,aACgB,GAA/BjB,EAAOiB,QAAQ,kBAER,UACF,IAAwC,GAApCjB,EAAOiB,QAAQ,uBACjB,YACF,IAA0C,GAAtCjB,EAAOiB,QAAQ,yBACjB,kBAEJ,IAAII,EAAI,EAAGA,EAAIF,EAAaV,OAAQY,KAClCD,GAAWpB,EAAOsB,cAAcL,QAAQ,IAAME,EAAaE,KAAO,IACrED,GAAU,UAGVA,EACK,QAGA"}