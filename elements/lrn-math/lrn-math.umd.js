!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@lrnwebcomponents/hax-body-behaviors/lib/HAXWiring.js"),require("@lrnwebcomponents/hax-iconset/hax-iconset.js")):"function"==typeof define&&define.amd?define(["exports","@lrnwebcomponents/hax-body-behaviors/lib/HAXWiring.js","@lrnwebcomponents/hax-iconset/hax-iconset.js"],t):t((e=e||self).LrnMath={},e.HAXWiring_js)}(this,function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}function a(e){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e,t,n){return(s=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var o=new(Function.bind.apply(e,r));return n&&c(o,n.prototype),o}).apply(null,arguments)}function u(e){var t="function"==typeof Map?new Map:void 0;return(u=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return s(e,arguments,a(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),c(r,e)})(e)}function l(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}var f,p,h=window.document,d={start:1,loading:2,ready:3,typesetting:4,error:5},y=[],m=d.start,b="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js";function v(){if(y.length){var e=[],t=[];y.forEach(function(n){var r=h.createElement("script"),o=h.createElement("div");r.type=n[1]?"math/tex; mode=display":"math/tex",r.text=n[0],o.style.position="fixed",o.style.top=0,o.style.left="99999px",o.appendChild(r),h.body.appendChild(o),e.push(r),t.push([o,n[2]])}),y=[],m=d.typesetting,f.Queue(["Typeset",f,e]),f.Queue(function(){var e,n;p||(e=h.querySelectorAll("style"),n=Array.prototype.filter.call(e,function(e){return e.sheet&&e.sheet.cssRules.length>100&&".mjx-chtml"===e.sheet.cssRules[0].selectorText}),p=n[0]),t.forEach(function(e){var t=e[0],n="SPAN"===t.firstElementChild.tagName?t.firstElementChild:null;e[1](n,p),h.body.removeChild(t)}),m=d.ready,v()})}}function x(){m=d.loading,window.MathJax={skipStartupTypeset:!0,showMathMenu:!1,jax:["input/TeX","output/CommonHTML"],TeX:{extensions:["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]},AuthorInit:function(){(f=window.MathJax.Hub).Register.StartupHook("End",function(){m=d.ready,v()})}};var e=h.createElement("script");e.type="text/javascript",e.src=b,e.async=!0,e.onerror=function(){console.warn("Error loading MathJax library "+b),m=d.error,y=[]},h.head.appendChild(e)}var w=function(e){function t(){return n(this,t),l(this,a(t).apply(this,arguments))}return i(t,u(HTMLElement)),o(t,[{key:"connectedCallback",value:function(){this.hasAttribute("src")&&(b=this.getAttribute("src")),this.hasAttribute("lazy")||x()}},{key:"typeset",value:function(e,t,n){m!==d.error&&(y.push([e,t,n]),m===d.start?x():m===d.ready&&v())}}]),t}();window.customElements.define("math-tex-controller",w);var g,j="lrn-math",M="math-tex-controller",E={childList:!0,characterData:!0,attributes:!0,subtree:!0};function C(e){var t=e.shadowRoot,n=e.textContent.trim(),r="display"===e.getAttribute("mode"),o=(r?"D":"I")+n;if(o!==e._private.check){for(;t.firstChild;)t.removeChild(t.firstChild);e._private.check=o,n.length&&g.typeset(n,r,function(e,n){t.appendChild(n.cloneNode(!0)),t.appendChild(e)})}}var k=function(e){function r(){var e;return n(this,r),(e=l(this,a(r).call(this))).attachShadow({mode:"open"}),g||((g=h.querySelector(M)||h.createElement(M))&&"function"==typeof g.typeset?h.contains(g)||h.head.appendChild(g):(console.warn("no %s element defined; %s element will not work",M,j),g=void 0)),e}return i(r,u(HTMLElement)),o(r,[{key:"connectedCallback",value:function(){var e=this;window.requestAnimationFrame(function(){e._private={check:"",observer:new MutationObserver(function(){C(e)})},C(e),e._private.observer.observe(e,E)}),(new t.HAXWiring).setup(r.haxProperties,r.tag,this)}},{key:"refresh",value:function(){var e=h.createElement("lrn-math");this.parentNode.insertBefore(e,this),e.innerHTML=this.innerHTML,this.remove()}},{key:"disconnectedCallback",value:function(){this._private&&(this._private.observer.disconnect(),delete this._private)}}],[{key:"tag",get:function(){return"lrn-math"}},{key:"haxProperties",get:function(){return{canScale:!0,canPosition:!0,canEditSource:!0,gizmo:{title:"Math",description:"Present math in a nice looking way.",icon:"hax:pi",color:"grey",groups:["Content"],handles:[{type:"math",math:"mathText"},{type:"inline",text:"mathText"}],meta:{author:"LRNWebComponents"}},settings:{quick:[],configure:[{slot:"",title:"Math",description:"Enter equation as MathML",inputMethod:"code-editor",icon:"editor:format-quote"}],advanced:[]}}}}]),r}();window.customElements.define(k.tag,k),e.MathTexController=w,e.MathTex=k,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=lrn-math.umd.js.map
